Model: "WaveMLP-B"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input_99 (InputLayer)       [(None, 224, 224, 3)]        0         []                            
                                                                                                  
 stem_pad (ZeroPadding2D)    (None, 228, 228, 3)          0         ['input_99[0][0]']            
                                                                                                  
 stem_conv_ (Conv2D)         (None, 56, 56, 96)           14208     ['stem_pad[0][0]']            
                                                                                                  
 group_normalization (Group  (None, 56, 56, 96)           192       ['stem_conv_[0][0]']          
 Normalization)                                                                                   
                                                                                                  
 stack1_block1_attn_theta_h  (None, 56, 56, 96)           9312      ['group_normalization[0][0]'] 
 _ (Conv2D)                                                                                       
                                                                                                  
 stack1_block1_attn_theta_w  (None, 56, 56, 96)           9312      ['group_normalization[0][0]'] 
 _ (Conv2D)                                                                                       
                                                                                                  
 batch_normalization (Batch  (None, 56, 56, 96)           384       ['stack1_block1_attn_theta_h_[
 Normalization)                                                     0][0]']                       
                                                                                                  
 batch_normalization_1 (Bat  (None, 56, 56, 96)           384       ['stack1_block1_attn_theta_w_[
 chNormalization)                                                   0][0]']                       
                                                                                                  
 activation_153 (Activation  (None, 56, 56, 96)           0         ['batch_normalization[0][0]'] 
 )                                                                                                
                                                                                                  
 activation_154 (Activation  (None, 56, 56, 96)           0         ['batch_normalization_1[0][0]'
 )                                                                  ]                             
                                                                                                  
 stack1_block1_attn_height_  (None, 56, 56, 96)           9216      ['group_normalization[0][0]'] 
  (Conv2D)                                                                                        
                                                                                                  
 tf.math.cos (TFOpLambda)    (None, 56, 56, 96)           0         ['activation_153[0][0]']      
                                                                                                  
 tf.math.sin (TFOpLambda)    (None, 56, 56, 96)           0         ['activation_153[0][0]']      
                                                                                                  
 stack1_block1_attn_width_   (None, 56, 56, 96)           9216      ['group_normalization[0][0]'] 
 (Conv2D)                                                                                         
                                                                                                  
 tf.math.cos_1 (TFOpLambda)  (None, 56, 56, 96)           0         ['activation_154[0][0]']      
                                                                                                  
 tf.math.sin_1 (TFOpLambda)  (None, 56, 56, 96)           0         ['activation_154[0][0]']      
                                                                                                  
 multiply (Multiply)         (None, 56, 56, 96)           0         ['stack1_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos[0][0]']         
                                                                                                  
 multiply_1 (Multiply)       (None, 56, 56, 96)           0         ['stack1_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin[0][0]']         
                                                                                                  
 multiply_2 (Multiply)       (None, 56, 56, 96)           0         ['stack1_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_1[0][0]']       
                                                                                                  
 multiply_3 (Multiply)       (None, 56, 56, 96)           0         ['stack1_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_1[0][0]']       
                                                                                                  
 concatenate_611 (Concatena  (None, 56, 56, 192)          0         ['multiply[0][0]',            
 te)                                                                 'multiply_1[0][0]']          
                                                                                                  
 concatenate_612 (Concatena  (None, 56, 56, 192)          0         ['multiply_2[0][0]',          
 te)                                                                 'multiply_3[0][0]']          
                                                                                                  
 stack1_block1_attn_height_  (None, 56, 56, 96)           1344      ['concatenate_611[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack1_block1_attn_width_d  (None, 56, 56, 96)           1344      ['concatenate_612[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack1_block1_attn_channel  (None, 56, 56, 96)           9216      ['group_normalization[0][0]'] 
 _ (Conv2D)                                                                                       
                                                                                                  
 add_400 (Add)               (None, 56, 56, 96)           0         ['stack1_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack1_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack1_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 96)             0         ['add_400[0][0]']             
  (GlobalAveragePooling2D)                                                                        
                                                                                                  
 stack1_block1_attn_reweigh  (None, 1, 1, 288)            9528      ['global_average_pooling2d_4[0
 t_ (MLPBlock)                                                      ][0]']                        
                                                                                                  
 reshape_17 (Reshape)        (None, 1, 1, 96, 3)          0         ['stack1_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack1_block1_attn_attenti  (None, 1, 1, 96, 3)          0         ['reshape_17[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack (TFOpLambda)     [(None, 1, 1, 96),           0         ['stack1_block1_attn_attention
                              (None, 1, 1, 96),                     _scores[0][0]']               
                              (None, 1, 1, 96)]                                                   
                                                                                                  
 multiply_4 (Multiply)       (None, 56, 56, 96)           0         ['stack1_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack[0][0]']          
                                                                                                  
 multiply_5 (Multiply)       (None, 56, 56, 96)           0         ['stack1_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack[0][1]']          
                                                                                                  
 multiply_6 (Multiply)       (None, 56, 56, 96)           0         ['stack1_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack[0][2]']          
                                                                                                  
 add_401 (Add)               (None, 56, 56, 96)           0         ['multiply_4[0][0]',          
                                                                     'multiply_5[0][0]',          
                                                                     'multiply_6[0][0]']          
                                                                                                  
 stack1_block1_attn_out_ (C  (None, 56, 56, 96)           9312      ['add_401[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack1_block1_attn_drop_ (  (None, 56, 56, 96)           0         ['stack1_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack1_block1_attn_out (Ad  (None, 56, 56, 96)           0         ['stem_conv_[0][0]',          
 d)                                                                  'stack1_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_1 (Gro  (None, 56, 56, 96)           192       ['stack1_block1_attn_out[0][0]
 upNormalization)                                                   ']                            
                                                                                                  
 stack1_block1_mlp_blocl_ (  (None, 56, 56, 96)           74208     ['group_normalization_1[0][0]'
 MLPBlock)                                                          ]                             
                                                                                                  
 stack1_block1_mlp_drop_ (D  (None, 56, 56, 96)           0         ['stack1_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack1_block1_mlp_out (Add  (None, 56, 56, 96)           0         ['stack1_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack1_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_2 (Gro  (None, 56, 56, 96)           192       ['stack1_block1_mlp_out[0][0]'
 upNormalization)                                                   ]                             
                                                                                                  
 stack1_block2_attn_theta_h  (None, 56, 56, 96)           9312      ['group_normalization_2[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 stack1_block2_attn_theta_w  (None, 56, 56, 96)           9312      ['group_normalization_2[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 batch_normalization_2 (Bat  (None, 56, 56, 96)           384       ['stack1_block2_attn_theta_h_[
 chNormalization)                                                   0][0]']                       
                                                                                                  
 batch_normalization_3 (Bat  (None, 56, 56, 96)           384       ['stack1_block2_attn_theta_w_[
 chNormalization)                                                   0][0]']                       
                                                                                                  
 activation_155 (Activation  (None, 56, 56, 96)           0         ['batch_normalization_2[0][0]'
 )                                                                  ]                             
                                                                                                  
 activation_156 (Activation  (None, 56, 56, 96)           0         ['batch_normalization_3[0][0]'
 )                                                                  ]                             
                                                                                                  
 stack1_block2_attn_height_  (None, 56, 56, 96)           9216      ['group_normalization_2[0][0]'
  (Conv2D)                                                          ]                             
                                                                                                  
 tf.math.cos_2 (TFOpLambda)  (None, 56, 56, 96)           0         ['activation_155[0][0]']      
                                                                                                  
 tf.math.sin_2 (TFOpLambda)  (None, 56, 56, 96)           0         ['activation_155[0][0]']      
                                                                                                  
 stack1_block2_attn_width_   (None, 56, 56, 96)           9216      ['group_normalization_2[0][0]'
 (Conv2D)                                                           ]                             
                                                                                                  
 tf.math.cos_3 (TFOpLambda)  (None, 56, 56, 96)           0         ['activation_156[0][0]']      
                                                                                                  
 tf.math.sin_3 (TFOpLambda)  (None, 56, 56, 96)           0         ['activation_156[0][0]']      
                                                                                                  
 multiply_7 (Multiply)       (None, 56, 56, 96)           0         ['stack1_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_2[0][0]']       
                                                                                                  
 multiply_8 (Multiply)       (None, 56, 56, 96)           0         ['stack1_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_2[0][0]']       
                                                                                                  
 multiply_9 (Multiply)       (None, 56, 56, 96)           0         ['stack1_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_3[0][0]']       
                                                                                                  
 multiply_10 (Multiply)      (None, 56, 56, 96)           0         ['stack1_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_3[0][0]']       
                                                                                                  
 concatenate_613 (Concatena  (None, 56, 56, 192)          0         ['multiply_7[0][0]',          
 te)                                                                 'multiply_8[0][0]']          
                                                                                                  
 concatenate_614 (Concatena  (None, 56, 56, 192)          0         ['multiply_9[0][0]',          
 te)                                                                 'multiply_10[0][0]']         
                                                                                                  
 stack1_block2_attn_height_  (None, 56, 56, 96)           1344      ['concatenate_613[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack1_block2_attn_width_d  (None, 56, 56, 96)           1344      ['concatenate_614[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack1_block2_attn_channel  (None, 56, 56, 96)           9216      ['group_normalization_2[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 add_402 (Add)               (None, 56, 56, 96)           0         ['stack1_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack1_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack1_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_5  (None, 1, 1, 96)             0         ['add_402[0][0]']             
  (GlobalAveragePooling2D)                                                                        
                                                                                                  
 stack1_block2_attn_reweigh  (None, 1, 1, 288)            9528      ['global_average_pooling2d_5[0
 t_ (MLPBlock)                                                      ][0]']                        
                                                                                                  
 reshape_18 (Reshape)        (None, 1, 1, 96, 3)          0         ['stack1_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack1_block2_attn_attenti  (None, 1, 1, 96, 3)          0         ['reshape_18[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_1 (TFOpLambda)   [(None, 1, 1, 96),           0         ['stack1_block2_attn_attention
                              (None, 1, 1, 96),                     _scores[0][0]']               
                              (None, 1, 1, 96)]                                                   
                                                                                                  
 multiply_11 (Multiply)      (None, 56, 56, 96)           0         ['stack1_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_1[0][0]']        
                                                                                                  
 multiply_12 (Multiply)      (None, 56, 56, 96)           0         ['stack1_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_1[0][1]']        
                                                                                                  
 multiply_13 (Multiply)      (None, 56, 56, 96)           0         ['stack1_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_1[0][2]']        
                                                                                                  
 add_403 (Add)               (None, 56, 56, 96)           0         ['multiply_11[0][0]',         
                                                                     'multiply_12[0][0]',         
                                                                     'multiply_13[0][0]']         
                                                                                                  
 stack1_block2_attn_out_ (C  (None, 56, 56, 96)           9312      ['add_403[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack1_block2_attn_drop_ (  (None, 56, 56, 96)           0         ['stack1_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack1_block2_attn_out (Ad  (None, 56, 56, 96)           0         ['stack1_block1_mlp_out[0][0]'
 d)                                                                 , 'stack1_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_3 (Gro  (None, 56, 56, 96)           192       ['stack1_block2_attn_out[0][0]
 upNormalization)                                                   ']                            
                                                                                                  
 stack1_block2_mlp_blocl_ (  (None, 56, 56, 96)           74208     ['group_normalization_3[0][0]'
 MLPBlock)                                                          ]                             
                                                                                                  
 stack1_block2_mlp_drop_ (D  (None, 56, 56, 96)           0         ['stack1_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack1_block2_mlp_out (Add  (None, 56, 56, 96)           0         ['stack1_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack1_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 stack2_down_sample_ (Conv2  (None, 28, 28, 192)          166080    ['stack1_block2_mlp_out[0][0]'
 D)                                                                 ]                             
                                                                                                  
 group_normalization_4 (Gro  (None, 28, 28, 192)          384       ['stack2_down_sample_[0][0]'] 
 upNormalization)                                                                                 
                                                                                                  
 stack2_block1_attn_theta_h  (None, 28, 28, 192)          37056     ['group_normalization_4[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 stack2_block1_attn_theta_w  (None, 28, 28, 192)          37056     ['group_normalization_4[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 batch_normalization_4 (Bat  (None, 28, 28, 192)          768       ['stack2_block1_attn_theta_h_[
 chNormalization)                                                   0][0]']                       
                                                                                                  
 batch_normalization_5 (Bat  (None, 28, 28, 192)          768       ['stack2_block1_attn_theta_w_[
 chNormalization)                                                   0][0]']                       
                                                                                                  
 activation_157 (Activation  (None, 28, 28, 192)          0         ['batch_normalization_4[0][0]'
 )                                                                  ]                             
                                                                                                  
 activation_158 (Activation  (None, 28, 28, 192)          0         ['batch_normalization_5[0][0]'
 )                                                                  ]                             
                                                                                                  
 stack2_block1_attn_height_  (None, 28, 28, 192)          36864     ['group_normalization_4[0][0]'
  (Conv2D)                                                          ]                             
                                                                                                  
 tf.math.cos_4 (TFOpLambda)  (None, 28, 28, 192)          0         ['activation_157[0][0]']      
                                                                                                  
 tf.math.sin_4 (TFOpLambda)  (None, 28, 28, 192)          0         ['activation_157[0][0]']      
                                                                                                  
 stack2_block1_attn_width_   (None, 28, 28, 192)          36864     ['group_normalization_4[0][0]'
 (Conv2D)                                                           ]                             
                                                                                                  
 tf.math.cos_5 (TFOpLambda)  (None, 28, 28, 192)          0         ['activation_158[0][0]']      
                                                                                                  
 tf.math.sin_5 (TFOpLambda)  (None, 28, 28, 192)          0         ['activation_158[0][0]']      
                                                                                                  
 multiply_14 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_4[0][0]']       
                                                                                                  
 multiply_15 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_4[0][0]']       
                                                                                                  
 multiply_16 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_5[0][0]']       
                                                                                                  
 multiply_17 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_5[0][0]']       
                                                                                                  
 concatenate_615 (Concatena  (None, 28, 28, 384)          0         ['multiply_14[0][0]',         
 te)                                                                 'multiply_15[0][0]']         
                                                                                                  
 concatenate_616 (Concatena  (None, 28, 28, 384)          0         ['multiply_16[0][0]',         
 te)                                                                 'multiply_17[0][0]']         
                                                                                                  
 stack2_block1_attn_height_  (None, 28, 28, 192)          2688      ['concatenate_615[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block1_attn_width_d  (None, 28, 28, 192)          2688      ['concatenate_616[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block1_attn_channel  (None, 28, 28, 192)          36864     ['group_normalization_4[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 add_404 (Add)               (None, 28, 28, 192)          0         ['stack2_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 192)            0         ['add_404[0][0]']             
  (GlobalAveragePooling2D)                                                                        
                                                                                                  
 stack2_block1_attn_reweigh  (None, 1, 1, 576)            37488     ['global_average_pooling2d_6[0
 t_ (MLPBlock)                                                      ][0]']                        
                                                                                                  
 reshape_19 (Reshape)        (None, 1, 1, 192, 3)         0         ['stack2_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block1_attn_attenti  (None, 1, 1, 192, 3)         0         ['reshape_19[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_2 (TFOpLambda)   [(None, 1, 1, 192),          0         ['stack2_block1_attn_attention
                              (None, 1, 1, 192),                    _scores[0][0]']               
                              (None, 1, 1, 192)]                                                  
                                                                                                  
 multiply_18 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_2[0][0]']        
                                                                                                  
 multiply_19 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_2[0][1]']        
                                                                                                  
 multiply_20 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_2[0][2]']        
                                                                                                  
 add_405 (Add)               (None, 28, 28, 192)          0         ['multiply_18[0][0]',         
                                                                     'multiply_19[0][0]',         
                                                                     'multiply_20[0][0]']         
                                                                                                  
 stack2_block1_attn_out_ (C  (None, 28, 28, 192)          37056     ['add_405[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block1_attn_drop_ (  (None, 28, 28, 192)          0         ['stack2_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block1_attn_out (Ad  (None, 28, 28, 192)          0         ['stack2_down_sample_[0][0]', 
 d)                                                                  'stack2_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_5 (Gro  (None, 28, 28, 192)          384       ['stack2_block1_attn_out[0][0]
 upNormalization)                                                   ']                            
                                                                                                  
 stack2_block1_mlp_blocl_ (  (None, 28, 28, 192)          295872    ['group_normalization_5[0][0]'
 MLPBlock)                                                          ]                             
                                                                                                  
 stack2_block1_mlp_drop_ (D  (None, 28, 28, 192)          0         ['stack2_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block1_mlp_out (Add  (None, 28, 28, 192)          0         ['stack2_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_6 (Gro  (None, 28, 28, 192)          384       ['stack2_block1_mlp_out[0][0]'
 upNormalization)                                                   ]                             
                                                                                                  
 stack2_block2_attn_theta_h  (None, 28, 28, 192)          37056     ['group_normalization_6[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 stack2_block2_attn_theta_w  (None, 28, 28, 192)          37056     ['group_normalization_6[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 batch_normalization_6 (Bat  (None, 28, 28, 192)          768       ['stack2_block2_attn_theta_h_[
 chNormalization)                                                   0][0]']                       
                                                                                                  
 batch_normalization_7 (Bat  (None, 28, 28, 192)          768       ['stack2_block2_attn_theta_w_[
 chNormalization)                                                   0][0]']                       
                                                                                                  
 activation_159 (Activation  (None, 28, 28, 192)          0         ['batch_normalization_6[0][0]'
 )                                                                  ]                             
                                                                                                  
 activation_160 (Activation  (None, 28, 28, 192)          0         ['batch_normalization_7[0][0]'
 )                                                                  ]                             
                                                                                                  
 stack2_block2_attn_height_  (None, 28, 28, 192)          36864     ['group_normalization_6[0][0]'
  (Conv2D)                                                          ]                             
                                                                                                  
 tf.math.cos_6 (TFOpLambda)  (None, 28, 28, 192)          0         ['activation_159[0][0]']      
                                                                                                  
 tf.math.sin_6 (TFOpLambda)  (None, 28, 28, 192)          0         ['activation_159[0][0]']      
                                                                                                  
 stack2_block2_attn_width_   (None, 28, 28, 192)          36864     ['group_normalization_6[0][0]'
 (Conv2D)                                                           ]                             
                                                                                                  
 tf.math.cos_7 (TFOpLambda)  (None, 28, 28, 192)          0         ['activation_160[0][0]']      
                                                                                                  
 tf.math.sin_7 (TFOpLambda)  (None, 28, 28, 192)          0         ['activation_160[0][0]']      
                                                                                                  
 multiply_21 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_6[0][0]']       
                                                                                                  
 multiply_22 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_6[0][0]']       
                                                                                                  
 multiply_23 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_7[0][0]']       
                                                                                                  
 multiply_24 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_7[0][0]']       
                                                                                                  
 concatenate_617 (Concatena  (None, 28, 28, 384)          0         ['multiply_21[0][0]',         
 te)                                                                 'multiply_22[0][0]']         
                                                                                                  
 concatenate_618 (Concatena  (None, 28, 28, 384)          0         ['multiply_23[0][0]',         
 te)                                                                 'multiply_24[0][0]']         
                                                                                                  
 stack2_block2_attn_height_  (None, 28, 28, 192)          2688      ['concatenate_617[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block2_attn_width_d  (None, 28, 28, 192)          2688      ['concatenate_618[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block2_attn_channel  (None, 28, 28, 192)          36864     ['group_normalization_6[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 add_406 (Add)               (None, 28, 28, 192)          0         ['stack2_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_7  (None, 1, 1, 192)            0         ['add_406[0][0]']             
  (GlobalAveragePooling2D)                                                                        
                                                                                                  
 stack2_block2_attn_reweigh  (None, 1, 1, 576)            37488     ['global_average_pooling2d_7[0
 t_ (MLPBlock)                                                      ][0]']                        
                                                                                                  
 reshape_20 (Reshape)        (None, 1, 1, 192, 3)         0         ['stack2_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block2_attn_attenti  (None, 1, 1, 192, 3)         0         ['reshape_20[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_3 (TFOpLambda)   [(None, 1, 1, 192),          0         ['stack2_block2_attn_attention
                              (None, 1, 1, 192),                    _scores[0][0]']               
                              (None, 1, 1, 192)]                                                  
                                                                                                  
 multiply_25 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_3[0][0]']        
                                                                                                  
 multiply_26 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_3[0][1]']        
                                                                                                  
 multiply_27 (Multiply)      (None, 28, 28, 192)          0         ['stack2_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_3[0][2]']        
                                                                                                  
 add_407 (Add)               (None, 28, 28, 192)          0         ['multiply_25[0][0]',         
                                                                     'multiply_26[0][0]',         
                                                                     'multiply_27[0][0]']         
                                                                                                  
 stack2_block2_attn_out_ (C  (None, 28, 28, 192)          37056     ['add_407[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block2_attn_drop_ (  (None, 28, 28, 192)          0         ['stack2_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block2_attn_out (Ad  (None, 28, 28, 192)          0         ['stack2_block1_mlp_out[0][0]'
 d)                                                                 , 'stack2_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_7 (Gro  (None, 28, 28, 192)          384       ['stack2_block2_attn_out[0][0]
 upNormalization)                                                   ']                            
                                                                                                  
 stack2_block2_mlp_blocl_ (  (None, 28, 28, 192)          295872    ['group_normalization_7[0][0]'
 MLPBlock)                                                          ]                             
                                                                                                  
 stack2_block2_mlp_drop_ (D  (None, 28, 28, 192)          0         ['stack2_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block2_mlp_out (Add  (None, 28, 28, 192)          0         ['stack2_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 stack3_down_sample_ (Conv2  (None, 14, 14, 384)          663936    ['stack2_block2_mlp_out[0][0]'
 D)                                                                 ]                             
                                                                                                  
 group_normalization_8 (Gro  (None, 14, 14, 384)          768       ['stack3_down_sample_[0][0]'] 
 upNormalization)                                                                                 
                                                                                                  
 stack3_block1_attn_theta_h  (None, 14, 14, 384)          147840    ['group_normalization_8[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 stack3_block1_attn_theta_w  (None, 14, 14, 384)          147840    ['group_normalization_8[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 batch_normalization_8 (Bat  (None, 14, 14, 384)          1536      ['stack3_block1_attn_theta_h_[
 chNormalization)                                                   0][0]']                       
                                                                                                  
 batch_normalization_9 (Bat  (None, 14, 14, 384)          1536      ['stack3_block1_attn_theta_w_[
 chNormalization)                                                   0][0]']                       
                                                                                                  
 activation_161 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_8[0][0]'
 )                                                                  ]                             
                                                                                                  
 activation_162 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_9[0][0]'
 )                                                                  ]                             
                                                                                                  
 stack3_block1_attn_height_  (None, 14, 14, 384)          147456    ['group_normalization_8[0][0]'
  (Conv2D)                                                          ]                             
                                                                                                  
 tf.math.cos_8 (TFOpLambda)  (None, 14, 14, 384)          0         ['activation_161[0][0]']      
                                                                                                  
 tf.math.sin_8 (TFOpLambda)  (None, 14, 14, 384)          0         ['activation_161[0][0]']      
                                                                                                  
 stack3_block1_attn_width_   (None, 14, 14, 384)          147456    ['group_normalization_8[0][0]'
 (Conv2D)                                                           ]                             
                                                                                                  
 tf.math.cos_9 (TFOpLambda)  (None, 14, 14, 384)          0         ['activation_162[0][0]']      
                                                                                                  
 tf.math.sin_9 (TFOpLambda)  (None, 14, 14, 384)          0         ['activation_162[0][0]']      
                                                                                                  
 multiply_28 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_8[0][0]']       
                                                                                                  
 multiply_29 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_8[0][0]']       
                                                                                                  
 multiply_30 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_9[0][0]']       
                                                                                                  
 multiply_31 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_9[0][0]']       
                                                                                                  
 concatenate_619 (Concatena  (None, 14, 14, 768)          0         ['multiply_28[0][0]',         
 te)                                                                 'multiply_29[0][0]']         
                                                                                                  
 concatenate_620 (Concatena  (None, 14, 14, 768)          0         ['multiply_30[0][0]',         
 te)                                                                 'multiply_31[0][0]']         
                                                                                                  
 stack3_block1_attn_height_  (None, 14, 14, 384)          5376      ['concatenate_619[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block1_attn_width_d  (None, 14, 14, 384)          5376      ['concatenate_620[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block1_attn_channel  (None, 14, 14, 384)          147456    ['group_normalization_8[0][0]'
 _ (Conv2D)                                                         ]                             
                                                                                                  
 add_408 (Add)               (None, 14, 14, 384)          0         ['stack3_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_8  (None, 1, 1, 384)            0         ['add_408[0][0]']             
  (GlobalAveragePooling2D)                                                                        
                                                                                                  
 stack3_block1_attn_reweigh  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_8[0
 t_ (MLPBlock)                                                      ][0]']                        
                                                                                                  
 reshape_21 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block1_attn_attenti  (None, 1, 1, 384, 3)         0         ['reshape_21[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_4 (TFOpLambda)   [(None, 1, 1, 384),          0         ['stack3_block1_attn_attention
                              (None, 1, 1, 384),                    _scores[0][0]']               
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_32 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_4[0][0]']        
                                                                                                  
 multiply_33 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_4[0][1]']        
                                                                                                  
 multiply_34 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_4[0][2]']        
                                                                                                  
 add_409 (Add)               (None, 14, 14, 384)          0         ['multiply_32[0][0]',         
                                                                     'multiply_33[0][0]',         
                                                                     'multiply_34[0][0]']         
                                                                                                  
 stack3_block1_attn_out_ (C  (None, 14, 14, 384)          147840    ['add_409[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block1_attn_drop_ (  (None, 14, 14, 384)          0         ['stack3_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block1_attn_out (Ad  (None, 14, 14, 384)          0         ['stack3_down_sample_[0][0]', 
 d)                                                                  'stack3_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_9 (Gro  (None, 14, 14, 384)          768       ['stack3_block1_attn_out[0][0]
 upNormalization)                                                   ']                            
                                                                                                  
 stack3_block1_mlp_blocl_ (  (None, 14, 14, 384)          1181568   ['group_normalization_9[0][0]'
 MLPBlock)                                                          ]                             
                                                                                                  
 stack3_block1_mlp_drop_ (D  (None, 14, 14, 384)          0         ['stack3_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block1_mlp_out (Add  (None, 14, 14, 384)          0         ['stack3_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_10 (Gr  (None, 14, 14, 384)          768       ['stack3_block1_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block2_attn_theta_h  (None, 14, 14, 384)          147840    ['group_normalization_10[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block2_attn_theta_w  (None, 14, 14, 384)          147840    ['group_normalization_10[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_10 (Ba  (None, 14, 14, 384)          1536      ['stack3_block2_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_11 (Ba  (None, 14, 14, 384)          1536      ['stack3_block2_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_163 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_10[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_164 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_11[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block2_attn_height_  (None, 14, 14, 384)          147456    ['group_normalization_10[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_10 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_163[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_10 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_163[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block2_attn_width_   (None, 14, 14, 384)          147456    ['group_normalization_10[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_11 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_164[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_11 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_164[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_35 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_10[0][0]']      
                                                                                                  
 multiply_36 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_10[0][0]']      
                                                                                                  
 multiply_37 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_11[0][0]']      
                                                                                                  
 multiply_38 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_11[0][0]']      
                                                                                                  
 concatenate_621 (Concatena  (None, 14, 14, 768)          0         ['multiply_35[0][0]',         
 te)                                                                 'multiply_36[0][0]']         
                                                                                                  
 concatenate_622 (Concatena  (None, 14, 14, 768)          0         ['multiply_37[0][0]',         
 te)                                                                 'multiply_38[0][0]']         
                                                                                                  
 stack3_block2_attn_height_  (None, 14, 14, 384)          5376      ['concatenate_621[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block2_attn_width_d  (None, 14, 14, 384)          5376      ['concatenate_622[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block2_attn_channel  (None, 14, 14, 384)          147456    ['group_normalization_10[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_410 (Add)               (None, 14, 14, 384)          0         ['stack3_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_9  (None, 1, 1, 384)            0         ['add_410[0][0]']             
  (GlobalAveragePooling2D)                                                                        
                                                                                                  
 stack3_block2_attn_reweigh  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_9[0
 t_ (MLPBlock)                                                      ][0]']                        
                                                                                                  
 reshape_22 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block2_attn_attenti  (None, 1, 1, 384, 3)         0         ['reshape_22[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_5 (TFOpLambda)   [(None, 1, 1, 384),          0         ['stack3_block2_attn_attention
                              (None, 1, 1, 384),                    _scores[0][0]']               
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_39 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_5[0][0]']        
                                                                                                  
 multiply_40 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_5[0][1]']        
                                                                                                  
 multiply_41 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_5[0][2]']        
                                                                                                  
 add_411 (Add)               (None, 14, 14, 384)          0         ['multiply_39[0][0]',         
                                                                     'multiply_40[0][0]',         
                                                                     'multiply_41[0][0]']         
                                                                                                  
 stack3_block2_attn_out_ (C  (None, 14, 14, 384)          147840    ['add_411[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block2_attn_drop_ (  (None, 14, 14, 384)          0         ['stack3_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block2_attn_out (Ad  (None, 14, 14, 384)          0         ['stack3_block1_mlp_out[0][0]'
 d)                                                                 , 'stack3_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_11 (Gr  (None, 14, 14, 384)          768       ['stack3_block2_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block2_mlp_blocl_ (  (None, 14, 14, 384)          1181568   ['group_normalization_11[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block2_mlp_drop_ (D  (None, 14, 14, 384)          0         ['stack3_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block2_mlp_out (Add  (None, 14, 14, 384)          0         ['stack3_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_12 (Gr  (None, 14, 14, 384)          768       ['stack3_block2_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block3_attn_theta_h  (None, 14, 14, 384)          147840    ['group_normalization_12[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block3_attn_theta_w  (None, 14, 14, 384)          147840    ['group_normalization_12[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_12 (Ba  (None, 14, 14, 384)          1536      ['stack3_block3_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_13 (Ba  (None, 14, 14, 384)          1536      ['stack3_block3_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_165 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_12[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_166 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_13[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block3_attn_height_  (None, 14, 14, 384)          147456    ['group_normalization_12[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_12 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_165[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_12 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_165[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block3_attn_width_   (None, 14, 14, 384)          147456    ['group_normalization_12[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_13 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_166[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_13 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_166[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_42 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_12[0][0]']      
                                                                                                  
 multiply_43 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_12[0][0]']      
                                                                                                  
 multiply_44 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_13[0][0]']      
                                                                                                  
 multiply_45 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_13[0][0]']      
                                                                                                  
 concatenate_623 (Concatena  (None, 14, 14, 768)          0         ['multiply_42[0][0]',         
 te)                                                                 'multiply_43[0][0]']         
                                                                                                  
 concatenate_624 (Concatena  (None, 14, 14, 768)          0         ['multiply_44[0][0]',         
 te)                                                                 'multiply_45[0][0]']         
                                                                                                  
 stack3_block3_attn_height_  (None, 14, 14, 384)          5376      ['concatenate_623[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block3_attn_width_d  (None, 14, 14, 384)          5376      ['concatenate_624[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block3_attn_channel  (None, 14, 14, 384)          147456    ['group_normalization_12[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_412 (Add)               (None, 14, 14, 384)          0         ['stack3_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block3_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_1  (None, 1, 1, 384)            0         ['add_412[0][0]']             
 0 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block3_attn_reweigh  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_10[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_23 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block3_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block3_attn_attenti  (None, 1, 1, 384, 3)         0         ['reshape_23[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_6 (TFOpLambda)   [(None, 1, 1, 384),          0         ['stack3_block3_attn_attention
                              (None, 1, 1, 384),                    _scores[0][0]']               
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_46 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_6[0][0]']        
                                                                                                  
 multiply_47 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_6[0][1]']        
                                                                                                  
 multiply_48 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block3_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_6[0][2]']        
                                                                                                  
 add_413 (Add)               (None, 14, 14, 384)          0         ['multiply_46[0][0]',         
                                                                     'multiply_47[0][0]',         
                                                                     'multiply_48[0][0]']         
                                                                                                  
 stack3_block3_attn_out_ (C  (None, 14, 14, 384)          147840    ['add_413[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block3_attn_drop_ (  (None, 14, 14, 384)          0         ['stack3_block3_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block3_attn_out (Ad  (None, 14, 14, 384)          0         ['stack3_block2_mlp_out[0][0]'
 d)                                                                 , 'stack3_block3_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_13 (Gr  (None, 14, 14, 384)          768       ['stack3_block3_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block3_mlp_blocl_ (  (None, 14, 14, 384)          1181568   ['group_normalization_13[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block3_mlp_drop_ (D  (None, 14, 14, 384)          0         ['stack3_block3_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block3_mlp_out (Add  (None, 14, 14, 384)          0         ['stack3_block3_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block3_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_14 (Gr  (None, 14, 14, 384)          768       ['stack3_block3_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block4_attn_theta_h  (None, 14, 14, 384)          147840    ['group_normalization_14[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block4_attn_theta_w  (None, 14, 14, 384)          147840    ['group_normalization_14[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_14 (Ba  (None, 14, 14, 384)          1536      ['stack3_block4_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_15 (Ba  (None, 14, 14, 384)          1536      ['stack3_block4_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_167 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_14[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_168 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_15[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block4_attn_height_  (None, 14, 14, 384)          147456    ['group_normalization_14[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_14 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_167[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_14 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_167[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block4_attn_width_   (None, 14, 14, 384)          147456    ['group_normalization_14[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_15 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_168[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_15 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_168[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_49 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block4_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_14[0][0]']      
                                                                                                  
 multiply_50 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block4_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_14[0][0]']      
                                                                                                  
 multiply_51 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block4_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_15[0][0]']      
                                                                                                  
 multiply_52 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block4_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_15[0][0]']      
                                                                                                  
 concatenate_625 (Concatena  (None, 14, 14, 768)          0         ['multiply_49[0][0]',         
 te)                                                                 'multiply_50[0][0]']         
                                                                                                  
 concatenate_626 (Concatena  (None, 14, 14, 768)          0         ['multiply_51[0][0]',         
 te)                                                                 'multiply_52[0][0]']         
                                                                                                  
 stack3_block4_attn_height_  (None, 14, 14, 384)          5376      ['concatenate_625[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block4_attn_width_d  (None, 14, 14, 384)          5376      ['concatenate_626[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block4_attn_channel  (None, 14, 14, 384)          147456    ['group_normalization_14[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_414 (Add)               (None, 14, 14, 384)          0         ['stack3_block4_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block4_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block4_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_1  (None, 1, 1, 384)            0         ['add_414[0][0]']             
 1 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block4_attn_reweigh  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_11[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_24 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block4_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block4_attn_attenti  (None, 1, 1, 384, 3)         0         ['reshape_24[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_7 (TFOpLambda)   [(None, 1, 1, 384),          0         ['stack3_block4_attn_attention
                              (None, 1, 1, 384),                    _scores[0][0]']               
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_53 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block4_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_7[0][0]']        
                                                                                                  
 multiply_54 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block4_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_7[0][1]']        
                                                                                                  
 multiply_55 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block4_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_7[0][2]']        
                                                                                                  
 add_415 (Add)               (None, 14, 14, 384)          0         ['multiply_53[0][0]',         
                                                                     'multiply_54[0][0]',         
                                                                     'multiply_55[0][0]']         
                                                                                                  
 stack3_block4_attn_out_ (C  (None, 14, 14, 384)          147840    ['add_415[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block4_attn_drop_ (  (None, 14, 14, 384)          0         ['stack3_block4_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block4_attn_out (Ad  (None, 14, 14, 384)          0         ['stack3_block3_mlp_out[0][0]'
 d)                                                                 , 'stack3_block4_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_15 (Gr  (None, 14, 14, 384)          768       ['stack3_block4_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block4_mlp_blocl_ (  (None, 14, 14, 384)          1181568   ['group_normalization_15[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block4_mlp_drop_ (D  (None, 14, 14, 384)          0         ['stack3_block4_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block4_mlp_out (Add  (None, 14, 14, 384)          0         ['stack3_block4_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block4_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_16 (Gr  (None, 14, 14, 384)          768       ['stack3_block4_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block5_attn_theta_h  (None, 14, 14, 384)          147840    ['group_normalization_16[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block5_attn_theta_w  (None, 14, 14, 384)          147840    ['group_normalization_16[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_16 (Ba  (None, 14, 14, 384)          1536      ['stack3_block5_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_17 (Ba  (None, 14, 14, 384)          1536      ['stack3_block5_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_169 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_16[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_170 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_17[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block5_attn_height_  (None, 14, 14, 384)          147456    ['group_normalization_16[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_16 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_169[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_16 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_169[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block5_attn_width_   (None, 14, 14, 384)          147456    ['group_normalization_16[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_17 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_170[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_17 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_170[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_56 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block5_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_16[0][0]']      
                                                                                                  
 multiply_57 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block5_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_16[0][0]']      
                                                                                                  
 multiply_58 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block5_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_17[0][0]']      
                                                                                                  
 multiply_59 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block5_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_17[0][0]']      
                                                                                                  
 concatenate_627 (Concatena  (None, 14, 14, 768)          0         ['multiply_56[0][0]',         
 te)                                                                 'multiply_57[0][0]']         
                                                                                                  
 concatenate_628 (Concatena  (None, 14, 14, 768)          0         ['multiply_58[0][0]',         
 te)                                                                 'multiply_59[0][0]']         
                                                                                                  
 stack3_block5_attn_height_  (None, 14, 14, 384)          5376      ['concatenate_627[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block5_attn_width_d  (None, 14, 14, 384)          5376      ['concatenate_628[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block5_attn_channel  (None, 14, 14, 384)          147456    ['group_normalization_16[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_416 (Add)               (None, 14, 14, 384)          0         ['stack3_block5_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block5_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block5_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_1  (None, 1, 1, 384)            0         ['add_416[0][0]']             
 2 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block5_attn_reweigh  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_12[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_25 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block5_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block5_attn_attenti  (None, 1, 1, 384, 3)         0         ['reshape_25[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_8 (TFOpLambda)   [(None, 1, 1, 384),          0         ['stack3_block5_attn_attention
                              (None, 1, 1, 384),                    _scores[0][0]']               
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_60 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block5_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_8[0][0]']        
                                                                                                  
 multiply_61 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block5_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_8[0][1]']        
                                                                                                  
 multiply_62 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block5_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_8[0][2]']        
                                                                                                  
 add_417 (Add)               (None, 14, 14, 384)          0         ['multiply_60[0][0]',         
                                                                     'multiply_61[0][0]',         
                                                                     'multiply_62[0][0]']         
                                                                                                  
 stack3_block5_attn_out_ (C  (None, 14, 14, 384)          147840    ['add_417[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block5_attn_drop_ (  (None, 14, 14, 384)          0         ['stack3_block5_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block5_attn_out (Ad  (None, 14, 14, 384)          0         ['stack3_block4_mlp_out[0][0]'
 d)                                                                 , 'stack3_block5_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_17 (Gr  (None, 14, 14, 384)          768       ['stack3_block5_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block5_mlp_blocl_ (  (None, 14, 14, 384)          1181568   ['group_normalization_17[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block5_mlp_drop_ (D  (None, 14, 14, 384)          0         ['stack3_block5_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block5_mlp_out (Add  (None, 14, 14, 384)          0         ['stack3_block5_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block5_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_18 (Gr  (None, 14, 14, 384)          768       ['stack3_block5_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block6_attn_theta_h  (None, 14, 14, 384)          147840    ['group_normalization_18[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block6_attn_theta_w  (None, 14, 14, 384)          147840    ['group_normalization_18[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_18 (Ba  (None, 14, 14, 384)          1536      ['stack3_block6_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_19 (Ba  (None, 14, 14, 384)          1536      ['stack3_block6_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_171 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_18[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_172 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_19[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block6_attn_height_  (None, 14, 14, 384)          147456    ['group_normalization_18[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_18 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_171[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_18 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_171[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block6_attn_width_   (None, 14, 14, 384)          147456    ['group_normalization_18[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_19 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_172[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_19 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_172[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_63 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block6_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_18[0][0]']      
                                                                                                  
 multiply_64 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block6_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_18[0][0]']      
                                                                                                  
 multiply_65 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block6_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_19[0][0]']      
                                                                                                  
 multiply_66 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block6_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_19[0][0]']      
                                                                                                  
 concatenate_629 (Concatena  (None, 14, 14, 768)          0         ['multiply_63[0][0]',         
 te)                                                                 'multiply_64[0][0]']         
                                                                                                  
 concatenate_630 (Concatena  (None, 14, 14, 768)          0         ['multiply_65[0][0]',         
 te)                                                                 'multiply_66[0][0]']         
                                                                                                  
 stack3_block6_attn_height_  (None, 14, 14, 384)          5376      ['concatenate_629[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block6_attn_width_d  (None, 14, 14, 384)          5376      ['concatenate_630[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block6_attn_channel  (None, 14, 14, 384)          147456    ['group_normalization_18[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_418 (Add)               (None, 14, 14, 384)          0         ['stack3_block6_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block6_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block6_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_1  (None, 1, 1, 384)            0         ['add_418[0][0]']             
 3 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block6_attn_reweigh  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_13[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_26 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block6_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block6_attn_attenti  (None, 1, 1, 384, 3)         0         ['reshape_26[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_9 (TFOpLambda)   [(None, 1, 1, 384),          0         ['stack3_block6_attn_attention
                              (None, 1, 1, 384),                    _scores[0][0]']               
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_67 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block6_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_9[0][0]']        
                                                                                                  
 multiply_68 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block6_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_9[0][1]']        
                                                                                                  
 multiply_69 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block6_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_9[0][2]']        
                                                                                                  
 add_419 (Add)               (None, 14, 14, 384)          0         ['multiply_67[0][0]',         
                                                                     'multiply_68[0][0]',         
                                                                     'multiply_69[0][0]']         
                                                                                                  
 stack3_block6_attn_out_ (C  (None, 14, 14, 384)          147840    ['add_419[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block6_attn_drop_ (  (None, 14, 14, 384)          0         ['stack3_block6_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block6_attn_out (Ad  (None, 14, 14, 384)          0         ['stack3_block5_mlp_out[0][0]'
 d)                                                                 , 'stack3_block6_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_19 (Gr  (None, 14, 14, 384)          768       ['stack3_block6_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block6_mlp_blocl_ (  (None, 14, 14, 384)          1181568   ['group_normalization_19[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block6_mlp_drop_ (D  (None, 14, 14, 384)          0         ['stack3_block6_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block6_mlp_out (Add  (None, 14, 14, 384)          0         ['stack3_block6_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block6_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_20 (Gr  (None, 14, 14, 384)          768       ['stack3_block6_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block7_attn_theta_h  (None, 14, 14, 384)          147840    ['group_normalization_20[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block7_attn_theta_w  (None, 14, 14, 384)          147840    ['group_normalization_20[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_20 (Ba  (None, 14, 14, 384)          1536      ['stack3_block7_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_21 (Ba  (None, 14, 14, 384)          1536      ['stack3_block7_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_173 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_20[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_174 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_21[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block7_attn_height_  (None, 14, 14, 384)          147456    ['group_normalization_20[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_20 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_173[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_20 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_173[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block7_attn_width_   (None, 14, 14, 384)          147456    ['group_normalization_20[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_21 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_174[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_21 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_174[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_70 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block7_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_20[0][0]']      
                                                                                                  
 multiply_71 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block7_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_20[0][0]']      
                                                                                                  
 multiply_72 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block7_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_21[0][0]']      
                                                                                                  
 multiply_73 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block7_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_21[0][0]']      
                                                                                                  
 concatenate_631 (Concatena  (None, 14, 14, 768)          0         ['multiply_70[0][0]',         
 te)                                                                 'multiply_71[0][0]']         
                                                                                                  
 concatenate_632 (Concatena  (None, 14, 14, 768)          0         ['multiply_72[0][0]',         
 te)                                                                 'multiply_73[0][0]']         
                                                                                                  
 stack3_block7_attn_height_  (None, 14, 14, 384)          5376      ['concatenate_631[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block7_attn_width_d  (None, 14, 14, 384)          5376      ['concatenate_632[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block7_attn_channel  (None, 14, 14, 384)          147456    ['group_normalization_20[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_420 (Add)               (None, 14, 14, 384)          0         ['stack3_block7_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block7_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block7_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_1  (None, 1, 1, 384)            0         ['add_420[0][0]']             
 4 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block7_attn_reweigh  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_14[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_27 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block7_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block7_attn_attenti  (None, 1, 1, 384, 3)         0         ['reshape_27[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_10 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block7_attn_attention
                              (None, 1, 1, 384),                    _scores[0][0]']               
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_74 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block7_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_10[0][0]']       
                                                                                                  
 multiply_75 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block7_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_10[0][1]']       
                                                                                                  
 multiply_76 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block7_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_10[0][2]']       
                                                                                                  
 add_421 (Add)               (None, 14, 14, 384)          0         ['multiply_74[0][0]',         
                                                                     'multiply_75[0][0]',         
                                                                     'multiply_76[0][0]']         
                                                                                                  
 stack3_block7_attn_out_ (C  (None, 14, 14, 384)          147840    ['add_421[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block7_attn_drop_ (  (None, 14, 14, 384)          0         ['stack3_block7_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block7_attn_out (Ad  (None, 14, 14, 384)          0         ['stack3_block6_mlp_out[0][0]'
 d)                                                                 , 'stack3_block7_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_21 (Gr  (None, 14, 14, 384)          768       ['stack3_block7_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block7_mlp_blocl_ (  (None, 14, 14, 384)          1181568   ['group_normalization_21[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block7_mlp_drop_ (D  (None, 14, 14, 384)          0         ['stack3_block7_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block7_mlp_out (Add  (None, 14, 14, 384)          0         ['stack3_block7_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block7_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_22 (Gr  (None, 14, 14, 384)          768       ['stack3_block7_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block8_attn_theta_h  (None, 14, 14, 384)          147840    ['group_normalization_22[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block8_attn_theta_w  (None, 14, 14, 384)          147840    ['group_normalization_22[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_22 (Ba  (None, 14, 14, 384)          1536      ['stack3_block8_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_23 (Ba  (None, 14, 14, 384)          1536      ['stack3_block8_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_175 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_22[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_176 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_23[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block8_attn_height_  (None, 14, 14, 384)          147456    ['group_normalization_22[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_22 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_175[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_22 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_175[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block8_attn_width_   (None, 14, 14, 384)          147456    ['group_normalization_22[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_23 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_176[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_23 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_176[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_77 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block8_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_22[0][0]']      
                                                                                                  
 multiply_78 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block8_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_22[0][0]']      
                                                                                                  
 multiply_79 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block8_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_23[0][0]']      
                                                                                                  
 multiply_80 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block8_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_23[0][0]']      
                                                                                                  
 concatenate_633 (Concatena  (None, 14, 14, 768)          0         ['multiply_77[0][0]',         
 te)                                                                 'multiply_78[0][0]']         
                                                                                                  
 concatenate_634 (Concatena  (None, 14, 14, 768)          0         ['multiply_79[0][0]',         
 te)                                                                 'multiply_80[0][0]']         
                                                                                                  
 stack3_block8_attn_height_  (None, 14, 14, 384)          5376      ['concatenate_633[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block8_attn_width_d  (None, 14, 14, 384)          5376      ['concatenate_634[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block8_attn_channel  (None, 14, 14, 384)          147456    ['group_normalization_22[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_422 (Add)               (None, 14, 14, 384)          0         ['stack3_block8_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block8_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block8_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_1  (None, 1, 1, 384)            0         ['add_422[0][0]']             
 5 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block8_attn_reweigh  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_15[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_28 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block8_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block8_attn_attenti  (None, 1, 1, 384, 3)         0         ['reshape_28[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_11 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block8_attn_attention
                              (None, 1, 1, 384),                    _scores[0][0]']               
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_81 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block8_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_11[0][0]']       
                                                                                                  
 multiply_82 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block8_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_11[0][1]']       
                                                                                                  
 multiply_83 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block8_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_11[0][2]']       
                                                                                                  
 add_423 (Add)               (None, 14, 14, 384)          0         ['multiply_81[0][0]',         
                                                                     'multiply_82[0][0]',         
                                                                     'multiply_83[0][0]']         
                                                                                                  
 stack3_block8_attn_out_ (C  (None, 14, 14, 384)          147840    ['add_423[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block8_attn_drop_ (  (None, 14, 14, 384)          0         ['stack3_block8_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block8_attn_out (Ad  (None, 14, 14, 384)          0         ['stack3_block7_mlp_out[0][0]'
 d)                                                                 , 'stack3_block8_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_23 (Gr  (None, 14, 14, 384)          768       ['stack3_block8_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block8_mlp_blocl_ (  (None, 14, 14, 384)          1181568   ['group_normalization_23[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block8_mlp_drop_ (D  (None, 14, 14, 384)          0         ['stack3_block8_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block8_mlp_out (Add  (None, 14, 14, 384)          0         ['stack3_block8_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block8_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_24 (Gr  (None, 14, 14, 384)          768       ['stack3_block8_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block9_attn_theta_h  (None, 14, 14, 384)          147840    ['group_normalization_24[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block9_attn_theta_w  (None, 14, 14, 384)          147840    ['group_normalization_24[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_24 (Ba  (None, 14, 14, 384)          1536      ['stack3_block9_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_25 (Ba  (None, 14, 14, 384)          1536      ['stack3_block9_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_177 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_24[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_178 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_25[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block9_attn_height_  (None, 14, 14, 384)          147456    ['group_normalization_24[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_24 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_177[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_24 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_177[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block9_attn_width_   (None, 14, 14, 384)          147456    ['group_normalization_24[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_25 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_178[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_25 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_178[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_84 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block9_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_24[0][0]']      
                                                                                                  
 multiply_85 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block9_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_24[0][0]']      
                                                                                                  
 multiply_86 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block9_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_25[0][0]']      
                                                                                                  
 multiply_87 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block9_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_25[0][0]']      
                                                                                                  
 concatenate_635 (Concatena  (None, 14, 14, 768)          0         ['multiply_84[0][0]',         
 te)                                                                 'multiply_85[0][0]']         
                                                                                                  
 concatenate_636 (Concatena  (None, 14, 14, 768)          0         ['multiply_86[0][0]',         
 te)                                                                 'multiply_87[0][0]']         
                                                                                                  
 stack3_block9_attn_height_  (None, 14, 14, 384)          5376      ['concatenate_635[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block9_attn_width_d  (None, 14, 14, 384)          5376      ['concatenate_636[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block9_attn_channel  (None, 14, 14, 384)          147456    ['group_normalization_24[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_424 (Add)               (None, 14, 14, 384)          0         ['stack3_block9_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block9_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block9_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_1  (None, 1, 1, 384)            0         ['add_424[0][0]']             
 6 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block9_attn_reweigh  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_16[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_29 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block9_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block9_attn_attenti  (None, 1, 1, 384, 3)         0         ['reshape_29[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_12 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block9_attn_attention
                              (None, 1, 1, 384),                    _scores[0][0]']               
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_88 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block9_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_12[0][0]']       
                                                                                                  
 multiply_89 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block9_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_12[0][1]']       
                                                                                                  
 multiply_90 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block9_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_12[0][2]']       
                                                                                                  
 add_425 (Add)               (None, 14, 14, 384)          0         ['multiply_88[0][0]',         
                                                                     'multiply_89[0][0]',         
                                                                     'multiply_90[0][0]']         
                                                                                                  
 stack3_block9_attn_out_ (C  (None, 14, 14, 384)          147840    ['add_425[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block9_attn_drop_ (  (None, 14, 14, 384)          0         ['stack3_block9_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block9_attn_out (Ad  (None, 14, 14, 384)          0         ['stack3_block8_mlp_out[0][0]'
 d)                                                                 , 'stack3_block9_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_25 (Gr  (None, 14, 14, 384)          768       ['stack3_block9_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block9_mlp_blocl_ (  (None, 14, 14, 384)          1181568   ['group_normalization_25[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block9_mlp_drop_ (D  (None, 14, 14, 384)          0         ['stack3_block9_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block9_mlp_out (Add  (None, 14, 14, 384)          0         ['stack3_block9_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block9_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_26 (Gr  (None, 14, 14, 384)          768       ['stack3_block9_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block10_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_26[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block10_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_26[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_26 (Ba  (None, 14, 14, 384)          1536      ['stack3_block10_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_27 (Ba  (None, 14, 14, 384)          1536      ['stack3_block10_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_179 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_26[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_180 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_27[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block10_attn_height  (None, 14, 14, 384)          147456    ['group_normalization_26[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_26 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_179[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_26 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_179[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block10_attn_width_  (None, 14, 14, 384)          147456    ['group_normalization_26[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_27 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_180[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_27 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_180[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_91 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block10_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_26[0][0]']      
                                                                                                  
 multiply_92 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block10_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_26[0][0]']      
                                                                                                  
 multiply_93 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block10_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_27[0][0]']      
                                                                                                  
 multiply_94 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block10_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_27[0][0]']      
                                                                                                  
 concatenate_637 (Concatena  (None, 14, 14, 768)          0         ['multiply_91[0][0]',         
 te)                                                                 'multiply_92[0][0]']         
                                                                                                  
 concatenate_638 (Concatena  (None, 14, 14, 768)          0         ['multiply_93[0][0]',         
 te)                                                                 'multiply_94[0][0]']         
                                                                                                  
 stack3_block10_attn_height  (None, 14, 14, 384)          5376      ['concatenate_637[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block10_attn_width_  (None, 14, 14, 384)          5376      ['concatenate_638[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block10_attn_channe  (None, 14, 14, 384)          147456    ['group_normalization_26[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_426 (Add)               (None, 14, 14, 384)          0         ['stack3_block10_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block10_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block10_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_1  (None, 1, 1, 384)            0         ['add_426[0][0]']             
 7 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block10_attn_reweig  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_17[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_30 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block10_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block10_attn_attent  (None, 1, 1, 384, 3)         0         ['reshape_30[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_13 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block10_attn_attentio
                              (None, 1, 1, 384),                    n_scores[0][0]']              
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_95 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block10_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_13[0][0]']       
                                                                                                  
 multiply_96 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block10_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_13[0][1]']       
                                                                                                  
 multiply_97 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block10_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_13[0][2]']       
                                                                                                  
 add_427 (Add)               (None, 14, 14, 384)          0         ['multiply_95[0][0]',         
                                                                     'multiply_96[0][0]',         
                                                                     'multiply_97[0][0]']         
                                                                                                  
 stack3_block10_attn_out_ (  (None, 14, 14, 384)          147840    ['add_427[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block10_attn_drop_   (None, 14, 14, 384)          0         ['stack3_block10_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block10_attn_out (A  (None, 14, 14, 384)          0         ['stack3_block9_mlp_out[0][0]'
 dd)                                                                , 'stack3_block10_attn_drop_[0
                                                                    ][0]']                        
                                                                                                  
 group_normalization_27 (Gr  (None, 14, 14, 384)          768       ['stack3_block10_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block10_mlp_blocl_   (None, 14, 14, 384)          1181568   ['group_normalization_27[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block10_mlp_drop_ (  (None, 14, 14, 384)          0         ['stack3_block10_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block10_mlp_out (Ad  (None, 14, 14, 384)          0         ['stack3_block10_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block10_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_28 (Gr  (None, 14, 14, 384)          768       ['stack3_block10_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block11_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_28[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block11_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_28[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_28 (Ba  (None, 14, 14, 384)          1536      ['stack3_block11_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_29 (Ba  (None, 14, 14, 384)          1536      ['stack3_block11_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_181 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_28[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_182 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_29[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block11_attn_height  (None, 14, 14, 384)          147456    ['group_normalization_28[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_28 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_181[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_28 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_181[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block11_attn_width_  (None, 14, 14, 384)          147456    ['group_normalization_28[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_29 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_182[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_29 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_182[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_98 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block11_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_28[0][0]']      
                                                                                                  
 multiply_99 (Multiply)      (None, 14, 14, 384)          0         ['stack3_block11_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_28[0][0]']      
                                                                                                  
 multiply_100 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block11_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_29[0][0]']      
                                                                                                  
 multiply_101 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block11_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_29[0][0]']      
                                                                                                  
 concatenate_639 (Concatena  (None, 14, 14, 768)          0         ['multiply_98[0][0]',         
 te)                                                                 'multiply_99[0][0]']         
                                                                                                  
 concatenate_640 (Concatena  (None, 14, 14, 768)          0         ['multiply_100[0][0]',        
 te)                                                                 'multiply_101[0][0]']        
                                                                                                  
 stack3_block11_attn_height  (None, 14, 14, 384)          5376      ['concatenate_639[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block11_attn_width_  (None, 14, 14, 384)          5376      ['concatenate_640[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block11_attn_channe  (None, 14, 14, 384)          147456    ['group_normalization_28[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_428 (Add)               (None, 14, 14, 384)          0         ['stack3_block11_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block11_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block11_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_1  (None, 1, 1, 384)            0         ['add_428[0][0]']             
 8 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block11_attn_reweig  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_18[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_31 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block11_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block11_attn_attent  (None, 1, 1, 384, 3)         0         ['reshape_31[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_14 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block11_attn_attentio
                              (None, 1, 1, 384),                    n_scores[0][0]']              
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_102 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block11_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_14[0][0]']       
                                                                                                  
 multiply_103 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block11_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_14[0][1]']       
                                                                                                  
 multiply_104 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block11_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_14[0][2]']       
                                                                                                  
 add_429 (Add)               (None, 14, 14, 384)          0         ['multiply_102[0][0]',        
                                                                     'multiply_103[0][0]',        
                                                                     'multiply_104[0][0]']        
                                                                                                  
 stack3_block11_attn_out_ (  (None, 14, 14, 384)          147840    ['add_429[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block11_attn_drop_   (None, 14, 14, 384)          0         ['stack3_block11_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block11_attn_out (A  (None, 14, 14, 384)          0         ['stack3_block10_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block11_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_29 (Gr  (None, 14, 14, 384)          768       ['stack3_block11_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block11_mlp_blocl_   (None, 14, 14, 384)          1181568   ['group_normalization_29[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block11_mlp_drop_ (  (None, 14, 14, 384)          0         ['stack3_block11_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block11_mlp_out (Ad  (None, 14, 14, 384)          0         ['stack3_block11_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block11_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_30 (Gr  (None, 14, 14, 384)          768       ['stack3_block11_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block12_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_30[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block12_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_30[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_30 (Ba  (None, 14, 14, 384)          1536      ['stack3_block12_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_31 (Ba  (None, 14, 14, 384)          1536      ['stack3_block12_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_183 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_30[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_184 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_31[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block12_attn_height  (None, 14, 14, 384)          147456    ['group_normalization_30[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_30 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_183[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_30 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_183[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block12_attn_width_  (None, 14, 14, 384)          147456    ['group_normalization_30[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_31 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_184[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_31 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_184[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_105 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block12_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_30[0][0]']      
                                                                                                  
 multiply_106 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block12_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_30[0][0]']      
                                                                                                  
 multiply_107 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block12_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_31[0][0]']      
                                                                                                  
 multiply_108 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block12_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_31[0][0]']      
                                                                                                  
 concatenate_641 (Concatena  (None, 14, 14, 768)          0         ['multiply_105[0][0]',        
 te)                                                                 'multiply_106[0][0]']        
                                                                                                  
 concatenate_642 (Concatena  (None, 14, 14, 768)          0         ['multiply_107[0][0]',        
 te)                                                                 'multiply_108[0][0]']        
                                                                                                  
 stack3_block12_attn_height  (None, 14, 14, 384)          5376      ['concatenate_641[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block12_attn_width_  (None, 14, 14, 384)          5376      ['concatenate_642[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block12_attn_channe  (None, 14, 14, 384)          147456    ['group_normalization_30[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_430 (Add)               (None, 14, 14, 384)          0         ['stack3_block12_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block12_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block12_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_1  (None, 1, 1, 384)            0         ['add_430[0][0]']             
 9 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block12_attn_reweig  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_19[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_32 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block12_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block12_attn_attent  (None, 1, 1, 384, 3)         0         ['reshape_32[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_15 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block12_attn_attentio
                              (None, 1, 1, 384),                    n_scores[0][0]']              
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_109 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block12_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_15[0][0]']       
                                                                                                  
 multiply_110 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block12_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_15[0][1]']       
                                                                                                  
 multiply_111 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block12_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_15[0][2]']       
                                                                                                  
 add_431 (Add)               (None, 14, 14, 384)          0         ['multiply_109[0][0]',        
                                                                     'multiply_110[0][0]',        
                                                                     'multiply_111[0][0]']        
                                                                                                  
 stack3_block12_attn_out_ (  (None, 14, 14, 384)          147840    ['add_431[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block12_attn_drop_   (None, 14, 14, 384)          0         ['stack3_block12_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block12_attn_out (A  (None, 14, 14, 384)          0         ['stack3_block11_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block12_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_31 (Gr  (None, 14, 14, 384)          768       ['stack3_block12_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block12_mlp_blocl_   (None, 14, 14, 384)          1181568   ['group_normalization_31[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block12_mlp_drop_ (  (None, 14, 14, 384)          0         ['stack3_block12_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block12_mlp_out (Ad  (None, 14, 14, 384)          0         ['stack3_block12_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block12_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_32 (Gr  (None, 14, 14, 384)          768       ['stack3_block12_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block13_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_32[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block13_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_32[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_32 (Ba  (None, 14, 14, 384)          1536      ['stack3_block13_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_33 (Ba  (None, 14, 14, 384)          1536      ['stack3_block13_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_185 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_32[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_186 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_33[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block13_attn_height  (None, 14, 14, 384)          147456    ['group_normalization_32[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_32 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_185[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_32 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_185[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block13_attn_width_  (None, 14, 14, 384)          147456    ['group_normalization_32[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_33 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_186[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_33 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_186[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_112 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block13_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_32[0][0]']      
                                                                                                  
 multiply_113 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block13_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_32[0][0]']      
                                                                                                  
 multiply_114 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block13_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_33[0][0]']      
                                                                                                  
 multiply_115 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block13_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_33[0][0]']      
                                                                                                  
 concatenate_643 (Concatena  (None, 14, 14, 768)          0         ['multiply_112[0][0]',        
 te)                                                                 'multiply_113[0][0]']        
                                                                                                  
 concatenate_644 (Concatena  (None, 14, 14, 768)          0         ['multiply_114[0][0]',        
 te)                                                                 'multiply_115[0][0]']        
                                                                                                  
 stack3_block13_attn_height  (None, 14, 14, 384)          5376      ['concatenate_643[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block13_attn_width_  (None, 14, 14, 384)          5376      ['concatenate_644[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block13_attn_channe  (None, 14, 14, 384)          147456    ['group_normalization_32[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_432 (Add)               (None, 14, 14, 384)          0         ['stack3_block13_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block13_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block13_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_2  (None, 1, 1, 384)            0         ['add_432[0][0]']             
 0 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block13_attn_reweig  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_20[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_33 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block13_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block13_attn_attent  (None, 1, 1, 384, 3)         0         ['reshape_33[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_16 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block13_attn_attentio
                              (None, 1, 1, 384),                    n_scores[0][0]']              
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_116 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block13_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_16[0][0]']       
                                                                                                  
 multiply_117 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block13_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_16[0][1]']       
                                                                                                  
 multiply_118 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block13_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_16[0][2]']       
                                                                                                  
 add_433 (Add)               (None, 14, 14, 384)          0         ['multiply_116[0][0]',        
                                                                     'multiply_117[0][0]',        
                                                                     'multiply_118[0][0]']        
                                                                                                  
 stack3_block13_attn_out_ (  (None, 14, 14, 384)          147840    ['add_433[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block13_attn_drop_   (None, 14, 14, 384)          0         ['stack3_block13_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block13_attn_out (A  (None, 14, 14, 384)          0         ['stack3_block12_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block13_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_33 (Gr  (None, 14, 14, 384)          768       ['stack3_block13_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block13_mlp_blocl_   (None, 14, 14, 384)          1181568   ['group_normalization_33[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block13_mlp_drop_ (  (None, 14, 14, 384)          0         ['stack3_block13_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block13_mlp_out (Ad  (None, 14, 14, 384)          0         ['stack3_block13_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block13_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_34 (Gr  (None, 14, 14, 384)          768       ['stack3_block13_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block14_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_34[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block14_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_34[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_34 (Ba  (None, 14, 14, 384)          1536      ['stack3_block14_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_35 (Ba  (None, 14, 14, 384)          1536      ['stack3_block14_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_187 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_34[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_188 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_35[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block14_attn_height  (None, 14, 14, 384)          147456    ['group_normalization_34[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_34 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_187[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_34 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_187[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block14_attn_width_  (None, 14, 14, 384)          147456    ['group_normalization_34[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_35 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_188[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_35 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_188[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_119 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block14_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_34[0][0]']      
                                                                                                  
 multiply_120 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block14_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_34[0][0]']      
                                                                                                  
 multiply_121 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block14_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_35[0][0]']      
                                                                                                  
 multiply_122 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block14_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_35[0][0]']      
                                                                                                  
 concatenate_645 (Concatena  (None, 14, 14, 768)          0         ['multiply_119[0][0]',        
 te)                                                                 'multiply_120[0][0]']        
                                                                                                  
 concatenate_646 (Concatena  (None, 14, 14, 768)          0         ['multiply_121[0][0]',        
 te)                                                                 'multiply_122[0][0]']        
                                                                                                  
 stack3_block14_attn_height  (None, 14, 14, 384)          5376      ['concatenate_645[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block14_attn_width_  (None, 14, 14, 384)          5376      ['concatenate_646[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block14_attn_channe  (None, 14, 14, 384)          147456    ['group_normalization_34[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_434 (Add)               (None, 14, 14, 384)          0         ['stack3_block14_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block14_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block14_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_2  (None, 1, 1, 384)            0         ['add_434[0][0]']             
 1 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block14_attn_reweig  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_21[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_34 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block14_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block14_attn_attent  (None, 1, 1, 384, 3)         0         ['reshape_34[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_17 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block14_attn_attentio
                              (None, 1, 1, 384),                    n_scores[0][0]']              
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_123 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block14_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_17[0][0]']       
                                                                                                  
 multiply_124 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block14_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_17[0][1]']       
                                                                                                  
 multiply_125 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block14_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_17[0][2]']       
                                                                                                  
 add_435 (Add)               (None, 14, 14, 384)          0         ['multiply_123[0][0]',        
                                                                     'multiply_124[0][0]',        
                                                                     'multiply_125[0][0]']        
                                                                                                  
 stack3_block14_attn_out_ (  (None, 14, 14, 384)          147840    ['add_435[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block14_attn_drop_   (None, 14, 14, 384)          0         ['stack3_block14_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block14_attn_out (A  (None, 14, 14, 384)          0         ['stack3_block13_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block14_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_35 (Gr  (None, 14, 14, 384)          768       ['stack3_block14_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block14_mlp_blocl_   (None, 14, 14, 384)          1181568   ['group_normalization_35[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block14_mlp_drop_ (  (None, 14, 14, 384)          0         ['stack3_block14_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block14_mlp_out (Ad  (None, 14, 14, 384)          0         ['stack3_block14_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block14_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_36 (Gr  (None, 14, 14, 384)          768       ['stack3_block14_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block15_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_36[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block15_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_36[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_36 (Ba  (None, 14, 14, 384)          1536      ['stack3_block15_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_37 (Ba  (None, 14, 14, 384)          1536      ['stack3_block15_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_189 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_36[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_190 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_37[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block15_attn_height  (None, 14, 14, 384)          147456    ['group_normalization_36[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_36 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_189[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_36 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_189[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block15_attn_width_  (None, 14, 14, 384)          147456    ['group_normalization_36[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_37 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_190[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_37 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_190[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_126 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block15_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_36[0][0]']      
                                                                                                  
 multiply_127 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block15_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_36[0][0]']      
                                                                                                  
 multiply_128 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block15_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_37[0][0]']      
                                                                                                  
 multiply_129 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block15_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_37[0][0]']      
                                                                                                  
 concatenate_647 (Concatena  (None, 14, 14, 768)          0         ['multiply_126[0][0]',        
 te)                                                                 'multiply_127[0][0]']        
                                                                                                  
 concatenate_648 (Concatena  (None, 14, 14, 768)          0         ['multiply_128[0][0]',        
 te)                                                                 'multiply_129[0][0]']        
                                                                                                  
 stack3_block15_attn_height  (None, 14, 14, 384)          5376      ['concatenate_647[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block15_attn_width_  (None, 14, 14, 384)          5376      ['concatenate_648[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block15_attn_channe  (None, 14, 14, 384)          147456    ['group_normalization_36[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_436 (Add)               (None, 14, 14, 384)          0         ['stack3_block15_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block15_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block15_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_2  (None, 1, 1, 384)            0         ['add_436[0][0]']             
 2 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block15_attn_reweig  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_22[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_35 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block15_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block15_attn_attent  (None, 1, 1, 384, 3)         0         ['reshape_35[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_18 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block15_attn_attentio
                              (None, 1, 1, 384),                    n_scores[0][0]']              
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_130 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block15_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_18[0][0]']       
                                                                                                  
 multiply_131 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block15_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_18[0][1]']       
                                                                                                  
 multiply_132 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block15_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_18[0][2]']       
                                                                                                  
 add_437 (Add)               (None, 14, 14, 384)          0         ['multiply_130[0][0]',        
                                                                     'multiply_131[0][0]',        
                                                                     'multiply_132[0][0]']        
                                                                                                  
 stack3_block15_attn_out_ (  (None, 14, 14, 384)          147840    ['add_437[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block15_attn_drop_   (None, 14, 14, 384)          0         ['stack3_block15_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block15_attn_out (A  (None, 14, 14, 384)          0         ['stack3_block14_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block15_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_37 (Gr  (None, 14, 14, 384)          768       ['stack3_block15_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block15_mlp_blocl_   (None, 14, 14, 384)          1181568   ['group_normalization_37[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block15_mlp_drop_ (  (None, 14, 14, 384)          0         ['stack3_block15_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block15_mlp_out (Ad  (None, 14, 14, 384)          0         ['stack3_block15_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block15_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_38 (Gr  (None, 14, 14, 384)          768       ['stack3_block15_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block16_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_38[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block16_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_38[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_38 (Ba  (None, 14, 14, 384)          1536      ['stack3_block16_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_39 (Ba  (None, 14, 14, 384)          1536      ['stack3_block16_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_191 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_38[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_192 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_39[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block16_attn_height  (None, 14, 14, 384)          147456    ['group_normalization_38[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_38 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_191[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_38 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_191[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block16_attn_width_  (None, 14, 14, 384)          147456    ['group_normalization_38[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_39 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_192[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_39 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_192[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_133 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block16_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_38[0][0]']      
                                                                                                  
 multiply_134 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block16_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_38[0][0]']      
                                                                                                  
 multiply_135 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block16_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_39[0][0]']      
                                                                                                  
 multiply_136 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block16_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_39[0][0]']      
                                                                                                  
 concatenate_649 (Concatena  (None, 14, 14, 768)          0         ['multiply_133[0][0]',        
 te)                                                                 'multiply_134[0][0]']        
                                                                                                  
 concatenate_650 (Concatena  (None, 14, 14, 768)          0         ['multiply_135[0][0]',        
 te)                                                                 'multiply_136[0][0]']        
                                                                                                  
 stack3_block16_attn_height  (None, 14, 14, 384)          5376      ['concatenate_649[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block16_attn_width_  (None, 14, 14, 384)          5376      ['concatenate_650[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block16_attn_channe  (None, 14, 14, 384)          147456    ['group_normalization_38[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_438 (Add)               (None, 14, 14, 384)          0         ['stack3_block16_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block16_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block16_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_2  (None, 1, 1, 384)            0         ['add_438[0][0]']             
 3 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block16_attn_reweig  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_23[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_36 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block16_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block16_attn_attent  (None, 1, 1, 384, 3)         0         ['reshape_36[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_19 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block16_attn_attentio
                              (None, 1, 1, 384),                    n_scores[0][0]']              
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_137 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block16_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_19[0][0]']       
                                                                                                  
 multiply_138 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block16_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_19[0][1]']       
                                                                                                  
 multiply_139 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block16_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_19[0][2]']       
                                                                                                  
 add_439 (Add)               (None, 14, 14, 384)          0         ['multiply_137[0][0]',        
                                                                     'multiply_138[0][0]',        
                                                                     'multiply_139[0][0]']        
                                                                                                  
 stack3_block16_attn_out_ (  (None, 14, 14, 384)          147840    ['add_439[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block16_attn_drop_   (None, 14, 14, 384)          0         ['stack3_block16_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block16_attn_out (A  (None, 14, 14, 384)          0         ['stack3_block15_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block16_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_39 (Gr  (None, 14, 14, 384)          768       ['stack3_block16_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block16_mlp_blocl_   (None, 14, 14, 384)          1181568   ['group_normalization_39[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block16_mlp_drop_ (  (None, 14, 14, 384)          0         ['stack3_block16_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block16_mlp_out (Ad  (None, 14, 14, 384)          0         ['stack3_block16_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block16_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_40 (Gr  (None, 14, 14, 384)          768       ['stack3_block16_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block17_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_40[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block17_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_40[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_40 (Ba  (None, 14, 14, 384)          1536      ['stack3_block17_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_41 (Ba  (None, 14, 14, 384)          1536      ['stack3_block17_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_193 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_40[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_194 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_41[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block17_attn_height  (None, 14, 14, 384)          147456    ['group_normalization_40[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_40 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_193[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_40 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_193[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block17_attn_width_  (None, 14, 14, 384)          147456    ['group_normalization_40[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_41 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_194[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_41 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_194[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_140 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block17_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_40[0][0]']      
                                                                                                  
 multiply_141 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block17_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_40[0][0]']      
                                                                                                  
 multiply_142 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block17_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_41[0][0]']      
                                                                                                  
 multiply_143 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block17_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_41[0][0]']      
                                                                                                  
 concatenate_651 (Concatena  (None, 14, 14, 768)          0         ['multiply_140[0][0]',        
 te)                                                                 'multiply_141[0][0]']        
                                                                                                  
 concatenate_652 (Concatena  (None, 14, 14, 768)          0         ['multiply_142[0][0]',        
 te)                                                                 'multiply_143[0][0]']        
                                                                                                  
 stack3_block17_attn_height  (None, 14, 14, 384)          5376      ['concatenate_651[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block17_attn_width_  (None, 14, 14, 384)          5376      ['concatenate_652[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block17_attn_channe  (None, 14, 14, 384)          147456    ['group_normalization_40[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_440 (Add)               (None, 14, 14, 384)          0         ['stack3_block17_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block17_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block17_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_2  (None, 1, 1, 384)            0         ['add_440[0][0]']             
 4 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block17_attn_reweig  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_24[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_37 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block17_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block17_attn_attent  (None, 1, 1, 384, 3)         0         ['reshape_37[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_20 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block17_attn_attentio
                              (None, 1, 1, 384),                    n_scores[0][0]']              
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_144 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block17_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_20[0][0]']       
                                                                                                  
 multiply_145 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block17_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_20[0][1]']       
                                                                                                  
 multiply_146 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block17_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_20[0][2]']       
                                                                                                  
 add_441 (Add)               (None, 14, 14, 384)          0         ['multiply_144[0][0]',        
                                                                     'multiply_145[0][0]',        
                                                                     'multiply_146[0][0]']        
                                                                                                  
 stack3_block17_attn_out_ (  (None, 14, 14, 384)          147840    ['add_441[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block17_attn_drop_   (None, 14, 14, 384)          0         ['stack3_block17_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block17_attn_out (A  (None, 14, 14, 384)          0         ['stack3_block16_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block17_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_41 (Gr  (None, 14, 14, 384)          768       ['stack3_block17_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block17_mlp_blocl_   (None, 14, 14, 384)          1181568   ['group_normalization_41[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block17_mlp_drop_ (  (None, 14, 14, 384)          0         ['stack3_block17_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block17_mlp_out (Ad  (None, 14, 14, 384)          0         ['stack3_block17_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block17_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_42 (Gr  (None, 14, 14, 384)          768       ['stack3_block17_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block18_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_42[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block18_attn_theta_  (None, 14, 14, 384)          147840    ['group_normalization_42[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_42 (Ba  (None, 14, 14, 384)          1536      ['stack3_block18_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_43 (Ba  (None, 14, 14, 384)          1536      ['stack3_block18_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_195 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_42[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_196 (Activation  (None, 14, 14, 384)          0         ['batch_normalization_43[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block18_attn_height  (None, 14, 14, 384)          147456    ['group_normalization_42[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_42 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_195[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_42 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_195[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block18_attn_width_  (None, 14, 14, 384)          147456    ['group_normalization_42[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_43 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_196[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_43 (TFOpLambda  (None, 14, 14, 384)          0         ['activation_196[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_147 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block18_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_42[0][0]']      
                                                                                                  
 multiply_148 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block18_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_42[0][0]']      
                                                                                                  
 multiply_149 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block18_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_43[0][0]']      
                                                                                                  
 multiply_150 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block18_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_43[0][0]']      
                                                                                                  
 concatenate_653 (Concatena  (None, 14, 14, 768)          0         ['multiply_147[0][0]',        
 te)                                                                 'multiply_148[0][0]']        
                                                                                                  
 concatenate_654 (Concatena  (None, 14, 14, 768)          0         ['multiply_149[0][0]',        
 te)                                                                 'multiply_150[0][0]']        
                                                                                                  
 stack3_block18_attn_height  (None, 14, 14, 384)          5376      ['concatenate_653[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block18_attn_width_  (None, 14, 14, 384)          5376      ['concatenate_654[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block18_attn_channe  (None, 14, 14, 384)          147456    ['group_normalization_42[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_442 (Add)               (None, 14, 14, 384)          0         ['stack3_block18_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block18_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block18_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_2  (None, 1, 1, 384)            0         ['add_442[0][0]']             
 5 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block18_attn_reweig  (None, 1, 1, 1152)           148704    ['global_average_pooling2d_25[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_38 (Reshape)        (None, 1, 1, 384, 3)         0         ['stack3_block18_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block18_attn_attent  (None, 1, 1, 384, 3)         0         ['reshape_38[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_21 (TFOpLambda)  [(None, 1, 1, 384),          0         ['stack3_block18_attn_attentio
                              (None, 1, 1, 384),                    n_scores[0][0]']              
                              (None, 1, 1, 384)]                                                  
                                                                                                  
 multiply_151 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block18_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_21[0][0]']       
                                                                                                  
 multiply_152 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block18_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_21[0][1]']       
                                                                                                  
 multiply_153 (Multiply)     (None, 14, 14, 384)          0         ['stack3_block18_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_21[0][2]']       
                                                                                                  
 add_443 (Add)               (None, 14, 14, 384)          0         ['multiply_151[0][0]',        
                                                                     'multiply_152[0][0]',        
                                                                     'multiply_153[0][0]']        
                                                                                                  
 stack3_block18_attn_out_ (  (None, 14, 14, 384)          147840    ['add_443[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block18_attn_drop_   (None, 14, 14, 384)          0         ['stack3_block18_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block18_attn_out (A  (None, 14, 14, 384)          0         ['stack3_block17_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block18_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_43 (Gr  (None, 14, 14, 384)          768       ['stack3_block18_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block18_mlp_blocl_   (None, 14, 14, 384)          1181568   ['group_normalization_43[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block18_mlp_drop_ (  (None, 14, 14, 384)          0         ['stack3_block18_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block18_mlp_out (Ad  (None, 14, 14, 384)          0         ['stack3_block18_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block18_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 stack4_down_sample_ (Conv2  (None, 7, 7, 768)            2654976   ['stack3_block18_mlp_out[0][0]
 D)                                                                 ']                            
                                                                                                  
 group_normalization_44 (Gr  (None, 7, 7, 768)            1536      ['stack4_down_sample_[0][0]'] 
 oupNormalization)                                                                                
                                                                                                  
 stack4_block1_attn_theta_h  (None, 7, 7, 768)            590592    ['group_normalization_44[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack4_block1_attn_theta_w  (None, 7, 7, 768)            590592    ['group_normalization_44[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_44 (Ba  (None, 7, 7, 768)            3072      ['stack4_block1_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_45 (Ba  (None, 7, 7, 768)            3072      ['stack4_block1_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_197 (Activation  (None, 7, 7, 768)            0         ['batch_normalization_44[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_198 (Activation  (None, 7, 7, 768)            0         ['batch_normalization_45[0][0]
 )                                                                  ']                            
                                                                                                  
 stack4_block1_attn_height_  (None, 7, 7, 768)            589824    ['group_normalization_44[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_44 (TFOpLambda  (None, 7, 7, 768)            0         ['activation_197[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_44 (TFOpLambda  (None, 7, 7, 768)            0         ['activation_197[0][0]']      
 )                                                                                                
                                                                                                  
 stack4_block1_attn_width_   (None, 7, 7, 768)            589824    ['group_normalization_44[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_45 (TFOpLambda  (None, 7, 7, 768)            0         ['activation_198[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_45 (TFOpLambda  (None, 7, 7, 768)            0         ['activation_198[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_154 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_44[0][0]']      
                                                                                                  
 multiply_155 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_44[0][0]']      
                                                                                                  
 multiply_156 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_45[0][0]']      
                                                                                                  
 multiply_157 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_45[0][0]']      
                                                                                                  
 concatenate_655 (Concatena  (None, 7, 7, 1536)           0         ['multiply_154[0][0]',        
 te)                                                                 'multiply_155[0][0]']        
                                                                                                  
 concatenate_656 (Concatena  (None, 7, 7, 1536)           0         ['multiply_156[0][0]',        
 te)                                                                 'multiply_157[0][0]']        
                                                                                                  
 stack4_block1_attn_height_  (None, 7, 7, 768)            10752     ['concatenate_655[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack4_block1_attn_width_d  (None, 7, 7, 768)            10752     ['concatenate_656[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack4_block1_attn_channel  (None, 7, 7, 768)            589824    ['group_normalization_44[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_444 (Add)               (None, 7, 7, 768)            0         ['stack4_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack4_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack4_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_2  (None, 1, 1, 768)            0         ['add_444[0][0]']             
 6 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack4_block1_attn_reweigh  (None, 1, 1, 2304)           592320    ['global_average_pooling2d_26[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_39 (Reshape)        (None, 1, 1, 768, 3)         0         ['stack4_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack4_block1_attn_attenti  (None, 1, 1, 768, 3)         0         ['reshape_39[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_22 (TFOpLambda)  [(None, 1, 1, 768),          0         ['stack4_block1_attn_attention
                              (None, 1, 1, 768),                    _scores[0][0]']               
                              (None, 1, 1, 768)]                                                  
                                                                                                  
 multiply_158 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_22[0][0]']       
                                                                                                  
 multiply_159 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_22[0][1]']       
                                                                                                  
 multiply_160 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_22[0][2]']       
                                                                                                  
 add_445 (Add)               (None, 7, 7, 768)            0         ['multiply_158[0][0]',        
                                                                     'multiply_159[0][0]',        
                                                                     'multiply_160[0][0]']        
                                                                                                  
 stack4_block1_attn_out_ (C  (None, 7, 7, 768)            590592    ['add_445[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack4_block1_attn_drop_ (  (None, 7, 7, 768)            0         ['stack4_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack4_block1_attn_out (Ad  (None, 7, 7, 768)            0         ['stack4_down_sample_[0][0]', 
 d)                                                                  'stack4_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_45 (Gr  (None, 7, 7, 768)            1536      ['stack4_block1_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack4_block1_mlp_blocl_ (  (None, 7, 7, 768)            4722432   ['group_normalization_45[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack4_block1_mlp_drop_ (D  (None, 7, 7, 768)            0         ['stack4_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack4_block1_mlp_out (Add  (None, 7, 7, 768)            0         ['stack4_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack4_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_46 (Gr  (None, 7, 7, 768)            1536      ['stack4_block1_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack4_block2_attn_theta_h  (None, 7, 7, 768)            590592    ['group_normalization_46[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack4_block2_attn_theta_w  (None, 7, 7, 768)            590592    ['group_normalization_46[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_46 (Ba  (None, 7, 7, 768)            3072      ['stack4_block2_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_47 (Ba  (None, 7, 7, 768)            3072      ['stack4_block2_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_199 (Activation  (None, 7, 7, 768)            0         ['batch_normalization_46[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_200 (Activation  (None, 7, 7, 768)            0         ['batch_normalization_47[0][0]
 )                                                                  ']                            
                                                                                                  
 stack4_block2_attn_height_  (None, 7, 7, 768)            589824    ['group_normalization_46[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_46 (TFOpLambda  (None, 7, 7, 768)            0         ['activation_199[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_46 (TFOpLambda  (None, 7, 7, 768)            0         ['activation_199[0][0]']      
 )                                                                                                
                                                                                                  
 stack4_block2_attn_width_   (None, 7, 7, 768)            589824    ['group_normalization_46[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_47 (TFOpLambda  (None, 7, 7, 768)            0         ['activation_200[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_47 (TFOpLambda  (None, 7, 7, 768)            0         ['activation_200[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_161 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_46[0][0]']      
                                                                                                  
 multiply_162 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_46[0][0]']      
                                                                                                  
 multiply_163 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_47[0][0]']      
                                                                                                  
 multiply_164 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_47[0][0]']      
                                                                                                  
 concatenate_657 (Concatena  (None, 7, 7, 1536)           0         ['multiply_161[0][0]',        
 te)                                                                 'multiply_162[0][0]']        
                                                                                                  
 concatenate_658 (Concatena  (None, 7, 7, 1536)           0         ['multiply_163[0][0]',        
 te)                                                                 'multiply_164[0][0]']        
                                                                                                  
 stack4_block2_attn_height_  (None, 7, 7, 768)            10752     ['concatenate_657[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack4_block2_attn_width_d  (None, 7, 7, 768)            10752     ['concatenate_658[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack4_block2_attn_channel  (None, 7, 7, 768)            589824    ['group_normalization_46[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_446 (Add)               (None, 7, 7, 768)            0         ['stack4_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack4_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack4_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_2  (None, 1, 1, 768)            0         ['add_446[0][0]']             
 7 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack4_block2_attn_reweigh  (None, 1, 1, 2304)           592320    ['global_average_pooling2d_27[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_40 (Reshape)        (None, 1, 1, 768, 3)         0         ['stack4_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack4_block2_attn_attenti  (None, 1, 1, 768, 3)         0         ['reshape_40[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_23 (TFOpLambda)  [(None, 1, 1, 768),          0         ['stack4_block2_attn_attention
                              (None, 1, 1, 768),                    _scores[0][0]']               
                              (None, 1, 1, 768)]                                                  
                                                                                                  
 multiply_165 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_23[0][0]']       
                                                                                                  
 multiply_166 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_23[0][1]']       
                                                                                                  
 multiply_167 (Multiply)     (None, 7, 7, 768)            0         ['stack4_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_23[0][2]']       
                                                                                                  
 add_447 (Add)               (None, 7, 7, 768)            0         ['multiply_165[0][0]',        
                                                                     'multiply_166[0][0]',        
                                                                     'multiply_167[0][0]']        
                                                                                                  
 stack4_block2_attn_out_ (C  (None, 7, 7, 768)            590592    ['add_447[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack4_block2_attn_drop_ (  (None, 7, 7, 768)            0         ['stack4_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack4_block2_attn_out (Ad  (None, 7, 7, 768)            0         ['stack4_block1_mlp_out[0][0]'
 d)                                                                 , 'stack4_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_47 (Gr  (None, 7, 7, 768)            1536      ['stack4_block2_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack4_block2_mlp_blocl_ (  (None, 7, 7, 768)            4722432   ['group_normalization_47[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack4_block2_mlp_drop_ (D  (None, 7, 7, 768)            0         ['stack4_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack4_block2_mlp_out (Add  (None, 7, 7, 768)            0         ['stack4_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack4_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_48 (Gr  (None, 7, 7, 768)            1536      ['stack4_block2_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 global_average_pooling2d_2  (None, 768)                  0         ['group_normalization_48[0][0]
 8 (GlobalAveragePooling2D)                                         ']                            
                                                                                                  
 dropout_14 (Dropout)        (None, 768)                  0         ['global_average_pooling2d_28[
                                                                    0][0]']                       
                                                                                                  
 predictions (Dense)         (None, 1000)                 769000    ['dropout_14[0][0]']          
                                                                                                  
 activation_201 (Activation  (None, 1000)                 0         ['predictions[0][0]']         
 )                                                                                                
                                                                                                  
==================================================================================================
Total params: 63622456 (242.70 MB)
Trainable params: 63586360 (242.56 MB)
Non-trainable params: 36096 (141.00 KB)
__________________________________________________________________________________________________
