Model: "WaveMLP-S"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input_101 (InputLayer)      [(None, 224, 224, 3)]        0         []                            
                                                                                                  
 stem_pad (ZeroPadding2D)    (None, 228, 228, 3)          0         ['input_101[0][0]']           
                                                                                                  
 stem_conv_ (Conv2D)         (None, 56, 56, 64)           9472      ['stem_pad[0][0]']            
                                                                                                  
 group_normalization_106 (G  (None, 56, 56, 64)           128       ['stem_conv_[0][0]']          
 roupNormalization)                                                                               
                                                                                                  
 group_normalization_107 (G  (None, 56, 56, 64)           128       ['group_normalization_106[0][0
 roupNormalization)                                                 ]']                           
                                                                                                  
 stack1_block1_attn_theta_h  (None, 56, 56, 64)           4160      ['group_normalization_107[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack1_block1_attn_theta_w  (None, 56, 56, 64)           4160      ['group_normalization_107[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_104 (B  (None, 56, 56, 64)           256       ['stack1_block1_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_105 (B  (None, 56, 56, 64)           256       ['stack1_block1_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_259 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_104[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_260 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_105[0][0
 )                                                                  ]']                           
                                                                                                  
 stack1_block1_attn_height_  (None, 56, 56, 64)           4096      ['group_normalization_107[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_104 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_259[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_104 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_259[0][0]']      
 a)                                                                                               
                                                                                                  
 stack1_block1_attn_width_   (None, 56, 56, 64)           4096      ['group_normalization_107[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_105 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_260[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_105 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_260[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_364 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_104[0][0]']     
                                                                                                  
 multiply_365 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_104[0][0]']     
                                                                                                  
 multiply_366 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_105[0][0]']     
                                                                                                  
 multiply_367 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_105[0][0]']     
                                                                                                  
 concatenate_715 (Concatena  (None, 56, 56, 128)          0         ['multiply_364[0][0]',        
 te)                                                                 'multiply_365[0][0]']        
                                                                                                  
 concatenate_716 (Concatena  (None, 56, 56, 128)          0         ['multiply_366[0][0]',        
 te)                                                                 'multiply_367[0][0]']        
                                                                                                  
 stack1_block1_attn_height_  (None, 56, 56, 64)           896       ['concatenate_715[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack1_block1_attn_width_d  (None, 56, 56, 64)           896       ['concatenate_716[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack1_block1_attn_channel  (None, 56, 56, 64)           4096      ['group_normalization_107[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_504 (Add)               (None, 56, 56, 64)           0         ['stack1_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack1_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack1_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_5  (None, 1, 1, 64)             0         ['add_504[0][0]']             
 8 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack1_block1_attn_reweigh  (None, 1, 1, 192)            4304      ['global_average_pooling2d_58[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_69 (Reshape)        (None, 1, 1, 64, 3)          0         ['stack1_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack1_block1_attn_attenti  (None, 1, 1, 64, 3)          0         ['reshape_69[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_52 (TFOpLambda)  [(None, 1, 1, 64),           0         ['stack1_block1_attn_attention
                              (None, 1, 1, 64),                     _scores[0][0]']               
                              (None, 1, 1, 64)]                                                   
                                                                                                  
 multiply_368 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_52[0][0]']       
                                                                                                  
 multiply_369 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_52[0][1]']       
                                                                                                  
 multiply_370 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_52[0][2]']       
                                                                                                  
 add_505 (Add)               (None, 56, 56, 64)           0         ['multiply_368[0][0]',        
                                                                     'multiply_369[0][0]',        
                                                                     'multiply_370[0][0]']        
                                                                                                  
 stack1_block1_attn_out_ (C  (None, 56, 56, 64)           4160      ['add_505[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack1_block1_attn_drop_ (  (None, 56, 56, 64)           0         ['stack1_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack1_block1_attn_out (Ad  (None, 56, 56, 64)           0         ['group_normalization_106[0][0
 d)                                                                 ]',                           
                                                                     'stack1_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_108 (G  (None, 56, 56, 64)           128       ['stack1_block1_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack1_block1_mlp_blocl_ (  (None, 56, 56, 64)           33088     ['group_normalization_108[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack1_block1_mlp_drop_ (D  (None, 56, 56, 64)           0         ['stack1_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack1_block1_mlp_out (Add  (None, 56, 56, 64)           0         ['stack1_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack1_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_109 (G  (None, 56, 56, 64)           128       ['stack1_block1_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack1_block2_attn_theta_h  (None, 56, 56, 64)           4160      ['group_normalization_109[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack1_block2_attn_theta_w  (None, 56, 56, 64)           4160      ['group_normalization_109[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_106 (B  (None, 56, 56, 64)           256       ['stack1_block2_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_107 (B  (None, 56, 56, 64)           256       ['stack1_block2_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_261 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_106[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_262 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_107[0][0
 )                                                                  ]']                           
                                                                                                  
 stack1_block2_attn_height_  (None, 56, 56, 64)           4096      ['group_normalization_109[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_106 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_261[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_106 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_261[0][0]']      
 a)                                                                                               
                                                                                                  
 stack1_block2_attn_width_   (None, 56, 56, 64)           4096      ['group_normalization_109[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_107 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_262[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_107 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_262[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_371 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_106[0][0]']     
                                                                                                  
 multiply_372 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_106[0][0]']     
                                                                                                  
 multiply_373 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_107[0][0]']     
                                                                                                  
 multiply_374 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_107[0][0]']     
                                                                                                  
 concatenate_717 (Concatena  (None, 56, 56, 128)          0         ['multiply_371[0][0]',        
 te)                                                                 'multiply_372[0][0]']        
                                                                                                  
 concatenate_718 (Concatena  (None, 56, 56, 128)          0         ['multiply_373[0][0]',        
 te)                                                                 'multiply_374[0][0]']        
                                                                                                  
 stack1_block2_attn_height_  (None, 56, 56, 64)           896       ['concatenate_717[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack1_block2_attn_width_d  (None, 56, 56, 64)           896       ['concatenate_718[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack1_block2_attn_channel  (None, 56, 56, 64)           4096      ['group_normalization_109[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_506 (Add)               (None, 56, 56, 64)           0         ['stack1_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack1_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack1_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_5  (None, 1, 1, 64)             0         ['add_506[0][0]']             
 9 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack1_block2_attn_reweigh  (None, 1, 1, 192)            4304      ['global_average_pooling2d_59[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_70 (Reshape)        (None, 1, 1, 64, 3)          0         ['stack1_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack1_block2_attn_attenti  (None, 1, 1, 64, 3)          0         ['reshape_70[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_53 (TFOpLambda)  [(None, 1, 1, 64),           0         ['stack1_block2_attn_attention
                              (None, 1, 1, 64),                     _scores[0][0]']               
                              (None, 1, 1, 64)]                                                   
                                                                                                  
 multiply_375 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_53[0][0]']       
                                                                                                  
 multiply_376 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_53[0][1]']       
                                                                                                  
 multiply_377 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_53[0][2]']       
                                                                                                  
 add_507 (Add)               (None, 56, 56, 64)           0         ['multiply_375[0][0]',        
                                                                     'multiply_376[0][0]',        
                                                                     'multiply_377[0][0]']        
                                                                                                  
 stack1_block2_attn_out_ (C  (None, 56, 56, 64)           4160      ['add_507[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack1_block2_attn_drop_ (  (None, 56, 56, 64)           0         ['stack1_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack1_block2_attn_out (Ad  (None, 56, 56, 64)           0         ['stack1_block1_mlp_out[0][0]'
 d)                                                                 , 'stack1_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_110 (G  (None, 56, 56, 64)           128       ['stack1_block2_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack1_block2_mlp_blocl_ (  (None, 56, 56, 64)           33088     ['group_normalization_110[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack1_block2_mlp_drop_ (D  (None, 56, 56, 64)           0         ['stack1_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack1_block2_mlp_out (Add  (None, 56, 56, 64)           0         ['stack1_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack1_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 stack2_down_sample_ (Conv2  (None, 28, 28, 128)          73856     ['stack1_block2_mlp_out[0][0]'
 D)                                                                 ]                             
                                                                                                  
 group_normalization_111 (G  (None, 28, 28, 128)          256       ['stack2_down_sample_[0][0]'] 
 roupNormalization)                                                                               
                                                                                                  
 group_normalization_112 (G  (None, 28, 28, 128)          256       ['group_normalization_111[0][0
 roupNormalization)                                                 ]']                           
                                                                                                  
 stack2_block1_attn_theta_h  (None, 28, 28, 128)          16512     ['group_normalization_112[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack2_block1_attn_theta_w  (None, 28, 28, 128)          16512     ['group_normalization_112[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_108 (B  (None, 28, 28, 128)          512       ['stack2_block1_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_109 (B  (None, 28, 28, 128)          512       ['stack2_block1_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_263 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_108[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_264 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_109[0][0
 )                                                                  ]']                           
                                                                                                  
 stack2_block1_attn_height_  (None, 28, 28, 128)          16384     ['group_normalization_112[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_108 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_263[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_108 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_263[0][0]']      
 a)                                                                                               
                                                                                                  
 stack2_block1_attn_width_   (None, 28, 28, 128)          16384     ['group_normalization_112[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_109 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_264[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_109 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_264[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_378 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_108[0][0]']     
                                                                                                  
 multiply_379 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_108[0][0]']     
                                                                                                  
 multiply_380 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_109[0][0]']     
                                                                                                  
 multiply_381 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_109[0][0]']     
                                                                                                  
 concatenate_719 (Concatena  (None, 28, 28, 256)          0         ['multiply_378[0][0]',        
 te)                                                                 'multiply_379[0][0]']        
                                                                                                  
 concatenate_720 (Concatena  (None, 28, 28, 256)          0         ['multiply_380[0][0]',        
 te)                                                                 'multiply_381[0][0]']        
                                                                                                  
 stack2_block1_attn_height_  (None, 28, 28, 128)          1792      ['concatenate_719[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block1_attn_width_d  (None, 28, 28, 128)          1792      ['concatenate_720[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block1_attn_channel  (None, 28, 28, 128)          16384     ['group_normalization_112[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_508 (Add)               (None, 28, 28, 128)          0         ['stack2_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 128)            0         ['add_508[0][0]']             
 0 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack2_block1_attn_reweigh  (None, 1, 1, 384)            16800     ['global_average_pooling2d_60[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_71 (Reshape)        (None, 1, 1, 128, 3)         0         ['stack2_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block1_attn_attenti  (None, 1, 1, 128, 3)         0         ['reshape_71[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_54 (TFOpLambda)  [(None, 1, 1, 128),          0         ['stack2_block1_attn_attention
                              (None, 1, 1, 128),                    _scores[0][0]']               
                              (None, 1, 1, 128)]                                                  
                                                                                                  
 multiply_382 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_54[0][0]']       
                                                                                                  
 multiply_383 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_54[0][1]']       
                                                                                                  
 multiply_384 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_54[0][2]']       
                                                                                                  
 add_509 (Add)               (None, 28, 28, 128)          0         ['multiply_382[0][0]',        
                                                                     'multiply_383[0][0]',        
                                                                     'multiply_384[0][0]']        
                                                                                                  
 stack2_block1_attn_out_ (C  (None, 28, 28, 128)          16512     ['add_509[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block1_attn_drop_ (  (None, 28, 28, 128)          0         ['stack2_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block1_attn_out (Ad  (None, 28, 28, 128)          0         ['group_normalization_111[0][0
 d)                                                                 ]',                           
                                                                     'stack2_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_113 (G  (None, 28, 28, 128)          256       ['stack2_block1_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack2_block1_mlp_blocl_ (  (None, 28, 28, 128)          131712    ['group_normalization_113[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack2_block1_mlp_drop_ (D  (None, 28, 28, 128)          0         ['stack2_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block1_mlp_out (Add  (None, 28, 28, 128)          0         ['stack2_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_114 (G  (None, 28, 28, 128)          256       ['stack2_block1_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack2_block2_attn_theta_h  (None, 28, 28, 128)          16512     ['group_normalization_114[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack2_block2_attn_theta_w  (None, 28, 28, 128)          16512     ['group_normalization_114[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_110 (B  (None, 28, 28, 128)          512       ['stack2_block2_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_111 (B  (None, 28, 28, 128)          512       ['stack2_block2_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_265 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_110[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_266 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_111[0][0
 )                                                                  ]']                           
                                                                                                  
 stack2_block2_attn_height_  (None, 28, 28, 128)          16384     ['group_normalization_114[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_110 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_265[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_110 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_265[0][0]']      
 a)                                                                                               
                                                                                                  
 stack2_block2_attn_width_   (None, 28, 28, 128)          16384     ['group_normalization_114[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_111 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_266[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_111 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_266[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_385 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_110[0][0]']     
                                                                                                  
 multiply_386 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_110[0][0]']     
                                                                                                  
 multiply_387 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_111[0][0]']     
                                                                                                  
 multiply_388 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_111[0][0]']     
                                                                                                  
 concatenate_721 (Concatena  (None, 28, 28, 256)          0         ['multiply_385[0][0]',        
 te)                                                                 'multiply_386[0][0]']        
                                                                                                  
 concatenate_722 (Concatena  (None, 28, 28, 256)          0         ['multiply_387[0][0]',        
 te)                                                                 'multiply_388[0][0]']        
                                                                                                  
 stack2_block2_attn_height_  (None, 28, 28, 128)          1792      ['concatenate_721[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block2_attn_width_d  (None, 28, 28, 128)          1792      ['concatenate_722[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block2_attn_channel  (None, 28, 28, 128)          16384     ['group_normalization_114[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_510 (Add)               (None, 28, 28, 128)          0         ['stack2_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 128)            0         ['add_510[0][0]']             
 1 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack2_block2_attn_reweigh  (None, 1, 1, 384)            16800     ['global_average_pooling2d_61[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_72 (Reshape)        (None, 1, 1, 128, 3)         0         ['stack2_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block2_attn_attenti  (None, 1, 1, 128, 3)         0         ['reshape_72[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_55 (TFOpLambda)  [(None, 1, 1, 128),          0         ['stack2_block2_attn_attention
                              (None, 1, 1, 128),                    _scores[0][0]']               
                              (None, 1, 1, 128)]                                                  
                                                                                                  
 multiply_389 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_55[0][0]']       
                                                                                                  
 multiply_390 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_55[0][1]']       
                                                                                                  
 multiply_391 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_55[0][2]']       
                                                                                                  
 add_511 (Add)               (None, 28, 28, 128)          0         ['multiply_389[0][0]',        
                                                                     'multiply_390[0][0]',        
                                                                     'multiply_391[0][0]']        
                                                                                                  
 stack2_block2_attn_out_ (C  (None, 28, 28, 128)          16512     ['add_511[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block2_attn_drop_ (  (None, 28, 28, 128)          0         ['stack2_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block2_attn_out (Ad  (None, 28, 28, 128)          0         ['stack2_block1_mlp_out[0][0]'
 d)                                                                 , 'stack2_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_115 (G  (None, 28, 28, 128)          256       ['stack2_block2_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack2_block2_mlp_blocl_ (  (None, 28, 28, 128)          131712    ['group_normalization_115[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack2_block2_mlp_drop_ (D  (None, 28, 28, 128)          0         ['stack2_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block2_mlp_out (Add  (None, 28, 28, 128)          0         ['stack2_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_116 (G  (None, 28, 28, 128)          256       ['stack2_block2_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack2_block3_attn_theta_h  (None, 28, 28, 128)          16512     ['group_normalization_116[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack2_block3_attn_theta_w  (None, 28, 28, 128)          16512     ['group_normalization_116[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_112 (B  (None, 28, 28, 128)          512       ['stack2_block3_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_113 (B  (None, 28, 28, 128)          512       ['stack2_block3_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_267 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_112[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_268 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_113[0][0
 )                                                                  ]']                           
                                                                                                  
 stack2_block3_attn_height_  (None, 28, 28, 128)          16384     ['group_normalization_116[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_112 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_267[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_112 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_267[0][0]']      
 a)                                                                                               
                                                                                                  
 stack2_block3_attn_width_   (None, 28, 28, 128)          16384     ['group_normalization_116[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_113 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_268[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_113 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_268[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_392 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_112[0][0]']     
                                                                                                  
 multiply_393 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_112[0][0]']     
                                                                                                  
 multiply_394 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_113[0][0]']     
                                                                                                  
 multiply_395 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_113[0][0]']     
                                                                                                  
 concatenate_723 (Concatena  (None, 28, 28, 256)          0         ['multiply_392[0][0]',        
 te)                                                                 'multiply_393[0][0]']        
                                                                                                  
 concatenate_724 (Concatena  (None, 28, 28, 256)          0         ['multiply_394[0][0]',        
 te)                                                                 'multiply_395[0][0]']        
                                                                                                  
 stack2_block3_attn_height_  (None, 28, 28, 128)          1792      ['concatenate_723[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block3_attn_width_d  (None, 28, 28, 128)          1792      ['concatenate_724[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block3_attn_channel  (None, 28, 28, 128)          16384     ['group_normalization_116[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_512 (Add)               (None, 28, 28, 128)          0         ['stack2_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block3_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 128)            0         ['add_512[0][0]']             
 2 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack2_block3_attn_reweigh  (None, 1, 1, 384)            16800     ['global_average_pooling2d_62[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_73 (Reshape)        (None, 1, 1, 128, 3)         0         ['stack2_block3_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block3_attn_attenti  (None, 1, 1, 128, 3)         0         ['reshape_73[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_56 (TFOpLambda)  [(None, 1, 1, 128),          0         ['stack2_block3_attn_attention
                              (None, 1, 1, 128),                    _scores[0][0]']               
                              (None, 1, 1, 128)]                                                  
                                                                                                  
 multiply_396 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_56[0][0]']       
                                                                                                  
 multiply_397 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_56[0][1]']       
                                                                                                  
 multiply_398 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_56[0][2]']       
                                                                                                  
 add_513 (Add)               (None, 28, 28, 128)          0         ['multiply_396[0][0]',        
                                                                     'multiply_397[0][0]',        
                                                                     'multiply_398[0][0]']        
                                                                                                  
 stack2_block3_attn_out_ (C  (None, 28, 28, 128)          16512     ['add_513[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block3_attn_drop_ (  (None, 28, 28, 128)          0         ['stack2_block3_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block3_attn_out (Ad  (None, 28, 28, 128)          0         ['stack2_block2_mlp_out[0][0]'
 d)                                                                 , 'stack2_block3_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_117 (G  (None, 28, 28, 128)          256       ['stack2_block3_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack2_block3_mlp_blocl_ (  (None, 28, 28, 128)          131712    ['group_normalization_117[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack2_block3_mlp_drop_ (D  (None, 28, 28, 128)          0         ['stack2_block3_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block3_mlp_out (Add  (None, 28, 28, 128)          0         ['stack2_block3_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block3_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 stack3_down_sample_ (Conv2  (None, 14, 14, 320)          368960    ['stack2_block3_mlp_out[0][0]'
 D)                                                                 ]                             
                                                                                                  
 group_normalization_118 (G  (None, 14, 14, 320)          640       ['stack3_down_sample_[0][0]'] 
 roupNormalization)                                                                               
                                                                                                  
 group_normalization_119 (G  (None, 14, 14, 320)          640       ['group_normalization_118[0][0
 roupNormalization)                                                 ]']                           
                                                                                                  
 stack3_block1_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_119[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block1_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_119[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_114 (B  (None, 14, 14, 320)          1280      ['stack3_block1_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_115 (B  (None, 14, 14, 320)          1280      ['stack3_block1_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_269 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_114[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_270 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_115[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block1_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_119[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_114 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_269[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_114 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_269[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block1_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_119[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_115 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_270[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_115 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_270[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_399 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_114[0][0]']     
                                                                                                  
 multiply_400 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_114[0][0]']     
                                                                                                  
 multiply_401 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_115[0][0]']     
                                                                                                  
 multiply_402 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_115[0][0]']     
                                                                                                  
 concatenate_725 (Concatena  (None, 14, 14, 640)          0         ['multiply_399[0][0]',        
 te)                                                                 'multiply_400[0][0]']        
                                                                                                  
 concatenate_726 (Concatena  (None, 14, 14, 640)          0         ['multiply_401[0][0]',        
 te)                                                                 'multiply_402[0][0]']        
                                                                                                  
 stack3_block1_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_725[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block1_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_726[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block1_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_119[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_514 (Add)               (None, 14, 14, 320)          0         ['stack3_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 320)            0         ['add_514[0][0]']             
 3 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block1_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_63[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_74 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block1_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_74[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_57 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block1_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_403 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_57[0][0]']       
                                                                                                  
 multiply_404 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_57[0][1]']       
                                                                                                  
 multiply_405 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_57[0][2]']       
                                                                                                  
 add_515 (Add)               (None, 14, 14, 320)          0         ['multiply_403[0][0]',        
                                                                     'multiply_404[0][0]',        
                                                                     'multiply_405[0][0]']        
                                                                                                  
 stack3_block1_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_515[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block1_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block1_attn_out (Ad  (None, 14, 14, 320)          0         ['group_normalization_118[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_120 (G  (None, 14, 14, 320)          640       ['stack3_block1_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack3_block1_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_120[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block1_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block1_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_121 (G  (None, 14, 14, 320)          640       ['stack3_block1_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack3_block2_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_121[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block2_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_121[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_116 (B  (None, 14, 14, 320)          1280      ['stack3_block2_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_117 (B  (None, 14, 14, 320)          1280      ['stack3_block2_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_271 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_116[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_272 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_117[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block2_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_121[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_116 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_271[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_116 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_271[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block2_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_121[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_117 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_272[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_117 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_272[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_406 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_116[0][0]']     
                                                                                                  
 multiply_407 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_116[0][0]']     
                                                                                                  
 multiply_408 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_117[0][0]']     
                                                                                                  
 multiply_409 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_117[0][0]']     
                                                                                                  
 concatenate_727 (Concatena  (None, 14, 14, 640)          0         ['multiply_406[0][0]',        
 te)                                                                 'multiply_407[0][0]']        
                                                                                                  
 concatenate_728 (Concatena  (None, 14, 14, 640)          0         ['multiply_408[0][0]',        
 te)                                                                 'multiply_409[0][0]']        
                                                                                                  
 stack3_block2_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_727[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block2_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_728[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block2_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_121[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_516 (Add)               (None, 14, 14, 320)          0         ['stack3_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 320)            0         ['add_516[0][0]']             
 4 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block2_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_64[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_75 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block2_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_75[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_58 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block2_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_410 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_58[0][0]']       
                                                                                                  
 multiply_411 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_58[0][1]']       
                                                                                                  
 multiply_412 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_58[0][2]']       
                                                                                                  
 add_517 (Add)               (None, 14, 14, 320)          0         ['multiply_410[0][0]',        
                                                                     'multiply_411[0][0]',        
                                                                     'multiply_412[0][0]']        
                                                                                                  
 stack3_block2_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_517[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block2_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block2_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block1_mlp_out[0][0]'
 d)                                                                 , 'stack3_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_122 (G  (None, 14, 14, 320)          640       ['stack3_block2_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack3_block2_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_122[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block2_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block2_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_123 (G  (None, 14, 14, 320)          640       ['stack3_block2_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack3_block3_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_123[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block3_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_123[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_118 (B  (None, 14, 14, 320)          1280      ['stack3_block3_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_119 (B  (None, 14, 14, 320)          1280      ['stack3_block3_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_273 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_118[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_274 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_119[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block3_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_123[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_118 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_273[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_118 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_273[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block3_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_123[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_119 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_274[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_119 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_274[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_413 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_118[0][0]']     
                                                                                                  
 multiply_414 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_118[0][0]']     
                                                                                                  
 multiply_415 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_119[0][0]']     
                                                                                                  
 multiply_416 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_119[0][0]']     
                                                                                                  
 concatenate_729 (Concatena  (None, 14, 14, 640)          0         ['multiply_413[0][0]',        
 te)                                                                 'multiply_414[0][0]']        
                                                                                                  
 concatenate_730 (Concatena  (None, 14, 14, 640)          0         ['multiply_415[0][0]',        
 te)                                                                 'multiply_416[0][0]']        
                                                                                                  
 stack3_block3_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_729[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block3_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_730[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block3_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_123[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_518 (Add)               (None, 14, 14, 320)          0         ['stack3_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block3_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 320)            0         ['add_518[0][0]']             
 5 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block3_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_65[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_76 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block3_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block3_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_76[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_59 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block3_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_417 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_59[0][0]']       
                                                                                                  
 multiply_418 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_59[0][1]']       
                                                                                                  
 multiply_419 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_59[0][2]']       
                                                                                                  
 add_519 (Add)               (None, 14, 14, 320)          0         ['multiply_417[0][0]',        
                                                                     'multiply_418[0][0]',        
                                                                     'multiply_419[0][0]']        
                                                                                                  
 stack3_block3_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_519[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block3_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block3_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block3_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block2_mlp_out[0][0]'
 d)                                                                 , 'stack3_block3_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_124 (G  (None, 14, 14, 320)          640       ['stack3_block3_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack3_block3_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_124[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block3_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block3_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block3_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block3_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block3_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_125 (G  (None, 14, 14, 320)          640       ['stack3_block3_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack3_block4_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_125[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block4_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_125[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_120 (B  (None, 14, 14, 320)          1280      ['stack3_block4_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_121 (B  (None, 14, 14, 320)          1280      ['stack3_block4_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_275 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_120[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_276 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_121[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block4_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_125[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_120 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_275[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_120 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_275[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block4_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_125[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_121 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_276[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_121 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_276[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_420 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_120[0][0]']     
                                                                                                  
 multiply_421 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_120[0][0]']     
                                                                                                  
 multiply_422 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_121[0][0]']     
                                                                                                  
 multiply_423 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_121[0][0]']     
                                                                                                  
 concatenate_731 (Concatena  (None, 14, 14, 640)          0         ['multiply_420[0][0]',        
 te)                                                                 'multiply_421[0][0]']        
                                                                                                  
 concatenate_732 (Concatena  (None, 14, 14, 640)          0         ['multiply_422[0][0]',        
 te)                                                                 'multiply_423[0][0]']        
                                                                                                  
 stack3_block4_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_731[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block4_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_732[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block4_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_125[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_520 (Add)               (None, 14, 14, 320)          0         ['stack3_block4_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block4_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block4_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 320)            0         ['add_520[0][0]']             
 6 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block4_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_66[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_77 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block4_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block4_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_77[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_60 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block4_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_424 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_60[0][0]']       
                                                                                                  
 multiply_425 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_60[0][1]']       
                                                                                                  
 multiply_426 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_60[0][2]']       
                                                                                                  
 add_521 (Add)               (None, 14, 14, 320)          0         ['multiply_424[0][0]',        
                                                                     'multiply_425[0][0]',        
                                                                     'multiply_426[0][0]']        
                                                                                                  
 stack3_block4_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_521[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block4_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block4_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block4_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block3_mlp_out[0][0]'
 d)                                                                 , 'stack3_block4_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_126 (G  (None, 14, 14, 320)          640       ['stack3_block4_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack3_block4_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_126[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block4_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block4_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block4_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block4_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block4_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_127 (G  (None, 14, 14, 320)          640       ['stack3_block4_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack3_block5_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_127[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block5_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_127[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_122 (B  (None, 14, 14, 320)          1280      ['stack3_block5_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_123 (B  (None, 14, 14, 320)          1280      ['stack3_block5_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_277 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_122[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_278 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_123[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block5_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_127[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_122 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_277[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_122 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_277[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block5_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_127[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_123 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_278[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_123 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_278[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_427 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_122[0][0]']     
                                                                                                  
 multiply_428 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_122[0][0]']     
                                                                                                  
 multiply_429 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_123[0][0]']     
                                                                                                  
 multiply_430 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_123[0][0]']     
                                                                                                  
 concatenate_733 (Concatena  (None, 14, 14, 640)          0         ['multiply_427[0][0]',        
 te)                                                                 'multiply_428[0][0]']        
                                                                                                  
 concatenate_734 (Concatena  (None, 14, 14, 640)          0         ['multiply_429[0][0]',        
 te)                                                                 'multiply_430[0][0]']        
                                                                                                  
 stack3_block5_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_733[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block5_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_734[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block5_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_127[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_522 (Add)               (None, 14, 14, 320)          0         ['stack3_block5_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block5_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block5_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 320)            0         ['add_522[0][0]']             
 7 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block5_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_67[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_78 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block5_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block5_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_78[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_61 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block5_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_431 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_61[0][0]']       
                                                                                                  
 multiply_432 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_61[0][1]']       
                                                                                                  
 multiply_433 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_61[0][2]']       
                                                                                                  
 add_523 (Add)               (None, 14, 14, 320)          0         ['multiply_431[0][0]',        
                                                                     'multiply_432[0][0]',        
                                                                     'multiply_433[0][0]']        
                                                                                                  
 stack3_block5_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_523[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block5_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block5_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block5_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block4_mlp_out[0][0]'
 d)                                                                 , 'stack3_block5_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_128 (G  (None, 14, 14, 320)          640       ['stack3_block5_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack3_block5_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_128[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block5_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block5_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block5_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block5_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block5_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_129 (G  (None, 14, 14, 320)          640       ['stack3_block5_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack3_block6_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_129[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block6_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_129[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_124 (B  (None, 14, 14, 320)          1280      ['stack3_block6_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_125 (B  (None, 14, 14, 320)          1280      ['stack3_block6_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_279 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_124[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_280 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_125[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block6_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_129[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_124 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_279[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_124 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_279[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block6_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_129[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_125 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_280[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_125 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_280[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_434 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_124[0][0]']     
                                                                                                  
 multiply_435 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_124[0][0]']     
                                                                                                  
 multiply_436 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_125[0][0]']     
                                                                                                  
 multiply_437 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_125[0][0]']     
                                                                                                  
 concatenate_735 (Concatena  (None, 14, 14, 640)          0         ['multiply_434[0][0]',        
 te)                                                                 'multiply_435[0][0]']        
                                                                                                  
 concatenate_736 (Concatena  (None, 14, 14, 640)          0         ['multiply_436[0][0]',        
 te)                                                                 'multiply_437[0][0]']        
                                                                                                  
 stack3_block6_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_735[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block6_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_736[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block6_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_129[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_524 (Add)               (None, 14, 14, 320)          0         ['stack3_block6_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block6_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block6_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 320)            0         ['add_524[0][0]']             
 8 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block6_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_68[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_79 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block6_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block6_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_79[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_62 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block6_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_438 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_62[0][0]']       
                                                                                                  
 multiply_439 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_62[0][1]']       
                                                                                                  
 multiply_440 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_62[0][2]']       
                                                                                                  
 add_525 (Add)               (None, 14, 14, 320)          0         ['multiply_438[0][0]',        
                                                                     'multiply_439[0][0]',        
                                                                     'multiply_440[0][0]']        
                                                                                                  
 stack3_block6_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_525[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block6_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block6_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block6_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block5_mlp_out[0][0]'
 d)                                                                 , 'stack3_block6_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_130 (G  (None, 14, 14, 320)          640       ['stack3_block6_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack3_block6_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_130[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block6_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block6_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block6_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block6_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block6_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_131 (G  (None, 14, 14, 320)          640       ['stack3_block6_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack3_block7_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_131[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block7_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_131[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_126 (B  (None, 14, 14, 320)          1280      ['stack3_block7_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_127 (B  (None, 14, 14, 320)          1280      ['stack3_block7_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_281 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_126[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_282 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_127[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block7_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_131[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_126 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_281[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_126 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_281[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block7_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_131[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_127 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_282[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_127 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_282[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_441 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_126[0][0]']     
                                                                                                  
 multiply_442 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_126[0][0]']     
                                                                                                  
 multiply_443 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_127[0][0]']     
                                                                                                  
 multiply_444 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_127[0][0]']     
                                                                                                  
 concatenate_737 (Concatena  (None, 14, 14, 640)          0         ['multiply_441[0][0]',        
 te)                                                                 'multiply_442[0][0]']        
                                                                                                  
 concatenate_738 (Concatena  (None, 14, 14, 640)          0         ['multiply_443[0][0]',        
 te)                                                                 'multiply_444[0][0]']        
                                                                                                  
 stack3_block7_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_737[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block7_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_738[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block7_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_131[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_526 (Add)               (None, 14, 14, 320)          0         ['stack3_block7_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block7_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block7_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_6  (None, 1, 1, 320)            0         ['add_526[0][0]']             
 9 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block7_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_69[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_80 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block7_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block7_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_80[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_63 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block7_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_445 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_63[0][0]']       
                                                                                                  
 multiply_446 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_63[0][1]']       
                                                                                                  
 multiply_447 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_63[0][2]']       
                                                                                                  
 add_527 (Add)               (None, 14, 14, 320)          0         ['multiply_445[0][0]',        
                                                                     'multiply_446[0][0]',        
                                                                     'multiply_447[0][0]']        
                                                                                                  
 stack3_block7_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_527[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block7_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block7_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block7_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block6_mlp_out[0][0]'
 d)                                                                 , 'stack3_block7_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_132 (G  (None, 14, 14, 320)          640       ['stack3_block7_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack3_block7_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_132[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block7_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block7_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block7_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block7_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block7_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_133 (G  (None, 14, 14, 320)          640       ['stack3_block7_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack3_block8_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_133[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block8_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_133[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_128 (B  (None, 14, 14, 320)          1280      ['stack3_block8_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_129 (B  (None, 14, 14, 320)          1280      ['stack3_block8_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_283 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_128[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_284 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_129[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block8_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_133[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_128 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_283[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_128 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_283[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block8_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_133[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_129 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_284[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_129 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_284[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_448 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_128[0][0]']     
                                                                                                  
 multiply_449 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_128[0][0]']     
                                                                                                  
 multiply_450 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_129[0][0]']     
                                                                                                  
 multiply_451 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_129[0][0]']     
                                                                                                  
 concatenate_739 (Concatena  (None, 14, 14, 640)          0         ['multiply_448[0][0]',        
 te)                                                                 'multiply_449[0][0]']        
                                                                                                  
 concatenate_740 (Concatena  (None, 14, 14, 640)          0         ['multiply_450[0][0]',        
 te)                                                                 'multiply_451[0][0]']        
                                                                                                  
 stack3_block8_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_739[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block8_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_740[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block8_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_133[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_528 (Add)               (None, 14, 14, 320)          0         ['stack3_block8_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block8_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block8_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_7  (None, 1, 1, 320)            0         ['add_528[0][0]']             
 0 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block8_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_70[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_81 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block8_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block8_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_81[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_64 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block8_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_452 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_64[0][0]']       
                                                                                                  
 multiply_453 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_64[0][1]']       
                                                                                                  
 multiply_454 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_64[0][2]']       
                                                                                                  
 add_529 (Add)               (None, 14, 14, 320)          0         ['multiply_452[0][0]',        
                                                                     'multiply_453[0][0]',        
                                                                     'multiply_454[0][0]']        
                                                                                                  
 stack3_block8_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_529[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block8_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block8_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block8_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block7_mlp_out[0][0]'
 d)                                                                 , 'stack3_block8_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_134 (G  (None, 14, 14, 320)          640       ['stack3_block8_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack3_block8_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_134[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block8_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block8_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block8_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block8_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block8_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_135 (G  (None, 14, 14, 320)          640       ['stack3_block8_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack3_block9_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_135[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block9_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_135[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_130 (B  (None, 14, 14, 320)          1280      ['stack3_block9_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_131 (B  (None, 14, 14, 320)          1280      ['stack3_block9_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_285 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_130[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_286 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_131[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block9_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_135[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_130 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_285[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_130 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_285[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block9_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_135[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_131 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_286[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_131 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_286[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_455 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_130[0][0]']     
                                                                                                  
 multiply_456 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_130[0][0]']     
                                                                                                  
 multiply_457 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_131[0][0]']     
                                                                                                  
 multiply_458 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_131[0][0]']     
                                                                                                  
 concatenate_741 (Concatena  (None, 14, 14, 640)          0         ['multiply_455[0][0]',        
 te)                                                                 'multiply_456[0][0]']        
                                                                                                  
 concatenate_742 (Concatena  (None, 14, 14, 640)          0         ['multiply_457[0][0]',        
 te)                                                                 'multiply_458[0][0]']        
                                                                                                  
 stack3_block9_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_741[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block9_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_742[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block9_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_135[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_530 (Add)               (None, 14, 14, 320)          0         ['stack3_block9_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block9_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block9_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_7  (None, 1, 1, 320)            0         ['add_530[0][0]']             
 1 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block9_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_71[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_82 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block9_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block9_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_82[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_65 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block9_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_459 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_65[0][0]']       
                                                                                                  
 multiply_460 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_65[0][1]']       
                                                                                                  
 multiply_461 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_65[0][2]']       
                                                                                                  
 add_531 (Add)               (None, 14, 14, 320)          0         ['multiply_459[0][0]',        
                                                                     'multiply_460[0][0]',        
                                                                     'multiply_461[0][0]']        
                                                                                                  
 stack3_block9_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_531[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block9_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block9_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block9_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block8_mlp_out[0][0]'
 d)                                                                 , 'stack3_block9_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_136 (G  (None, 14, 14, 320)          640       ['stack3_block9_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack3_block9_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_136[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block9_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block9_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block9_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block9_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block9_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_137 (G  (None, 14, 14, 320)          640       ['stack3_block9_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack3_block10_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_137[0][0
 h_ (Conv2D)                                                        ]']                           
                                                                                                  
 stack3_block10_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_137[0][0
 w_ (Conv2D)                                                        ]']                           
                                                                                                  
 batch_normalization_132 (B  (None, 14, 14, 320)          1280      ['stack3_block10_attn_theta_h_
 atchNormalization)                                                 [0][0]']                      
                                                                                                  
 batch_normalization_133 (B  (None, 14, 14, 320)          1280      ['stack3_block10_attn_theta_w_
 atchNormalization)                                                 [0][0]']                      
                                                                                                  
 activation_287 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_132[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_288 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_133[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block10_attn_height  (None, 14, 14, 320)          102400    ['group_normalization_137[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 tf.math.cos_132 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_287[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_132 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_287[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block10_attn_width_  (None, 14, 14, 320)          102400    ['group_normalization_137[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_133 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_288[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_133 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_288[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_462 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_132[0][0]']     
                                                                                                  
 multiply_463 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_132[0][0]']     
                                                                                                  
 multiply_464 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_133[0][0]']     
                                                                                                  
 multiply_465 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_133[0][0]']     
                                                                                                  
 concatenate_743 (Concatena  (None, 14, 14, 640)          0         ['multiply_462[0][0]',        
 te)                                                                 'multiply_463[0][0]']        
                                                                                                  
 concatenate_744 (Concatena  (None, 14, 14, 640)          0         ['multiply_464[0][0]',        
 te)                                                                 'multiply_465[0][0]']        
                                                                                                  
 stack3_block10_attn_height  (None, 14, 14, 320)          4480      ['concatenate_743[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block10_attn_width_  (None, 14, 14, 320)          4480      ['concatenate_744[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block10_attn_channe  (None, 14, 14, 320)          102400    ['group_normalization_137[0][0
 l_ (Conv2D)                                                        ]']                           
                                                                                                  
 add_532 (Add)               (None, 14, 14, 320)          0         ['stack3_block10_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block10_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block10_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_7  (None, 1, 1, 320)            0         ['add_532[0][0]']             
 2 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block10_attn_reweig  (None, 1, 1, 960)            103440    ['global_average_pooling2d_72[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_83 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block10_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block10_attn_attent  (None, 1, 1, 320, 3)         0         ['reshape_83[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_66 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block10_attn_attentio
                              (None, 1, 1, 320),                    n_scores[0][0]']              
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_466 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_66[0][0]']       
                                                                                                  
 multiply_467 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_66[0][1]']       
                                                                                                  
 multiply_468 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_66[0][2]']       
                                                                                                  
 add_533 (Add)               (None, 14, 14, 320)          0         ['multiply_466[0][0]',        
                                                                     'multiply_467[0][0]',        
                                                                     'multiply_468[0][0]']        
                                                                                                  
 stack3_block10_attn_out_ (  (None, 14, 14, 320)          102720    ['add_533[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block10_attn_drop_   (None, 14, 14, 320)          0         ['stack3_block10_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block10_attn_out (A  (None, 14, 14, 320)          0         ['stack3_block9_mlp_out[0][0]'
 dd)                                                                , 'stack3_block10_attn_drop_[0
                                                                    ][0]']                        
                                                                                                  
 group_normalization_138 (G  (None, 14, 14, 320)          640       ['stack3_block10_attn_out[0][0
 roupNormalization)                                                 ]']                           
                                                                                                  
 stack3_block10_mlp_blocl_   (None, 14, 14, 320)          820800    ['group_normalization_138[0][0
 (MLPBlock)                                                         ]']                           
                                                                                                  
 stack3_block10_mlp_drop_ (  (None, 14, 14, 320)          0         ['stack3_block10_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block10_mlp_out (Ad  (None, 14, 14, 320)          0         ['stack3_block10_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block10_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 stack4_down_sample_ (Conv2  (None, 7, 7, 512)            1475072   ['stack3_block10_mlp_out[0][0]
 D)                                                                 ']                            
                                                                                                  
 group_normalization_139 (G  (None, 7, 7, 512)            1024      ['stack4_down_sample_[0][0]'] 
 roupNormalization)                                                                               
                                                                                                  
 group_normalization_140 (G  (None, 7, 7, 512)            1024      ['group_normalization_139[0][0
 roupNormalization)                                                 ]']                           
                                                                                                  
 stack4_block1_attn_theta_h  (None, 7, 7, 512)            262656    ['group_normalization_140[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack4_block1_attn_theta_w  (None, 7, 7, 512)            262656    ['group_normalization_140[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_134 (B  (None, 7, 7, 512)            2048      ['stack4_block1_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_135 (B  (None, 7, 7, 512)            2048      ['stack4_block1_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_289 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_134[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_290 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_135[0][0
 )                                                                  ]']                           
                                                                                                  
 stack4_block1_attn_height_  (None, 7, 7, 512)            262144    ['group_normalization_140[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_134 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_289[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_134 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_289[0][0]']      
 a)                                                                                               
                                                                                                  
 stack4_block1_attn_width_   (None, 7, 7, 512)            262144    ['group_normalization_140[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_135 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_290[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_135 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_290[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_469 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_134[0][0]']     
                                                                                                  
 multiply_470 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_134[0][0]']     
                                                                                                  
 multiply_471 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_135[0][0]']     
                                                                                                  
 multiply_472 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_135[0][0]']     
                                                                                                  
 concatenate_745 (Concatena  (None, 7, 7, 1024)           0         ['multiply_469[0][0]',        
 te)                                                                 'multiply_470[0][0]']        
                                                                                                  
 concatenate_746 (Concatena  (None, 7, 7, 1024)           0         ['multiply_471[0][0]',        
 te)                                                                 'multiply_472[0][0]']        
                                                                                                  
 stack4_block1_attn_height_  (None, 7, 7, 512)            7168      ['concatenate_745[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack4_block1_attn_width_d  (None, 7, 7, 512)            7168      ['concatenate_746[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack4_block1_attn_channel  (None, 7, 7, 512)            262144    ['group_normalization_140[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_534 (Add)               (None, 7, 7, 512)            0         ['stack4_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack4_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack4_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_7  (None, 1, 1, 512)            0         ['add_534[0][0]']             
 3 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack4_block1_attn_reweigh  (None, 1, 1, 1536)           263808    ['global_average_pooling2d_73[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_84 (Reshape)        (None, 1, 1, 512, 3)         0         ['stack4_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack4_block1_attn_attenti  (None, 1, 1, 512, 3)         0         ['reshape_84[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_67 (TFOpLambda)  [(None, 1, 1, 512),          0         ['stack4_block1_attn_attention
                              (None, 1, 1, 512),                    _scores[0][0]']               
                              (None, 1, 1, 512)]                                                  
                                                                                                  
 multiply_473 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_67[0][0]']       
                                                                                                  
 multiply_474 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_67[0][1]']       
                                                                                                  
 multiply_475 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_67[0][2]']       
                                                                                                  
 add_535 (Add)               (None, 7, 7, 512)            0         ['multiply_473[0][0]',        
                                                                     'multiply_474[0][0]',        
                                                                     'multiply_475[0][0]']        
                                                                                                  
 stack4_block1_attn_out_ (C  (None, 7, 7, 512)            262656    ['add_535[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack4_block1_attn_drop_ (  (None, 7, 7, 512)            0         ['stack4_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack4_block1_attn_out (Ad  (None, 7, 7, 512)            0         ['group_normalization_139[0][0
 d)                                                                 ]',                           
                                                                     'stack4_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_141 (G  (None, 7, 7, 512)            1024      ['stack4_block1_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack4_block1_mlp_blocl_ (  (None, 7, 7, 512)            2099712   ['group_normalization_141[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack4_block1_mlp_drop_ (D  (None, 7, 7, 512)            0         ['stack4_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack4_block1_mlp_out (Add  (None, 7, 7, 512)            0         ['stack4_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack4_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_142 (G  (None, 7, 7, 512)            1024      ['stack4_block1_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack4_block2_attn_theta_h  (None, 7, 7, 512)            262656    ['group_normalization_142[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack4_block2_attn_theta_w  (None, 7, 7, 512)            262656    ['group_normalization_142[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_136 (B  (None, 7, 7, 512)            2048      ['stack4_block2_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_137 (B  (None, 7, 7, 512)            2048      ['stack4_block2_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_291 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_136[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_292 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_137[0][0
 )                                                                  ]']                           
                                                                                                  
 stack4_block2_attn_height_  (None, 7, 7, 512)            262144    ['group_normalization_142[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_136 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_291[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_136 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_291[0][0]']      
 a)                                                                                               
                                                                                                  
 stack4_block2_attn_width_   (None, 7, 7, 512)            262144    ['group_normalization_142[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_137 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_292[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_137 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_292[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_476 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_136[0][0]']     
                                                                                                  
 multiply_477 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_136[0][0]']     
                                                                                                  
 multiply_478 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_137[0][0]']     
                                                                                                  
 multiply_479 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_137[0][0]']     
                                                                                                  
 concatenate_747 (Concatena  (None, 7, 7, 1024)           0         ['multiply_476[0][0]',        
 te)                                                                 'multiply_477[0][0]']        
                                                                                                  
 concatenate_748 (Concatena  (None, 7, 7, 1024)           0         ['multiply_478[0][0]',        
 te)                                                                 'multiply_479[0][0]']        
                                                                                                  
 stack4_block2_attn_height_  (None, 7, 7, 512)            7168      ['concatenate_747[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack4_block2_attn_width_d  (None, 7, 7, 512)            7168      ['concatenate_748[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack4_block2_attn_channel  (None, 7, 7, 512)            262144    ['group_normalization_142[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_536 (Add)               (None, 7, 7, 512)            0         ['stack4_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack4_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack4_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_7  (None, 1, 1, 512)            0         ['add_536[0][0]']             
 4 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack4_block2_attn_reweigh  (None, 1, 1, 1536)           263808    ['global_average_pooling2d_74[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_85 (Reshape)        (None, 1, 1, 512, 3)         0         ['stack4_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack4_block2_attn_attenti  (None, 1, 1, 512, 3)         0         ['reshape_85[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_68 (TFOpLambda)  [(None, 1, 1, 512),          0         ['stack4_block2_attn_attention
                              (None, 1, 1, 512),                    _scores[0][0]']               
                              (None, 1, 1, 512)]                                                  
                                                                                                  
 multiply_480 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_68[0][0]']       
                                                                                                  
 multiply_481 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_68[0][1]']       
                                                                                                  
 multiply_482 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_68[0][2]']       
                                                                                                  
 add_537 (Add)               (None, 7, 7, 512)            0         ['multiply_480[0][0]',        
                                                                     'multiply_481[0][0]',        
                                                                     'multiply_482[0][0]']        
                                                                                                  
 stack4_block2_attn_out_ (C  (None, 7, 7, 512)            262656    ['add_537[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack4_block2_attn_drop_ (  (None, 7, 7, 512)            0         ['stack4_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack4_block2_attn_out (Ad  (None, 7, 7, 512)            0         ['stack4_block1_mlp_out[0][0]'
 d)                                                                 , 'stack4_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_143 (G  (None, 7, 7, 512)            1024      ['stack4_block2_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack4_block2_mlp_blocl_ (  (None, 7, 7, 512)            2099712   ['group_normalization_143[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack4_block2_mlp_drop_ (D  (None, 7, 7, 512)            0         ['stack4_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack4_block2_mlp_out (Add  (None, 7, 7, 512)            0         ['stack4_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack4_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_144 (G  (None, 7, 7, 512)            1024      ['stack4_block2_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack4_block3_attn_theta_h  (None, 7, 7, 512)            262656    ['group_normalization_144[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack4_block3_attn_theta_w  (None, 7, 7, 512)            262656    ['group_normalization_144[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_138 (B  (None, 7, 7, 512)            2048      ['stack4_block3_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_139 (B  (None, 7, 7, 512)            2048      ['stack4_block3_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_293 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_138[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_294 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_139[0][0
 )                                                                  ]']                           
                                                                                                  
 stack4_block3_attn_height_  (None, 7, 7, 512)            262144    ['group_normalization_144[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_138 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_293[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_138 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_293[0][0]']      
 a)                                                                                               
                                                                                                  
 stack4_block3_attn_width_   (None, 7, 7, 512)            262144    ['group_normalization_144[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_139 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_294[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_139 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_294[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_483 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_138[0][0]']     
                                                                                                  
 multiply_484 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_138[0][0]']     
                                                                                                  
 multiply_485 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_139[0][0]']     
                                                                                                  
 multiply_486 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_139[0][0]']     
                                                                                                  
 concatenate_749 (Concatena  (None, 7, 7, 1024)           0         ['multiply_483[0][0]',        
 te)                                                                 'multiply_484[0][0]']        
                                                                                                  
 concatenate_750 (Concatena  (None, 7, 7, 1024)           0         ['multiply_485[0][0]',        
 te)                                                                 'multiply_486[0][0]']        
                                                                                                  
 stack4_block3_attn_height_  (None, 7, 7, 512)            7168      ['concatenate_749[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack4_block3_attn_width_d  (None, 7, 7, 512)            7168      ['concatenate_750[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack4_block3_attn_channel  (None, 7, 7, 512)            262144    ['group_normalization_144[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_538 (Add)               (None, 7, 7, 512)            0         ['stack4_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack4_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack4_block3_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_7  (None, 1, 1, 512)            0         ['add_538[0][0]']             
 5 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack4_block3_attn_reweigh  (None, 1, 1, 1536)           263808    ['global_average_pooling2d_75[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_86 (Reshape)        (None, 1, 1, 512, 3)         0         ['stack4_block3_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack4_block3_attn_attenti  (None, 1, 1, 512, 3)         0         ['reshape_86[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_69 (TFOpLambda)  [(None, 1, 1, 512),          0         ['stack4_block3_attn_attention
                              (None, 1, 1, 512),                    _scores[0][0]']               
                              (None, 1, 1, 512)]                                                  
                                                                                                  
 multiply_487 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_69[0][0]']       
                                                                                                  
 multiply_488 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_69[0][1]']       
                                                                                                  
 multiply_489 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_69[0][2]']       
                                                                                                  
 add_539 (Add)               (None, 7, 7, 512)            0         ['multiply_487[0][0]',        
                                                                     'multiply_488[0][0]',        
                                                                     'multiply_489[0][0]']        
                                                                                                  
 stack4_block3_attn_out_ (C  (None, 7, 7, 512)            262656    ['add_539[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack4_block3_attn_drop_ (  (None, 7, 7, 512)            0         ['stack4_block3_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack4_block3_attn_out (Ad  (None, 7, 7, 512)            0         ['stack4_block2_mlp_out[0][0]'
 d)                                                                 , 'stack4_block3_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_145 (G  (None, 7, 7, 512)            1024      ['stack4_block3_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack4_block3_mlp_blocl_ (  (None, 7, 7, 512)            2099712   ['group_normalization_145[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack4_block3_mlp_drop_ (D  (None, 7, 7, 512)            0         ['stack4_block3_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack4_block3_mlp_out (Add  (None, 7, 7, 512)            0         ['stack4_block3_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack4_block3_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_146 (G  (None, 7, 7, 512)            1024      ['stack4_block3_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 global_average_pooling2d_7  (None, 512)                  0         ['group_normalization_146[0][0
 6 (GlobalAveragePooling2D)                                         ]']                           
                                                                                                  
 dropout_16 (Dropout)        (None, 512)                  0         ['global_average_pooling2d_76[
                                                                    0][0]']                       
                                                                                                  
 predictions (Dense)         (None, 1000)                 513000    ['dropout_16[0][0]']          
                                                                                                  
 activation_295 (Activation  (None, 1000)                 0         ['predictions[0][0]']         
 )                                                                                                
                                                                                                  
==================================================================================================
Total params: 30729032 (117.22 MB)
Trainable params: 30708040 (117.14 MB)
Non-trainable params: 20992 (82.00 KB)
__________________________________________________________________________________________________
