Model: "WaveMLP-T"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input_102 (InputLayer)      [(None, 224, 224, 3)]        0         []                            
                                                                                                  
 stem_pad (ZeroPadding2D)    (None, 228, 228, 3)          0         ['input_102[0][0]']           
                                                                                                  
 stem_conv_ (Conv2D)         (None, 56, 56, 64)           9472      ['stem_pad[0][0]']            
                                                                                                  
 batch_normalization_140 (B  (None, 56, 56, 64)           256       ['stem_conv_[0][0]']          
 atchNormalization)                                                                               
                                                                                                  
 batch_normalization_141 (B  (None, 56, 56, 64)           256       ['batch_normalization_140[0][0
 atchNormalization)                                                 ]']                           
                                                                                                  
 stack1_block1_attn_theta_h  (None, 56, 56, 64)           4160      ['batch_normalization_141[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack1_block1_attn_theta_w  (None, 56, 56, 64)           4160      ['batch_normalization_141[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_142 (B  (None, 56, 56, 64)           256       ['stack1_block1_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_143 (B  (None, 56, 56, 64)           256       ['stack1_block1_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_296 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_142[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_297 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_143[0][0
 )                                                                  ]']                           
                                                                                                  
 stack1_block1_attn_height_  (None, 56, 56, 64)           4096      ['batch_normalization_141[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_140 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_296[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_140 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_296[0][0]']      
 a)                                                                                               
                                                                                                  
 stack1_block1_attn_width_   (None, 56, 56, 64)           4096      ['batch_normalization_141[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_141 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_297[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_141 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_297[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_490 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_140[0][0]']     
                                                                                                  
 multiply_491 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_140[0][0]']     
                                                                                                  
 multiply_492 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_141[0][0]']     
                                                                                                  
 multiply_493 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_141[0][0]']     
                                                                                                  
 concatenate_751 (Concatena  (None, 56, 56, 128)          0         ['multiply_490[0][0]',        
 te)                                                                 'multiply_491[0][0]']        
                                                                                                  
 concatenate_752 (Concatena  (None, 56, 56, 128)          0         ['multiply_492[0][0]',        
 te)                                                                 'multiply_493[0][0]']        
                                                                                                  
 stack1_block1_attn_height_  (None, 56, 56, 64)           896       ['concatenate_751[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack1_block1_attn_width_d  (None, 56, 56, 64)           896       ['concatenate_752[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack1_block1_attn_channel  (None, 56, 56, 64)           4096      ['batch_normalization_141[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_540 (Add)               (None, 56, 56, 64)           0         ['stack1_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack1_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack1_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_7  (None, 1, 1, 64)             0         ['add_540[0][0]']             
 7 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack1_block1_attn_reweigh  (None, 1, 1, 192)            4304      ['global_average_pooling2d_77[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_87 (Reshape)        (None, 1, 1, 64, 3)          0         ['stack1_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack1_block1_attn_attenti  (None, 1, 1, 64, 3)          0         ['reshape_87[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_70 (TFOpLambda)  [(None, 1, 1, 64),           0         ['stack1_block1_attn_attention
                              (None, 1, 1, 64),                     _scores[0][0]']               
                              (None, 1, 1, 64)]                                                   
                                                                                                  
 multiply_494 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_70[0][0]']       
                                                                                                  
 multiply_495 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_70[0][1]']       
                                                                                                  
 multiply_496 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_70[0][2]']       
                                                                                                  
 add_541 (Add)               (None, 56, 56, 64)           0         ['multiply_494[0][0]',        
                                                                     'multiply_495[0][0]',        
                                                                     'multiply_496[0][0]']        
                                                                                                  
 stack1_block1_attn_out_ (C  (None, 56, 56, 64)           4160      ['add_541[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack1_block1_attn_drop_ (  (None, 56, 56, 64)           0         ['stack1_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack1_block1_attn_out (Ad  (None, 56, 56, 64)           0         ['batch_normalization_140[0][0
 d)                                                                 ]',                           
                                                                     'stack1_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 batch_normalization_144 (B  (None, 56, 56, 64)           256       ['stack1_block1_attn_out[0][0]
 atchNormalization)                                                 ']                            
                                                                                                  
 stack1_block1_mlp_blocl_ (  (None, 56, 56, 64)           33088     ['batch_normalization_144[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack1_block1_mlp_drop_ (D  (None, 56, 56, 64)           0         ['stack1_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack1_block1_mlp_out (Add  (None, 56, 56, 64)           0         ['stack1_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack1_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 batch_normalization_145 (B  (None, 56, 56, 64)           256       ['stack1_block1_mlp_out[0][0]'
 atchNormalization)                                                 ]                             
                                                                                                  
 stack1_block2_attn_theta_h  (None, 56, 56, 64)           4160      ['batch_normalization_145[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack1_block2_attn_theta_w  (None, 56, 56, 64)           4160      ['batch_normalization_145[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_146 (B  (None, 56, 56, 64)           256       ['stack1_block2_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_147 (B  (None, 56, 56, 64)           256       ['stack1_block2_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_298 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_146[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_299 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_147[0][0
 )                                                                  ]']                           
                                                                                                  
 stack1_block2_attn_height_  (None, 56, 56, 64)           4096      ['batch_normalization_145[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_142 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_298[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_142 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_298[0][0]']      
 a)                                                                                               
                                                                                                  
 stack1_block2_attn_width_   (None, 56, 56, 64)           4096      ['batch_normalization_145[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_143 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_299[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_143 (TFOpLambd  (None, 56, 56, 64)           0         ['activation_299[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_497 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_142[0][0]']     
                                                                                                  
 multiply_498 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_142[0][0]']     
                                                                                                  
 multiply_499 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_143[0][0]']     
                                                                                                  
 multiply_500 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_143[0][0]']     
                                                                                                  
 concatenate_753 (Concatena  (None, 56, 56, 128)          0         ['multiply_497[0][0]',        
 te)                                                                 'multiply_498[0][0]']        
                                                                                                  
 concatenate_754 (Concatena  (None, 56, 56, 128)          0         ['multiply_499[0][0]',        
 te)                                                                 'multiply_500[0][0]']        
                                                                                                  
 stack1_block2_attn_height_  (None, 56, 56, 64)           896       ['concatenate_753[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack1_block2_attn_width_d  (None, 56, 56, 64)           896       ['concatenate_754[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack1_block2_attn_channel  (None, 56, 56, 64)           4096      ['batch_normalization_145[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_542 (Add)               (None, 56, 56, 64)           0         ['stack1_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack1_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack1_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_7  (None, 1, 1, 64)             0         ['add_542[0][0]']             
 8 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack1_block2_attn_reweigh  (None, 1, 1, 192)            4304      ['global_average_pooling2d_78[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_88 (Reshape)        (None, 1, 1, 64, 3)          0         ['stack1_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack1_block2_attn_attenti  (None, 1, 1, 64, 3)          0         ['reshape_88[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_71 (TFOpLambda)  [(None, 1, 1, 64),           0         ['stack1_block2_attn_attention
                              (None, 1, 1, 64),                     _scores[0][0]']               
                              (None, 1, 1, 64)]                                                   
                                                                                                  
 multiply_501 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_71[0][0]']       
                                                                                                  
 multiply_502 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_71[0][1]']       
                                                                                                  
 multiply_503 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_71[0][2]']       
                                                                                                  
 add_543 (Add)               (None, 56, 56, 64)           0         ['multiply_501[0][0]',        
                                                                     'multiply_502[0][0]',        
                                                                     'multiply_503[0][0]']        
                                                                                                  
 stack1_block2_attn_out_ (C  (None, 56, 56, 64)           4160      ['add_543[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack1_block2_attn_drop_ (  (None, 56, 56, 64)           0         ['stack1_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack1_block2_attn_out (Ad  (None, 56, 56, 64)           0         ['stack1_block1_mlp_out[0][0]'
 d)                                                                 , 'stack1_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 batch_normalization_148 (B  (None, 56, 56, 64)           256       ['stack1_block2_attn_out[0][0]
 atchNormalization)                                                 ']                            
                                                                                                  
 stack1_block2_mlp_blocl_ (  (None, 56, 56, 64)           33088     ['batch_normalization_148[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack1_block2_mlp_drop_ (D  (None, 56, 56, 64)           0         ['stack1_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack1_block2_mlp_out (Add  (None, 56, 56, 64)           0         ['stack1_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack1_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 stack2_down_sample_ (Conv2  (None, 28, 28, 128)          73856     ['stack1_block2_mlp_out[0][0]'
 D)                                                                 ]                             
                                                                                                  
 batch_normalization_149 (B  (None, 28, 28, 128)          512       ['stack2_down_sample_[0][0]'] 
 atchNormalization)                                                                               
                                                                                                  
 batch_normalization_150 (B  (None, 28, 28, 128)          512       ['batch_normalization_149[0][0
 atchNormalization)                                                 ]']                           
                                                                                                  
 stack2_block1_attn_theta_h  (None, 28, 28, 128)          16512     ['batch_normalization_150[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack2_block1_attn_theta_w  (None, 28, 28, 128)          16512     ['batch_normalization_150[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_151 (B  (None, 28, 28, 128)          512       ['stack2_block1_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_152 (B  (None, 28, 28, 128)          512       ['stack2_block1_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_300 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_151[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_301 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_152[0][0
 )                                                                  ]']                           
                                                                                                  
 stack2_block1_attn_height_  (None, 28, 28, 128)          16384     ['batch_normalization_150[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_144 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_300[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_144 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_300[0][0]']      
 a)                                                                                               
                                                                                                  
 stack2_block1_attn_width_   (None, 28, 28, 128)          16384     ['batch_normalization_150[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_145 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_301[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_145 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_301[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_504 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_144[0][0]']     
                                                                                                  
 multiply_505 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_144[0][0]']     
                                                                                                  
 multiply_506 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_145[0][0]']     
                                                                                                  
 multiply_507 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_145[0][0]']     
                                                                                                  
 concatenate_755 (Concatena  (None, 28, 28, 256)          0         ['multiply_504[0][0]',        
 te)                                                                 'multiply_505[0][0]']        
                                                                                                  
 concatenate_756 (Concatena  (None, 28, 28, 256)          0         ['multiply_506[0][0]',        
 te)                                                                 'multiply_507[0][0]']        
                                                                                                  
 stack2_block1_attn_height_  (None, 28, 28, 128)          1792      ['concatenate_755[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block1_attn_width_d  (None, 28, 28, 128)          1792      ['concatenate_756[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block1_attn_channel  (None, 28, 28, 128)          16384     ['batch_normalization_150[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_544 (Add)               (None, 28, 28, 128)          0         ['stack2_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_7  (None, 1, 1, 128)            0         ['add_544[0][0]']             
 9 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack2_block1_attn_reweigh  (None, 1, 1, 384)            16800     ['global_average_pooling2d_79[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_89 (Reshape)        (None, 1, 1, 128, 3)         0         ['stack2_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block1_attn_attenti  (None, 1, 1, 128, 3)         0         ['reshape_89[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_72 (TFOpLambda)  [(None, 1, 1, 128),          0         ['stack2_block1_attn_attention
                              (None, 1, 1, 128),                    _scores[0][0]']               
                              (None, 1, 1, 128)]                                                  
                                                                                                  
 multiply_508 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_72[0][0]']       
                                                                                                  
 multiply_509 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_72[0][1]']       
                                                                                                  
 multiply_510 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_72[0][2]']       
                                                                                                  
 add_545 (Add)               (None, 28, 28, 128)          0         ['multiply_508[0][0]',        
                                                                     'multiply_509[0][0]',        
                                                                     'multiply_510[0][0]']        
                                                                                                  
 stack2_block1_attn_out_ (C  (None, 28, 28, 128)          16512     ['add_545[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block1_attn_drop_ (  (None, 28, 28, 128)          0         ['stack2_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block1_attn_out (Ad  (None, 28, 28, 128)          0         ['batch_normalization_149[0][0
 d)                                                                 ]',                           
                                                                     'stack2_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 batch_normalization_153 (B  (None, 28, 28, 128)          512       ['stack2_block1_attn_out[0][0]
 atchNormalization)                                                 ']                            
                                                                                                  
 stack2_block1_mlp_blocl_ (  (None, 28, 28, 128)          131712    ['batch_normalization_153[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack2_block1_mlp_drop_ (D  (None, 28, 28, 128)          0         ['stack2_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block1_mlp_out (Add  (None, 28, 28, 128)          0         ['stack2_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 batch_normalization_154 (B  (None, 28, 28, 128)          512       ['stack2_block1_mlp_out[0][0]'
 atchNormalization)                                                 ]                             
                                                                                                  
 stack2_block2_attn_theta_h  (None, 28, 28, 128)          16512     ['batch_normalization_154[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack2_block2_attn_theta_w  (None, 28, 28, 128)          16512     ['batch_normalization_154[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_155 (B  (None, 28, 28, 128)          512       ['stack2_block2_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_156 (B  (None, 28, 28, 128)          512       ['stack2_block2_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_302 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_155[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_303 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_156[0][0
 )                                                                  ]']                           
                                                                                                  
 stack2_block2_attn_height_  (None, 28, 28, 128)          16384     ['batch_normalization_154[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_146 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_302[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_146 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_302[0][0]']      
 a)                                                                                               
                                                                                                  
 stack2_block2_attn_width_   (None, 28, 28, 128)          16384     ['batch_normalization_154[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_147 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_303[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_147 (TFOpLambd  (None, 28, 28, 128)          0         ['activation_303[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_511 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_146[0][0]']     
                                                                                                  
 multiply_512 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_146[0][0]']     
                                                                                                  
 multiply_513 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_147[0][0]']     
                                                                                                  
 multiply_514 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_147[0][0]']     
                                                                                                  
 concatenate_757 (Concatena  (None, 28, 28, 256)          0         ['multiply_511[0][0]',        
 te)                                                                 'multiply_512[0][0]']        
                                                                                                  
 concatenate_758 (Concatena  (None, 28, 28, 256)          0         ['multiply_513[0][0]',        
 te)                                                                 'multiply_514[0][0]']        
                                                                                                  
 stack2_block2_attn_height_  (None, 28, 28, 128)          1792      ['concatenate_757[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block2_attn_width_d  (None, 28, 28, 128)          1792      ['concatenate_758[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block2_attn_channel  (None, 28, 28, 128)          16384     ['batch_normalization_154[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_546 (Add)               (None, 28, 28, 128)          0         ['stack2_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_8  (None, 1, 1, 128)            0         ['add_546[0][0]']             
 0 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack2_block2_attn_reweigh  (None, 1, 1, 384)            16800     ['global_average_pooling2d_80[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_90 (Reshape)        (None, 1, 1, 128, 3)         0         ['stack2_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block2_attn_attenti  (None, 1, 1, 128, 3)         0         ['reshape_90[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_73 (TFOpLambda)  [(None, 1, 1, 128),          0         ['stack2_block2_attn_attention
                              (None, 1, 1, 128),                    _scores[0][0]']               
                              (None, 1, 1, 128)]                                                  
                                                                                                  
 multiply_515 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_73[0][0]']       
                                                                                                  
 multiply_516 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_73[0][1]']       
                                                                                                  
 multiply_517 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_73[0][2]']       
                                                                                                  
 add_547 (Add)               (None, 28, 28, 128)          0         ['multiply_515[0][0]',        
                                                                     'multiply_516[0][0]',        
                                                                     'multiply_517[0][0]']        
                                                                                                  
 stack2_block2_attn_out_ (C  (None, 28, 28, 128)          16512     ['add_547[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block2_attn_drop_ (  (None, 28, 28, 128)          0         ['stack2_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block2_attn_out (Ad  (None, 28, 28, 128)          0         ['stack2_block1_mlp_out[0][0]'
 d)                                                                 , 'stack2_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 batch_normalization_157 (B  (None, 28, 28, 128)          512       ['stack2_block2_attn_out[0][0]
 atchNormalization)                                                 ']                            
                                                                                                  
 stack2_block2_mlp_blocl_ (  (None, 28, 28, 128)          131712    ['batch_normalization_157[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack2_block2_mlp_drop_ (D  (None, 28, 28, 128)          0         ['stack2_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block2_mlp_out (Add  (None, 28, 28, 128)          0         ['stack2_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 stack3_down_sample_ (Conv2  (None, 14, 14, 320)          368960    ['stack2_block2_mlp_out[0][0]'
 D)                                                                 ]                             
                                                                                                  
 batch_normalization_158 (B  (None, 14, 14, 320)          1280      ['stack3_down_sample_[0][0]'] 
 atchNormalization)                                                                               
                                                                                                  
 batch_normalization_159 (B  (None, 14, 14, 320)          1280      ['batch_normalization_158[0][0
 atchNormalization)                                                 ]']                           
                                                                                                  
 stack3_block1_attn_theta_h  (None, 14, 14, 320)          102720    ['batch_normalization_159[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block1_attn_theta_w  (None, 14, 14, 320)          102720    ['batch_normalization_159[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_160 (B  (None, 14, 14, 320)          1280      ['stack3_block1_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_161 (B  (None, 14, 14, 320)          1280      ['stack3_block1_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_304 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_160[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_305 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_161[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block1_attn_height_  (None, 14, 14, 320)          102400    ['batch_normalization_159[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_148 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_304[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_148 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_304[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block1_attn_width_   (None, 14, 14, 320)          102400    ['batch_normalization_159[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_149 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_305[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_149 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_305[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_518 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_148[0][0]']     
                                                                                                  
 multiply_519 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_148[0][0]']     
                                                                                                  
 multiply_520 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_149[0][0]']     
                                                                                                  
 multiply_521 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_149[0][0]']     
                                                                                                  
 concatenate_759 (Concatena  (None, 14, 14, 640)          0         ['multiply_518[0][0]',        
 te)                                                                 'multiply_519[0][0]']        
                                                                                                  
 concatenate_760 (Concatena  (None, 14, 14, 640)          0         ['multiply_520[0][0]',        
 te)                                                                 'multiply_521[0][0]']        
                                                                                                  
 stack3_block1_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_759[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block1_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_760[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block1_attn_channel  (None, 14, 14, 320)          102400    ['batch_normalization_159[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_548 (Add)               (None, 14, 14, 320)          0         ['stack3_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_8  (None, 1, 1, 320)            0         ['add_548[0][0]']             
 1 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block1_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_81[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_91 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block1_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_91[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_74 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block1_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_522 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_74[0][0]']       
                                                                                                  
 multiply_523 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_74[0][1]']       
                                                                                                  
 multiply_524 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_74[0][2]']       
                                                                                                  
 add_549 (Add)               (None, 14, 14, 320)          0         ['multiply_522[0][0]',        
                                                                     'multiply_523[0][0]',        
                                                                     'multiply_524[0][0]']        
                                                                                                  
 stack3_block1_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_549[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block1_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block1_attn_out (Ad  (None, 14, 14, 320)          0         ['batch_normalization_158[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 batch_normalization_162 (B  (None, 14, 14, 320)          1280      ['stack3_block1_attn_out[0][0]
 atchNormalization)                                                 ']                            
                                                                                                  
 stack3_block1_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['batch_normalization_162[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block1_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block1_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 batch_normalization_163 (B  (None, 14, 14, 320)          1280      ['stack3_block1_mlp_out[0][0]'
 atchNormalization)                                                 ]                             
                                                                                                  
 stack3_block2_attn_theta_h  (None, 14, 14, 320)          102720    ['batch_normalization_163[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block2_attn_theta_w  (None, 14, 14, 320)          102720    ['batch_normalization_163[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_164 (B  (None, 14, 14, 320)          1280      ['stack3_block2_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_165 (B  (None, 14, 14, 320)          1280      ['stack3_block2_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_306 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_164[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_307 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_165[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block2_attn_height_  (None, 14, 14, 320)          102400    ['batch_normalization_163[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_150 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_306[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_150 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_306[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block2_attn_width_   (None, 14, 14, 320)          102400    ['batch_normalization_163[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_151 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_307[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_151 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_307[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_525 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_150[0][0]']     
                                                                                                  
 multiply_526 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_150[0][0]']     
                                                                                                  
 multiply_527 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_151[0][0]']     
                                                                                                  
 multiply_528 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_151[0][0]']     
                                                                                                  
 concatenate_761 (Concatena  (None, 14, 14, 640)          0         ['multiply_525[0][0]',        
 te)                                                                 'multiply_526[0][0]']        
                                                                                                  
 concatenate_762 (Concatena  (None, 14, 14, 640)          0         ['multiply_527[0][0]',        
 te)                                                                 'multiply_528[0][0]']        
                                                                                                  
 stack3_block2_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_761[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block2_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_762[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block2_attn_channel  (None, 14, 14, 320)          102400    ['batch_normalization_163[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_550 (Add)               (None, 14, 14, 320)          0         ['stack3_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_8  (None, 1, 1, 320)            0         ['add_550[0][0]']             
 2 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block2_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_82[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_92 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block2_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_92[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_75 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block2_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_529 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_75[0][0]']       
                                                                                                  
 multiply_530 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_75[0][1]']       
                                                                                                  
 multiply_531 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_75[0][2]']       
                                                                                                  
 add_551 (Add)               (None, 14, 14, 320)          0         ['multiply_529[0][0]',        
                                                                     'multiply_530[0][0]',        
                                                                     'multiply_531[0][0]']        
                                                                                                  
 stack3_block2_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_551[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block2_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block2_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block1_mlp_out[0][0]'
 d)                                                                 , 'stack3_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 batch_normalization_166 (B  (None, 14, 14, 320)          1280      ['stack3_block2_attn_out[0][0]
 atchNormalization)                                                 ']                            
                                                                                                  
 stack3_block2_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['batch_normalization_166[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block2_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block2_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 batch_normalization_167 (B  (None, 14, 14, 320)          1280      ['stack3_block2_mlp_out[0][0]'
 atchNormalization)                                                 ]                             
                                                                                                  
 stack3_block3_attn_theta_h  (None, 14, 14, 320)          102720    ['batch_normalization_167[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block3_attn_theta_w  (None, 14, 14, 320)          102720    ['batch_normalization_167[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_168 (B  (None, 14, 14, 320)          1280      ['stack3_block3_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_169 (B  (None, 14, 14, 320)          1280      ['stack3_block3_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_308 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_168[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_309 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_169[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block3_attn_height_  (None, 14, 14, 320)          102400    ['batch_normalization_167[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_152 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_308[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_152 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_308[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block3_attn_width_   (None, 14, 14, 320)          102400    ['batch_normalization_167[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_153 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_309[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_153 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_309[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_532 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_152[0][0]']     
                                                                                                  
 multiply_533 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_152[0][0]']     
                                                                                                  
 multiply_534 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_153[0][0]']     
                                                                                                  
 multiply_535 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_153[0][0]']     
                                                                                                  
 concatenate_763 (Concatena  (None, 14, 14, 640)          0         ['multiply_532[0][0]',        
 te)                                                                 'multiply_533[0][0]']        
                                                                                                  
 concatenate_764 (Concatena  (None, 14, 14, 640)          0         ['multiply_534[0][0]',        
 te)                                                                 'multiply_535[0][0]']        
                                                                                                  
 stack3_block3_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_763[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block3_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_764[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block3_attn_channel  (None, 14, 14, 320)          102400    ['batch_normalization_167[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_552 (Add)               (None, 14, 14, 320)          0         ['stack3_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block3_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_8  (None, 1, 1, 320)            0         ['add_552[0][0]']             
 3 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block3_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_83[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_93 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block3_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block3_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_93[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_76 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block3_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_536 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_76[0][0]']       
                                                                                                  
 multiply_537 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_76[0][1]']       
                                                                                                  
 multiply_538 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_76[0][2]']       
                                                                                                  
 add_553 (Add)               (None, 14, 14, 320)          0         ['multiply_536[0][0]',        
                                                                     'multiply_537[0][0]',        
                                                                     'multiply_538[0][0]']        
                                                                                                  
 stack3_block3_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_553[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block3_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block3_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block3_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block2_mlp_out[0][0]'
 d)                                                                 , 'stack3_block3_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 batch_normalization_170 (B  (None, 14, 14, 320)          1280      ['stack3_block3_attn_out[0][0]
 atchNormalization)                                                 ']                            
                                                                                                  
 stack3_block3_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['batch_normalization_170[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block3_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block3_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block3_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block3_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block3_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 batch_normalization_171 (B  (None, 14, 14, 320)          1280      ['stack3_block3_mlp_out[0][0]'
 atchNormalization)                                                 ]                             
                                                                                                  
 stack3_block4_attn_theta_h  (None, 14, 14, 320)          102720    ['batch_normalization_171[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack3_block4_attn_theta_w  (None, 14, 14, 320)          102720    ['batch_normalization_171[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_172 (B  (None, 14, 14, 320)          1280      ['stack3_block4_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_173 (B  (None, 14, 14, 320)          1280      ['stack3_block4_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_310 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_172[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_311 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_173[0][0
 )                                                                  ]']                           
                                                                                                  
 stack3_block4_attn_height_  (None, 14, 14, 320)          102400    ['batch_normalization_171[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_154 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_310[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_154 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_310[0][0]']      
 a)                                                                                               
                                                                                                  
 stack3_block4_attn_width_   (None, 14, 14, 320)          102400    ['batch_normalization_171[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_155 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_311[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_155 (TFOpLambd  (None, 14, 14, 320)          0         ['activation_311[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_539 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_154[0][0]']     
                                                                                                  
 multiply_540 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_154[0][0]']     
                                                                                                  
 multiply_541 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_155[0][0]']     
                                                                                                  
 multiply_542 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_155[0][0]']     
                                                                                                  
 concatenate_765 (Concatena  (None, 14, 14, 640)          0         ['multiply_539[0][0]',        
 te)                                                                 'multiply_540[0][0]']        
                                                                                                  
 concatenate_766 (Concatena  (None, 14, 14, 640)          0         ['multiply_541[0][0]',        
 te)                                                                 'multiply_542[0][0]']        
                                                                                                  
 stack3_block4_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_765[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block4_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_766[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block4_attn_channel  (None, 14, 14, 320)          102400    ['batch_normalization_171[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_554 (Add)               (None, 14, 14, 320)          0         ['stack3_block4_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block4_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block4_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_8  (None, 1, 1, 320)            0         ['add_554[0][0]']             
 4 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block4_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_84[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_94 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block4_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block4_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_94[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_77 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block4_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_543 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_77[0][0]']       
                                                                                                  
 multiply_544 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_77[0][1]']       
                                                                                                  
 multiply_545 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_77[0][2]']       
                                                                                                  
 add_555 (Add)               (None, 14, 14, 320)          0         ['multiply_543[0][0]',        
                                                                     'multiply_544[0][0]',        
                                                                     'multiply_545[0][0]']        
                                                                                                  
 stack3_block4_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_555[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block4_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block4_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block4_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block3_mlp_out[0][0]'
 d)                                                                 , 'stack3_block4_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 batch_normalization_174 (B  (None, 14, 14, 320)          1280      ['stack3_block4_attn_out[0][0]
 atchNormalization)                                                 ']                            
                                                                                                  
 stack3_block4_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['batch_normalization_174[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack3_block4_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block4_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block4_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block4_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block4_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 stack4_down_sample_ (Conv2  (None, 7, 7, 512)            1475072   ['stack3_block4_mlp_out[0][0]'
 D)                                                                 ]                             
                                                                                                  
 batch_normalization_175 (B  (None, 7, 7, 512)            2048      ['stack4_down_sample_[0][0]'] 
 atchNormalization)                                                                               
                                                                                                  
 batch_normalization_176 (B  (None, 7, 7, 512)            2048      ['batch_normalization_175[0][0
 atchNormalization)                                                 ]']                           
                                                                                                  
 stack4_block1_attn_theta_h  (None, 7, 7, 512)            262656    ['batch_normalization_176[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack4_block1_attn_theta_w  (None, 7, 7, 512)            262656    ['batch_normalization_176[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_177 (B  (None, 7, 7, 512)            2048      ['stack4_block1_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_178 (B  (None, 7, 7, 512)            2048      ['stack4_block1_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_312 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_177[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_313 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_178[0][0
 )                                                                  ]']                           
                                                                                                  
 stack4_block1_attn_height_  (None, 7, 7, 512)            262144    ['batch_normalization_176[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_156 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_312[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_156 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_312[0][0]']      
 a)                                                                                               
                                                                                                  
 stack4_block1_attn_width_   (None, 7, 7, 512)            262144    ['batch_normalization_176[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_157 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_313[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_157 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_313[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_546 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_156[0][0]']     
                                                                                                  
 multiply_547 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_156[0][0]']     
                                                                                                  
 multiply_548 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_157[0][0]']     
                                                                                                  
 multiply_549 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_157[0][0]']     
                                                                                                  
 concatenate_767 (Concatena  (None, 7, 7, 1024)           0         ['multiply_546[0][0]',        
 te)                                                                 'multiply_547[0][0]']        
                                                                                                  
 concatenate_768 (Concatena  (None, 7, 7, 1024)           0         ['multiply_548[0][0]',        
 te)                                                                 'multiply_549[0][0]']        
                                                                                                  
 stack4_block1_attn_height_  (None, 7, 7, 512)            7168      ['concatenate_767[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack4_block1_attn_width_d  (None, 7, 7, 512)            7168      ['concatenate_768[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack4_block1_attn_channel  (None, 7, 7, 512)            262144    ['batch_normalization_176[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_556 (Add)               (None, 7, 7, 512)            0         ['stack4_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack4_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack4_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_8  (None, 1, 1, 512)            0         ['add_556[0][0]']             
 5 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack4_block1_attn_reweigh  (None, 1, 1, 1536)           263808    ['global_average_pooling2d_85[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_95 (Reshape)        (None, 1, 1, 512, 3)         0         ['stack4_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack4_block1_attn_attenti  (None, 1, 1, 512, 3)         0         ['reshape_95[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_78 (TFOpLambda)  [(None, 1, 1, 512),          0         ['stack4_block1_attn_attention
                              (None, 1, 1, 512),                    _scores[0][0]']               
                              (None, 1, 1, 512)]                                                  
                                                                                                  
 multiply_550 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_78[0][0]']       
                                                                                                  
 multiply_551 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_78[0][1]']       
                                                                                                  
 multiply_552 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_78[0][2]']       
                                                                                                  
 add_557 (Add)               (None, 7, 7, 512)            0         ['multiply_550[0][0]',        
                                                                     'multiply_551[0][0]',        
                                                                     'multiply_552[0][0]']        
                                                                                                  
 stack4_block1_attn_out_ (C  (None, 7, 7, 512)            262656    ['add_557[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack4_block1_attn_drop_ (  (None, 7, 7, 512)            0         ['stack4_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack4_block1_attn_out (Ad  (None, 7, 7, 512)            0         ['batch_normalization_175[0][0
 d)                                                                 ]',                           
                                                                     'stack4_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 batch_normalization_179 (B  (None, 7, 7, 512)            2048      ['stack4_block1_attn_out[0][0]
 atchNormalization)                                                 ']                            
                                                                                                  
 stack4_block1_mlp_blocl_ (  (None, 7, 7, 512)            2099712   ['batch_normalization_179[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack4_block1_mlp_drop_ (D  (None, 7, 7, 512)            0         ['stack4_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack4_block1_mlp_out (Add  (None, 7, 7, 512)            0         ['stack4_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack4_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 batch_normalization_180 (B  (None, 7, 7, 512)            2048      ['stack4_block1_mlp_out[0][0]'
 atchNormalization)                                                 ]                             
                                                                                                  
 stack4_block2_attn_theta_h  (None, 7, 7, 512)            262656    ['batch_normalization_180[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack4_block2_attn_theta_w  (None, 7, 7, 512)            262656    ['batch_normalization_180[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_181 (B  (None, 7, 7, 512)            2048      ['stack4_block2_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_182 (B  (None, 7, 7, 512)            2048      ['stack4_block2_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_314 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_181[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_315 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_182[0][0
 )                                                                  ]']                           
                                                                                                  
 stack4_block2_attn_height_  (None, 7, 7, 512)            262144    ['batch_normalization_180[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_158 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_314[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_158 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_314[0][0]']      
 a)                                                                                               
                                                                                                  
 stack4_block2_attn_width_   (None, 7, 7, 512)            262144    ['batch_normalization_180[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_159 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_315[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_159 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_315[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_553 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_158[0][0]']     
                                                                                                  
 multiply_554 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_158[0][0]']     
                                                                                                  
 multiply_555 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_159[0][0]']     
                                                                                                  
 multiply_556 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_159[0][0]']     
                                                                                                  
 concatenate_769 (Concatena  (None, 7, 7, 1024)           0         ['multiply_553[0][0]',        
 te)                                                                 'multiply_554[0][0]']        
                                                                                                  
 concatenate_770 (Concatena  (None, 7, 7, 1024)           0         ['multiply_555[0][0]',        
 te)                                                                 'multiply_556[0][0]']        
                                                                                                  
 stack4_block2_attn_height_  (None, 7, 7, 512)            7168      ['concatenate_769[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack4_block2_attn_width_d  (None, 7, 7, 512)            7168      ['concatenate_770[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack4_block2_attn_channel  (None, 7, 7, 512)            262144    ['batch_normalization_180[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_558 (Add)               (None, 7, 7, 512)            0         ['stack4_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack4_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack4_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_8  (None, 1, 1, 512)            0         ['add_558[0][0]']             
 6 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack4_block2_attn_reweigh  (None, 1, 1, 1536)           263808    ['global_average_pooling2d_86[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_96 (Reshape)        (None, 1, 1, 512, 3)         0         ['stack4_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack4_block2_attn_attenti  (None, 1, 1, 512, 3)         0         ['reshape_96[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_79 (TFOpLambda)  [(None, 1, 1, 512),          0         ['stack4_block2_attn_attention
                              (None, 1, 1, 512),                    _scores[0][0]']               
                              (None, 1, 1, 512)]                                                  
                                                                                                  
 multiply_557 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_79[0][0]']       
                                                                                                  
 multiply_558 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_79[0][1]']       
                                                                                                  
 multiply_559 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_79[0][2]']       
                                                                                                  
 add_559 (Add)               (None, 7, 7, 512)            0         ['multiply_557[0][0]',        
                                                                     'multiply_558[0][0]',        
                                                                     'multiply_559[0][0]']        
                                                                                                  
 stack4_block2_attn_out_ (C  (None, 7, 7, 512)            262656    ['add_559[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack4_block2_attn_drop_ (  (None, 7, 7, 512)            0         ['stack4_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack4_block2_attn_out (Ad  (None, 7, 7, 512)            0         ['stack4_block1_mlp_out[0][0]'
 d)                                                                 , 'stack4_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 batch_normalization_183 (B  (None, 7, 7, 512)            2048      ['stack4_block2_attn_out[0][0]
 atchNormalization)                                                 ']                            
                                                                                                  
 stack4_block2_mlp_blocl_ (  (None, 7, 7, 512)            2099712   ['batch_normalization_183[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack4_block2_mlp_drop_ (D  (None, 7, 7, 512)            0         ['stack4_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack4_block2_mlp_out (Add  (None, 7, 7, 512)            0         ['stack4_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack4_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 batch_normalization_184 (B  (None, 7, 7, 512)            2048      ['stack4_block2_mlp_out[0][0]'
 atchNormalization)                                                 ]                             
                                                                                                  
 global_average_pooling2d_8  (None, 512)                  0         ['batch_normalization_184[0][0
 7 (GlobalAveragePooling2D)                                         ]']                           
                                                                                                  
 dropout_17 (Dropout)        (None, 512)                  0         ['global_average_pooling2d_87[
                                                                    0][0]']                       
                                                                                                  
 predictions (Dense)         (None, 1000)                 513000    ['dropout_17[0][0]']          
                                                                                                  
 activation_316 (Activation  (None, 1000)                 0         ['predictions[0][0]']         
 )                                                                                                
                                                                                                  
==================================================================================================
Total params: 17217736 (65.68 MB)
Trainable params: 17193160 (65.59 MB)
Non-trainable params: 24576 (96.00 KB)
__________________________________________________________________________________________________
