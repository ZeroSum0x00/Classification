Model: "WaveMLP-M"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input_100 (InputLayer)      [(None, 224, 224, 3)]        0         []                            
                                                                                                  
 stem_pad (ZeroPadding2D)    (None, 228, 228, 3)          0         ['input_100[0][0]']           
                                                                                                  
 stem_conv_ (Conv2D)         (None, 56, 56, 64)           9472      ['stem_pad[0][0]']            
                                                                                                  
 group_normalization_49 (Gr  (None, 56, 56, 64)           128       ['stem_conv_[0][0]']          
 oupNormalization)                                                                                
                                                                                                  
 stack1_block1_attn_theta_h  (None, 56, 56, 64)           4160      ['group_normalization_49[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack1_block1_attn_theta_w  (None, 56, 56, 64)           4160      ['group_normalization_49[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_48 (Ba  (None, 56, 56, 64)           256       ['stack1_block1_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_49 (Ba  (None, 56, 56, 64)           256       ['stack1_block1_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_202 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_48[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_203 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_49[0][0]
 )                                                                  ']                            
                                                                                                  
 stack1_block1_attn_height_  (None, 56, 56, 64)           4096      ['group_normalization_49[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_48 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_202[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_48 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_202[0][0]']      
 )                                                                                                
                                                                                                  
 stack1_block1_attn_width_   (None, 56, 56, 64)           4096      ['group_normalization_49[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_49 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_203[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_49 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_203[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_168 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_48[0][0]']      
                                                                                                  
 multiply_169 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_48[0][0]']      
                                                                                                  
 multiply_170 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_49[0][0]']      
                                                                                                  
 multiply_171 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_49[0][0]']      
                                                                                                  
 concatenate_659 (Concatena  (None, 56, 56, 128)          0         ['multiply_168[0][0]',        
 te)                                                                 'multiply_169[0][0]']        
                                                                                                  
 concatenate_660 (Concatena  (None, 56, 56, 128)          0         ['multiply_170[0][0]',        
 te)                                                                 'multiply_171[0][0]']        
                                                                                                  
 stack1_block1_attn_height_  (None, 56, 56, 64)           896       ['concatenate_659[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack1_block1_attn_width_d  (None, 56, 56, 64)           896       ['concatenate_660[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack1_block1_attn_channel  (None, 56, 56, 64)           4096      ['group_normalization_49[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_448 (Add)               (None, 56, 56, 64)           0         ['stack1_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack1_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack1_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_2  (None, 1, 1, 64)             0         ['add_448[0][0]']             
 9 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack1_block1_attn_reweigh  (None, 1, 1, 192)            4304      ['global_average_pooling2d_29[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_41 (Reshape)        (None, 1, 1, 64, 3)          0         ['stack1_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack1_block1_attn_attenti  (None, 1, 1, 64, 3)          0         ['reshape_41[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_24 (TFOpLambda)  [(None, 1, 1, 64),           0         ['stack1_block1_attn_attention
                              (None, 1, 1, 64),                     _scores[0][0]']               
                              (None, 1, 1, 64)]                                                   
                                                                                                  
 multiply_172 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_24[0][0]']       
                                                                                                  
 multiply_173 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_24[0][1]']       
                                                                                                  
 multiply_174 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_24[0][2]']       
                                                                                                  
 add_449 (Add)               (None, 56, 56, 64)           0         ['multiply_172[0][0]',        
                                                                     'multiply_173[0][0]',        
                                                                     'multiply_174[0][0]']        
                                                                                                  
 stack1_block1_attn_out_ (C  (None, 56, 56, 64)           4160      ['add_449[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack1_block1_attn_drop_ (  (None, 56, 56, 64)           0         ['stack1_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack1_block1_attn_out (Ad  (None, 56, 56, 64)           0         ['stem_conv_[0][0]',          
 d)                                                                  'stack1_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_50 (Gr  (None, 56, 56, 64)           128       ['stack1_block1_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack1_block1_mlp_blocl_ (  (None, 56, 56, 64)           66112     ['group_normalization_50[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack1_block1_mlp_drop_ (D  (None, 56, 56, 64)           0         ['stack1_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack1_block1_mlp_out (Add  (None, 56, 56, 64)           0         ['stack1_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack1_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_51 (Gr  (None, 56, 56, 64)           128       ['stack1_block1_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack1_block2_attn_theta_h  (None, 56, 56, 64)           4160      ['group_normalization_51[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack1_block2_attn_theta_w  (None, 56, 56, 64)           4160      ['group_normalization_51[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_50 (Ba  (None, 56, 56, 64)           256       ['stack1_block2_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_51 (Ba  (None, 56, 56, 64)           256       ['stack1_block2_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_204 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_50[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_205 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_51[0][0]
 )                                                                  ']                            
                                                                                                  
 stack1_block2_attn_height_  (None, 56, 56, 64)           4096      ['group_normalization_51[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_50 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_204[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_50 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_204[0][0]']      
 )                                                                                                
                                                                                                  
 stack1_block2_attn_width_   (None, 56, 56, 64)           4096      ['group_normalization_51[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_51 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_205[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_51 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_205[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_175 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_50[0][0]']      
                                                                                                  
 multiply_176 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_50[0][0]']      
                                                                                                  
 multiply_177 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_51[0][0]']      
                                                                                                  
 multiply_178 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_51[0][0]']      
                                                                                                  
 concatenate_661 (Concatena  (None, 56, 56, 128)          0         ['multiply_175[0][0]',        
 te)                                                                 'multiply_176[0][0]']        
                                                                                                  
 concatenate_662 (Concatena  (None, 56, 56, 128)          0         ['multiply_177[0][0]',        
 te)                                                                 'multiply_178[0][0]']        
                                                                                                  
 stack1_block2_attn_height_  (None, 56, 56, 64)           896       ['concatenate_661[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack1_block2_attn_width_d  (None, 56, 56, 64)           896       ['concatenate_662[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack1_block2_attn_channel  (None, 56, 56, 64)           4096      ['group_normalization_51[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_450 (Add)               (None, 56, 56, 64)           0         ['stack1_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack1_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack1_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_3  (None, 1, 1, 64)             0         ['add_450[0][0]']             
 0 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack1_block2_attn_reweigh  (None, 1, 1, 192)            4304      ['global_average_pooling2d_30[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_42 (Reshape)        (None, 1, 1, 64, 3)          0         ['stack1_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack1_block2_attn_attenti  (None, 1, 1, 64, 3)          0         ['reshape_42[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_25 (TFOpLambda)  [(None, 1, 1, 64),           0         ['stack1_block2_attn_attention
                              (None, 1, 1, 64),                     _scores[0][0]']               
                              (None, 1, 1, 64)]                                                   
                                                                                                  
 multiply_179 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_25[0][0]']       
                                                                                                  
 multiply_180 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_25[0][1]']       
                                                                                                  
 multiply_181 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_25[0][2]']       
                                                                                                  
 add_451 (Add)               (None, 56, 56, 64)           0         ['multiply_179[0][0]',        
                                                                     'multiply_180[0][0]',        
                                                                     'multiply_181[0][0]']        
                                                                                                  
 stack1_block2_attn_out_ (C  (None, 56, 56, 64)           4160      ['add_451[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack1_block2_attn_drop_ (  (None, 56, 56, 64)           0         ['stack1_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack1_block2_attn_out (Ad  (None, 56, 56, 64)           0         ['stack1_block1_mlp_out[0][0]'
 d)                                                                 , 'stack1_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_52 (Gr  (None, 56, 56, 64)           128       ['stack1_block2_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack1_block2_mlp_blocl_ (  (None, 56, 56, 64)           66112     ['group_normalization_52[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack1_block2_mlp_drop_ (D  (None, 56, 56, 64)           0         ['stack1_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack1_block2_mlp_out (Add  (None, 56, 56, 64)           0         ['stack1_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack1_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_53 (Gr  (None, 56, 56, 64)           128       ['stack1_block2_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack1_block3_attn_theta_h  (None, 56, 56, 64)           4160      ['group_normalization_53[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack1_block3_attn_theta_w  (None, 56, 56, 64)           4160      ['group_normalization_53[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_52 (Ba  (None, 56, 56, 64)           256       ['stack1_block3_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_53 (Ba  (None, 56, 56, 64)           256       ['stack1_block3_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_206 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_52[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_207 (Activation  (None, 56, 56, 64)           0         ['batch_normalization_53[0][0]
 )                                                                  ']                            
                                                                                                  
 stack1_block3_attn_height_  (None, 56, 56, 64)           4096      ['group_normalization_53[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_52 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_206[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_52 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_206[0][0]']      
 )                                                                                                
                                                                                                  
 stack1_block3_attn_width_   (None, 56, 56, 64)           4096      ['group_normalization_53[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_53 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_207[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_53 (TFOpLambda  (None, 56, 56, 64)           0         ['activation_207[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_182 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_52[0][0]']      
                                                                                                  
 multiply_183 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_52[0][0]']      
                                                                                                  
 multiply_184 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_53[0][0]']      
                                                                                                  
 multiply_185 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_53[0][0]']      
                                                                                                  
 concatenate_663 (Concatena  (None, 56, 56, 128)          0         ['multiply_182[0][0]',        
 te)                                                                 'multiply_183[0][0]']        
                                                                                                  
 concatenate_664 (Concatena  (None, 56, 56, 128)          0         ['multiply_184[0][0]',        
 te)                                                                 'multiply_185[0][0]']        
                                                                                                  
 stack1_block3_attn_height_  (None, 56, 56, 64)           896       ['concatenate_663[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack1_block3_attn_width_d  (None, 56, 56, 64)           896       ['concatenate_664[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack1_block3_attn_channel  (None, 56, 56, 64)           4096      ['group_normalization_53[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_452 (Add)               (None, 56, 56, 64)           0         ['stack1_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack1_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack1_block3_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_3  (None, 1, 1, 64)             0         ['add_452[0][0]']             
 1 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack1_block3_attn_reweigh  (None, 1, 1, 192)            4304      ['global_average_pooling2d_31[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_43 (Reshape)        (None, 1, 1, 64, 3)          0         ['stack1_block3_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack1_block3_attn_attenti  (None, 1, 1, 64, 3)          0         ['reshape_43[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_26 (TFOpLambda)  [(None, 1, 1, 64),           0         ['stack1_block3_attn_attention
                              (None, 1, 1, 64),                     _scores[0][0]']               
                              (None, 1, 1, 64)]                                                   
                                                                                                  
 multiply_186 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_26[0][0]']       
                                                                                                  
 multiply_187 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_26[0][1]']       
                                                                                                  
 multiply_188 (Multiply)     (None, 56, 56, 64)           0         ['stack1_block3_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_26[0][2]']       
                                                                                                  
 add_453 (Add)               (None, 56, 56, 64)           0         ['multiply_186[0][0]',        
                                                                     'multiply_187[0][0]',        
                                                                     'multiply_188[0][0]']        
                                                                                                  
 stack1_block3_attn_out_ (C  (None, 56, 56, 64)           4160      ['add_453[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack1_block3_attn_drop_ (  (None, 56, 56, 64)           0         ['stack1_block3_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack1_block3_attn_out (Ad  (None, 56, 56, 64)           0         ['stack1_block2_mlp_out[0][0]'
 d)                                                                 , 'stack1_block3_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_54 (Gr  (None, 56, 56, 64)           128       ['stack1_block3_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack1_block3_mlp_blocl_ (  (None, 56, 56, 64)           66112     ['group_normalization_54[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack1_block3_mlp_drop_ (D  (None, 56, 56, 64)           0         ['stack1_block3_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack1_block3_mlp_out (Add  (None, 56, 56, 64)           0         ['stack1_block3_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack1_block3_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 stack2_down_sample_ (Conv2  (None, 28, 28, 128)          73856     ['stack1_block3_mlp_out[0][0]'
 D)                                                                 ]                             
                                                                                                  
 group_normalization_55 (Gr  (None, 28, 28, 128)          256       ['stack2_down_sample_[0][0]'] 
 oupNormalization)                                                                                
                                                                                                  
 stack2_block1_attn_theta_h  (None, 28, 28, 128)          16512     ['group_normalization_55[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack2_block1_attn_theta_w  (None, 28, 28, 128)          16512     ['group_normalization_55[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_54 (Ba  (None, 28, 28, 128)          512       ['stack2_block1_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_55 (Ba  (None, 28, 28, 128)          512       ['stack2_block1_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_208 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_54[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_209 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_55[0][0]
 )                                                                  ']                            
                                                                                                  
 stack2_block1_attn_height_  (None, 28, 28, 128)          16384     ['group_normalization_55[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_54 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_208[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_54 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_208[0][0]']      
 )                                                                                                
                                                                                                  
 stack2_block1_attn_width_   (None, 28, 28, 128)          16384     ['group_normalization_55[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_55 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_209[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_55 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_209[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_189 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_54[0][0]']      
                                                                                                  
 multiply_190 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_54[0][0]']      
                                                                                                  
 multiply_191 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_55[0][0]']      
                                                                                                  
 multiply_192 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_55[0][0]']      
                                                                                                  
 concatenate_665 (Concatena  (None, 28, 28, 256)          0         ['multiply_189[0][0]',        
 te)                                                                 'multiply_190[0][0]']        
                                                                                                  
 concatenate_666 (Concatena  (None, 28, 28, 256)          0         ['multiply_191[0][0]',        
 te)                                                                 'multiply_192[0][0]']        
                                                                                                  
 stack2_block1_attn_height_  (None, 28, 28, 128)          1792      ['concatenate_665[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block1_attn_width_d  (None, 28, 28, 128)          1792      ['concatenate_666[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block1_attn_channel  (None, 28, 28, 128)          16384     ['group_normalization_55[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_454 (Add)               (None, 28, 28, 128)          0         ['stack2_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_3  (None, 1, 1, 128)            0         ['add_454[0][0]']             
 2 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack2_block1_attn_reweigh  (None, 1, 1, 384)            16800     ['global_average_pooling2d_32[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_44 (Reshape)        (None, 1, 1, 128, 3)         0         ['stack2_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block1_attn_attenti  (None, 1, 1, 128, 3)         0         ['reshape_44[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_27 (TFOpLambda)  [(None, 1, 1, 128),          0         ['stack2_block1_attn_attention
                              (None, 1, 1, 128),                    _scores[0][0]']               
                              (None, 1, 1, 128)]                                                  
                                                                                                  
 multiply_193 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_27[0][0]']       
                                                                                                  
 multiply_194 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_27[0][1]']       
                                                                                                  
 multiply_195 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_27[0][2]']       
                                                                                                  
 add_455 (Add)               (None, 28, 28, 128)          0         ['multiply_193[0][0]',        
                                                                     'multiply_194[0][0]',        
                                                                     'multiply_195[0][0]']        
                                                                                                  
 stack2_block1_attn_out_ (C  (None, 28, 28, 128)          16512     ['add_455[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block1_attn_drop_ (  (None, 28, 28, 128)          0         ['stack2_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block1_attn_out (Ad  (None, 28, 28, 128)          0         ['stack2_down_sample_[0][0]', 
 d)                                                                  'stack2_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_56 (Gr  (None, 28, 28, 128)          256       ['stack2_block1_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack2_block1_mlp_blocl_ (  (None, 28, 28, 128)          263296    ['group_normalization_56[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack2_block1_mlp_drop_ (D  (None, 28, 28, 128)          0         ['stack2_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block1_mlp_out (Add  (None, 28, 28, 128)          0         ['stack2_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_57 (Gr  (None, 28, 28, 128)          256       ['stack2_block1_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack2_block2_attn_theta_h  (None, 28, 28, 128)          16512     ['group_normalization_57[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack2_block2_attn_theta_w  (None, 28, 28, 128)          16512     ['group_normalization_57[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_56 (Ba  (None, 28, 28, 128)          512       ['stack2_block2_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_57 (Ba  (None, 28, 28, 128)          512       ['stack2_block2_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_210 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_56[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_211 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_57[0][0]
 )                                                                  ']                            
                                                                                                  
 stack2_block2_attn_height_  (None, 28, 28, 128)          16384     ['group_normalization_57[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_56 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_210[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_56 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_210[0][0]']      
 )                                                                                                
                                                                                                  
 stack2_block2_attn_width_   (None, 28, 28, 128)          16384     ['group_normalization_57[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_57 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_211[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_57 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_211[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_196 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_56[0][0]']      
                                                                                                  
 multiply_197 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_56[0][0]']      
                                                                                                  
 multiply_198 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_57[0][0]']      
                                                                                                  
 multiply_199 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_57[0][0]']      
                                                                                                  
 concatenate_667 (Concatena  (None, 28, 28, 256)          0         ['multiply_196[0][0]',        
 te)                                                                 'multiply_197[0][0]']        
                                                                                                  
 concatenate_668 (Concatena  (None, 28, 28, 256)          0         ['multiply_198[0][0]',        
 te)                                                                 'multiply_199[0][0]']        
                                                                                                  
 stack2_block2_attn_height_  (None, 28, 28, 128)          1792      ['concatenate_667[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block2_attn_width_d  (None, 28, 28, 128)          1792      ['concatenate_668[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block2_attn_channel  (None, 28, 28, 128)          16384     ['group_normalization_57[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_456 (Add)               (None, 28, 28, 128)          0         ['stack2_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_3  (None, 1, 1, 128)            0         ['add_456[0][0]']             
 3 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack2_block2_attn_reweigh  (None, 1, 1, 384)            16800     ['global_average_pooling2d_33[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_45 (Reshape)        (None, 1, 1, 128, 3)         0         ['stack2_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block2_attn_attenti  (None, 1, 1, 128, 3)         0         ['reshape_45[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_28 (TFOpLambda)  [(None, 1, 1, 128),          0         ['stack2_block2_attn_attention
                              (None, 1, 1, 128),                    _scores[0][0]']               
                              (None, 1, 1, 128)]                                                  
                                                                                                  
 multiply_200 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_28[0][0]']       
                                                                                                  
 multiply_201 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_28[0][1]']       
                                                                                                  
 multiply_202 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_28[0][2]']       
                                                                                                  
 add_457 (Add)               (None, 28, 28, 128)          0         ['multiply_200[0][0]',        
                                                                     'multiply_201[0][0]',        
                                                                     'multiply_202[0][0]']        
                                                                                                  
 stack2_block2_attn_out_ (C  (None, 28, 28, 128)          16512     ['add_457[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block2_attn_drop_ (  (None, 28, 28, 128)          0         ['stack2_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block2_attn_out (Ad  (None, 28, 28, 128)          0         ['stack2_block1_mlp_out[0][0]'
 d)                                                                 , 'stack2_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_58 (Gr  (None, 28, 28, 128)          256       ['stack2_block2_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack2_block2_mlp_blocl_ (  (None, 28, 28, 128)          263296    ['group_normalization_58[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack2_block2_mlp_drop_ (D  (None, 28, 28, 128)          0         ['stack2_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block2_mlp_out (Add  (None, 28, 28, 128)          0         ['stack2_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_59 (Gr  (None, 28, 28, 128)          256       ['stack2_block2_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack2_block3_attn_theta_h  (None, 28, 28, 128)          16512     ['group_normalization_59[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack2_block3_attn_theta_w  (None, 28, 28, 128)          16512     ['group_normalization_59[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_58 (Ba  (None, 28, 28, 128)          512       ['stack2_block3_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_59 (Ba  (None, 28, 28, 128)          512       ['stack2_block3_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_212 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_58[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_213 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_59[0][0]
 )                                                                  ']                            
                                                                                                  
 stack2_block3_attn_height_  (None, 28, 28, 128)          16384     ['group_normalization_59[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_58 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_212[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_58 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_212[0][0]']      
 )                                                                                                
                                                                                                  
 stack2_block3_attn_width_   (None, 28, 28, 128)          16384     ['group_normalization_59[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_59 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_213[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_59 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_213[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_203 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_58[0][0]']      
                                                                                                  
 multiply_204 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_58[0][0]']      
                                                                                                  
 multiply_205 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_59[0][0]']      
                                                                                                  
 multiply_206 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_59[0][0]']      
                                                                                                  
 concatenate_669 (Concatena  (None, 28, 28, 256)          0         ['multiply_203[0][0]',        
 te)                                                                 'multiply_204[0][0]']        
                                                                                                  
 concatenate_670 (Concatena  (None, 28, 28, 256)          0         ['multiply_205[0][0]',        
 te)                                                                 'multiply_206[0][0]']        
                                                                                                  
 stack2_block3_attn_height_  (None, 28, 28, 128)          1792      ['concatenate_669[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block3_attn_width_d  (None, 28, 28, 128)          1792      ['concatenate_670[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block3_attn_channel  (None, 28, 28, 128)          16384     ['group_normalization_59[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_458 (Add)               (None, 28, 28, 128)          0         ['stack2_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block3_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_3  (None, 1, 1, 128)            0         ['add_458[0][0]']             
 4 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack2_block3_attn_reweigh  (None, 1, 1, 384)            16800     ['global_average_pooling2d_34[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_46 (Reshape)        (None, 1, 1, 128, 3)         0         ['stack2_block3_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block3_attn_attenti  (None, 1, 1, 128, 3)         0         ['reshape_46[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_29 (TFOpLambda)  [(None, 1, 1, 128),          0         ['stack2_block3_attn_attention
                              (None, 1, 1, 128),                    _scores[0][0]']               
                              (None, 1, 1, 128)]                                                  
                                                                                                  
 multiply_207 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_29[0][0]']       
                                                                                                  
 multiply_208 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_29[0][1]']       
                                                                                                  
 multiply_209 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block3_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_29[0][2]']       
                                                                                                  
 add_459 (Add)               (None, 28, 28, 128)          0         ['multiply_207[0][0]',        
                                                                     'multiply_208[0][0]',        
                                                                     'multiply_209[0][0]']        
                                                                                                  
 stack2_block3_attn_out_ (C  (None, 28, 28, 128)          16512     ['add_459[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block3_attn_drop_ (  (None, 28, 28, 128)          0         ['stack2_block3_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block3_attn_out (Ad  (None, 28, 28, 128)          0         ['stack2_block2_mlp_out[0][0]'
 d)                                                                 , 'stack2_block3_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_60 (Gr  (None, 28, 28, 128)          256       ['stack2_block3_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack2_block3_mlp_blocl_ (  (None, 28, 28, 128)          263296    ['group_normalization_60[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack2_block3_mlp_drop_ (D  (None, 28, 28, 128)          0         ['stack2_block3_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block3_mlp_out (Add  (None, 28, 28, 128)          0         ['stack2_block3_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block3_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_61 (Gr  (None, 28, 28, 128)          256       ['stack2_block3_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack2_block4_attn_theta_h  (None, 28, 28, 128)          16512     ['group_normalization_61[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack2_block4_attn_theta_w  (None, 28, 28, 128)          16512     ['group_normalization_61[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_60 (Ba  (None, 28, 28, 128)          512       ['stack2_block4_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_61 (Ba  (None, 28, 28, 128)          512       ['stack2_block4_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_214 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_60[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_215 (Activation  (None, 28, 28, 128)          0         ['batch_normalization_61[0][0]
 )                                                                  ']                            
                                                                                                  
 stack2_block4_attn_height_  (None, 28, 28, 128)          16384     ['group_normalization_61[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_60 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_214[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_60 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_214[0][0]']      
 )                                                                                                
                                                                                                  
 stack2_block4_attn_width_   (None, 28, 28, 128)          16384     ['group_normalization_61[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_61 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_215[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_61 (TFOpLambda  (None, 28, 28, 128)          0         ['activation_215[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_210 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block4_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_60[0][0]']      
                                                                                                  
 multiply_211 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block4_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_60[0][0]']      
                                                                                                  
 multiply_212 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block4_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_61[0][0]']      
                                                                                                  
 multiply_213 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block4_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_61[0][0]']      
                                                                                                  
 concatenate_671 (Concatena  (None, 28, 28, 256)          0         ['multiply_210[0][0]',        
 te)                                                                 'multiply_211[0][0]']        
                                                                                                  
 concatenate_672 (Concatena  (None, 28, 28, 256)          0         ['multiply_212[0][0]',        
 te)                                                                 'multiply_213[0][0]']        
                                                                                                  
 stack2_block4_attn_height_  (None, 28, 28, 128)          1792      ['concatenate_671[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack2_block4_attn_width_d  (None, 28, 28, 128)          1792      ['concatenate_672[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack2_block4_attn_channel  (None, 28, 28, 128)          16384     ['group_normalization_61[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_460 (Add)               (None, 28, 28, 128)          0         ['stack2_block4_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack2_block4_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack2_block4_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_3  (None, 1, 1, 128)            0         ['add_460[0][0]']             
 5 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack2_block4_attn_reweigh  (None, 1, 1, 384)            16800     ['global_average_pooling2d_35[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_47 (Reshape)        (None, 1, 1, 128, 3)         0         ['stack2_block4_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack2_block4_attn_attenti  (None, 1, 1, 128, 3)         0         ['reshape_47[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_30 (TFOpLambda)  [(None, 1, 1, 128),          0         ['stack2_block4_attn_attention
                              (None, 1, 1, 128),                    _scores[0][0]']               
                              (None, 1, 1, 128)]                                                  
                                                                                                  
 multiply_214 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block4_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_30[0][0]']       
                                                                                                  
 multiply_215 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block4_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_30[0][1]']       
                                                                                                  
 multiply_216 (Multiply)     (None, 28, 28, 128)          0         ['stack2_block4_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_30[0][2]']       
                                                                                                  
 add_461 (Add)               (None, 28, 28, 128)          0         ['multiply_214[0][0]',        
                                                                     'multiply_215[0][0]',        
                                                                     'multiply_216[0][0]']        
                                                                                                  
 stack2_block4_attn_out_ (C  (None, 28, 28, 128)          16512     ['add_461[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack2_block4_attn_drop_ (  (None, 28, 28, 128)          0         ['stack2_block4_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack2_block4_attn_out (Ad  (None, 28, 28, 128)          0         ['stack2_block3_mlp_out[0][0]'
 d)                                                                 , 'stack2_block4_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_62 (Gr  (None, 28, 28, 128)          256       ['stack2_block4_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack2_block4_mlp_blocl_ (  (None, 28, 28, 128)          263296    ['group_normalization_62[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack2_block4_mlp_drop_ (D  (None, 28, 28, 128)          0         ['stack2_block4_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack2_block4_mlp_out (Add  (None, 28, 28, 128)          0         ['stack2_block4_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack2_block4_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 stack3_down_sample_ (Conv2  (None, 14, 14, 320)          368960    ['stack2_block4_mlp_out[0][0]'
 D)                                                                 ]                             
                                                                                                  
 group_normalization_63 (Gr  (None, 14, 14, 320)          640       ['stack3_down_sample_[0][0]'] 
 oupNormalization)                                                                                
                                                                                                  
 stack3_block1_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_63[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block1_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_63[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_62 (Ba  (None, 14, 14, 320)          1280      ['stack3_block1_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_63 (Ba  (None, 14, 14, 320)          1280      ['stack3_block1_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_216 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_62[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_217 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_63[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block1_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_63[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_62 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_216[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_62 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_216[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block1_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_63[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_63 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_217[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_63 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_217[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_217 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_62[0][0]']      
                                                                                                  
 multiply_218 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_62[0][0]']      
                                                                                                  
 multiply_219 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_63[0][0]']      
                                                                                                  
 multiply_220 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_63[0][0]']      
                                                                                                  
 concatenate_673 (Concatena  (None, 14, 14, 640)          0         ['multiply_217[0][0]',        
 te)                                                                 'multiply_218[0][0]']        
                                                                                                  
 concatenate_674 (Concatena  (None, 14, 14, 640)          0         ['multiply_219[0][0]',        
 te)                                                                 'multiply_220[0][0]']        
                                                                                                  
 stack3_block1_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_673[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block1_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_674[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block1_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_63[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_462 (Add)               (None, 14, 14, 320)          0         ['stack3_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_3  (None, 1, 1, 320)            0         ['add_462[0][0]']             
 6 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block1_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_36[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_48 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block1_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_48[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_31 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block1_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_221 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_31[0][0]']       
                                                                                                  
 multiply_222 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_31[0][1]']       
                                                                                                  
 multiply_223 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_31[0][2]']       
                                                                                                  
 add_463 (Add)               (None, 14, 14, 320)          0         ['multiply_221[0][0]',        
                                                                     'multiply_222[0][0]',        
                                                                     'multiply_223[0][0]']        
                                                                                                  
 stack3_block1_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_463[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block1_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block1_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_down_sample_[0][0]', 
 d)                                                                  'stack3_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_64 (Gr  (None, 14, 14, 320)          640       ['stack3_block1_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block1_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_64[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block1_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block1_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_65 (Gr  (None, 14, 14, 320)          640       ['stack3_block1_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block2_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_65[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block2_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_65[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_64 (Ba  (None, 14, 14, 320)          1280      ['stack3_block2_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_65 (Ba  (None, 14, 14, 320)          1280      ['stack3_block2_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_218 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_64[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_219 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_65[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block2_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_65[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_64 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_218[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_64 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_218[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block2_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_65[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_65 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_219[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_65 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_219[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_224 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_64[0][0]']      
                                                                                                  
 multiply_225 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_64[0][0]']      
                                                                                                  
 multiply_226 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_65[0][0]']      
                                                                                                  
 multiply_227 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_65[0][0]']      
                                                                                                  
 concatenate_675 (Concatena  (None, 14, 14, 640)          0         ['multiply_224[0][0]',        
 te)                                                                 'multiply_225[0][0]']        
                                                                                                  
 concatenate_676 (Concatena  (None, 14, 14, 640)          0         ['multiply_226[0][0]',        
 te)                                                                 'multiply_227[0][0]']        
                                                                                                  
 stack3_block2_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_675[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block2_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_676[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block2_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_65[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_464 (Add)               (None, 14, 14, 320)          0         ['stack3_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_3  (None, 1, 1, 320)            0         ['add_464[0][0]']             
 7 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block2_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_37[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_49 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block2_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_49[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_32 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block2_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_228 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_32[0][0]']       
                                                                                                  
 multiply_229 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_32[0][1]']       
                                                                                                  
 multiply_230 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_32[0][2]']       
                                                                                                  
 add_465 (Add)               (None, 14, 14, 320)          0         ['multiply_228[0][0]',        
                                                                     'multiply_229[0][0]',        
                                                                     'multiply_230[0][0]']        
                                                                                                  
 stack3_block2_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_465[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block2_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block2_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block1_mlp_out[0][0]'
 d)                                                                 , 'stack3_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_66 (Gr  (None, 14, 14, 320)          640       ['stack3_block2_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block2_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_66[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block2_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block2_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_67 (Gr  (None, 14, 14, 320)          640       ['stack3_block2_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block3_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_67[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block3_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_67[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_66 (Ba  (None, 14, 14, 320)          1280      ['stack3_block3_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_67 (Ba  (None, 14, 14, 320)          1280      ['stack3_block3_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_220 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_66[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_221 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_67[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block3_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_67[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_66 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_220[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_66 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_220[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block3_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_67[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_67 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_221[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_67 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_221[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_231 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_66[0][0]']      
                                                                                                  
 multiply_232 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_66[0][0]']      
                                                                                                  
 multiply_233 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_67[0][0]']      
                                                                                                  
 multiply_234 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_67[0][0]']      
                                                                                                  
 concatenate_677 (Concatena  (None, 14, 14, 640)          0         ['multiply_231[0][0]',        
 te)                                                                 'multiply_232[0][0]']        
                                                                                                  
 concatenate_678 (Concatena  (None, 14, 14, 640)          0         ['multiply_233[0][0]',        
 te)                                                                 'multiply_234[0][0]']        
                                                                                                  
 stack3_block3_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_677[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block3_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_678[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block3_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_67[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_466 (Add)               (None, 14, 14, 320)          0         ['stack3_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block3_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_3  (None, 1, 1, 320)            0         ['add_466[0][0]']             
 8 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block3_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_38[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_50 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block3_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block3_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_50[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_33 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block3_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_235 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_33[0][0]']       
                                                                                                  
 multiply_236 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_33[0][1]']       
                                                                                                  
 multiply_237 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block3_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_33[0][2]']       
                                                                                                  
 add_467 (Add)               (None, 14, 14, 320)          0         ['multiply_235[0][0]',        
                                                                     'multiply_236[0][0]',        
                                                                     'multiply_237[0][0]']        
                                                                                                  
 stack3_block3_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_467[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block3_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block3_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block3_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block2_mlp_out[0][0]'
 d)                                                                 , 'stack3_block3_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_68 (Gr  (None, 14, 14, 320)          640       ['stack3_block3_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block3_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_68[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block3_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block3_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block3_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block3_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block3_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_69 (Gr  (None, 14, 14, 320)          640       ['stack3_block3_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block4_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_69[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block4_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_69[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_68 (Ba  (None, 14, 14, 320)          1280      ['stack3_block4_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_69 (Ba  (None, 14, 14, 320)          1280      ['stack3_block4_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_222 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_68[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_223 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_69[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block4_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_69[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_68 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_222[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_68 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_222[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block4_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_69[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_69 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_223[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_69 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_223[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_238 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_68[0][0]']      
                                                                                                  
 multiply_239 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_68[0][0]']      
                                                                                                  
 multiply_240 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_69[0][0]']      
                                                                                                  
 multiply_241 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_69[0][0]']      
                                                                                                  
 concatenate_679 (Concatena  (None, 14, 14, 640)          0         ['multiply_238[0][0]',        
 te)                                                                 'multiply_239[0][0]']        
                                                                                                  
 concatenate_680 (Concatena  (None, 14, 14, 640)          0         ['multiply_240[0][0]',        
 te)                                                                 'multiply_241[0][0]']        
                                                                                                  
 stack3_block4_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_679[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block4_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_680[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block4_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_69[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_468 (Add)               (None, 14, 14, 320)          0         ['stack3_block4_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block4_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block4_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_3  (None, 1, 1, 320)            0         ['add_468[0][0]']             
 9 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block4_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_39[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_51 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block4_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block4_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_51[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_34 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block4_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_242 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_34[0][0]']       
                                                                                                  
 multiply_243 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_34[0][1]']       
                                                                                                  
 multiply_244 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block4_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_34[0][2]']       
                                                                                                  
 add_469 (Add)               (None, 14, 14, 320)          0         ['multiply_242[0][0]',        
                                                                     'multiply_243[0][0]',        
                                                                     'multiply_244[0][0]']        
                                                                                                  
 stack3_block4_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_469[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block4_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block4_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block4_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block3_mlp_out[0][0]'
 d)                                                                 , 'stack3_block4_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_70 (Gr  (None, 14, 14, 320)          640       ['stack3_block4_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block4_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_70[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block4_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block4_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block4_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block4_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block4_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_71 (Gr  (None, 14, 14, 320)          640       ['stack3_block4_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block5_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_71[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block5_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_71[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_70 (Ba  (None, 14, 14, 320)          1280      ['stack3_block5_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_71 (Ba  (None, 14, 14, 320)          1280      ['stack3_block5_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_224 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_70[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_225 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_71[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block5_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_71[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_70 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_224[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_70 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_224[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block5_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_71[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_71 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_225[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_71 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_225[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_245 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_70[0][0]']      
                                                                                                  
 multiply_246 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_70[0][0]']      
                                                                                                  
 multiply_247 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_71[0][0]']      
                                                                                                  
 multiply_248 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_71[0][0]']      
                                                                                                  
 concatenate_681 (Concatena  (None, 14, 14, 640)          0         ['multiply_245[0][0]',        
 te)                                                                 'multiply_246[0][0]']        
                                                                                                  
 concatenate_682 (Concatena  (None, 14, 14, 640)          0         ['multiply_247[0][0]',        
 te)                                                                 'multiply_248[0][0]']        
                                                                                                  
 stack3_block5_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_681[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block5_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_682[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block5_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_71[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_470 (Add)               (None, 14, 14, 320)          0         ['stack3_block5_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block5_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block5_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 320)            0         ['add_470[0][0]']             
 0 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block5_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_40[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_52 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block5_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block5_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_52[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_35 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block5_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_249 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_35[0][0]']       
                                                                                                  
 multiply_250 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_35[0][1]']       
                                                                                                  
 multiply_251 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block5_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_35[0][2]']       
                                                                                                  
 add_471 (Add)               (None, 14, 14, 320)          0         ['multiply_249[0][0]',        
                                                                     'multiply_250[0][0]',        
                                                                     'multiply_251[0][0]']        
                                                                                                  
 stack3_block5_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_471[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block5_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block5_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block5_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block4_mlp_out[0][0]'
 d)                                                                 , 'stack3_block5_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_72 (Gr  (None, 14, 14, 320)          640       ['stack3_block5_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block5_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_72[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block5_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block5_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block5_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block5_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block5_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_73 (Gr  (None, 14, 14, 320)          640       ['stack3_block5_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block6_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_73[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block6_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_73[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_72 (Ba  (None, 14, 14, 320)          1280      ['stack3_block6_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_73 (Ba  (None, 14, 14, 320)          1280      ['stack3_block6_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_226 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_72[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_227 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_73[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block6_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_73[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_72 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_226[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_72 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_226[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block6_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_73[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_73 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_227[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_73 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_227[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_252 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_72[0][0]']      
                                                                                                  
 multiply_253 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_72[0][0]']      
                                                                                                  
 multiply_254 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_73[0][0]']      
                                                                                                  
 multiply_255 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_73[0][0]']      
                                                                                                  
 concatenate_683 (Concatena  (None, 14, 14, 640)          0         ['multiply_252[0][0]',        
 te)                                                                 'multiply_253[0][0]']        
                                                                                                  
 concatenate_684 (Concatena  (None, 14, 14, 640)          0         ['multiply_254[0][0]',        
 te)                                                                 'multiply_255[0][0]']        
                                                                                                  
 stack3_block6_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_683[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block6_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_684[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block6_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_73[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_472 (Add)               (None, 14, 14, 320)          0         ['stack3_block6_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block6_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block6_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 320)            0         ['add_472[0][0]']             
 1 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block6_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_41[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_53 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block6_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block6_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_53[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_36 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block6_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_256 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_36[0][0]']       
                                                                                                  
 multiply_257 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_36[0][1]']       
                                                                                                  
 multiply_258 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block6_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_36[0][2]']       
                                                                                                  
 add_473 (Add)               (None, 14, 14, 320)          0         ['multiply_256[0][0]',        
                                                                     'multiply_257[0][0]',        
                                                                     'multiply_258[0][0]']        
                                                                                                  
 stack3_block6_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_473[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block6_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block6_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block6_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block5_mlp_out[0][0]'
 d)                                                                 , 'stack3_block6_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_74 (Gr  (None, 14, 14, 320)          640       ['stack3_block6_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block6_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_74[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block6_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block6_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block6_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block6_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block6_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_75 (Gr  (None, 14, 14, 320)          640       ['stack3_block6_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block7_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_75[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block7_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_75[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_74 (Ba  (None, 14, 14, 320)          1280      ['stack3_block7_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_75 (Ba  (None, 14, 14, 320)          1280      ['stack3_block7_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_228 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_74[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_229 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_75[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block7_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_75[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_74 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_228[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_74 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_228[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block7_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_75[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_75 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_229[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_75 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_229[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_259 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_74[0][0]']      
                                                                                                  
 multiply_260 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_74[0][0]']      
                                                                                                  
 multiply_261 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_75[0][0]']      
                                                                                                  
 multiply_262 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_75[0][0]']      
                                                                                                  
 concatenate_685 (Concatena  (None, 14, 14, 640)          0         ['multiply_259[0][0]',        
 te)                                                                 'multiply_260[0][0]']        
                                                                                                  
 concatenate_686 (Concatena  (None, 14, 14, 640)          0         ['multiply_261[0][0]',        
 te)                                                                 'multiply_262[0][0]']        
                                                                                                  
 stack3_block7_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_685[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block7_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_686[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block7_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_75[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_474 (Add)               (None, 14, 14, 320)          0         ['stack3_block7_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block7_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block7_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 320)            0         ['add_474[0][0]']             
 2 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block7_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_42[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_54 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block7_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block7_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_54[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_37 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block7_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_263 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_37[0][0]']       
                                                                                                  
 multiply_264 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_37[0][1]']       
                                                                                                  
 multiply_265 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block7_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_37[0][2]']       
                                                                                                  
 add_475 (Add)               (None, 14, 14, 320)          0         ['multiply_263[0][0]',        
                                                                     'multiply_264[0][0]',        
                                                                     'multiply_265[0][0]']        
                                                                                                  
 stack3_block7_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_475[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block7_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block7_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block7_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block6_mlp_out[0][0]'
 d)                                                                 , 'stack3_block7_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_76 (Gr  (None, 14, 14, 320)          640       ['stack3_block7_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block7_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_76[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block7_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block7_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block7_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block7_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block7_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_77 (Gr  (None, 14, 14, 320)          640       ['stack3_block7_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block8_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_77[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block8_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_77[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_76 (Ba  (None, 14, 14, 320)          1280      ['stack3_block8_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_77 (Ba  (None, 14, 14, 320)          1280      ['stack3_block8_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_230 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_76[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_231 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_77[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block8_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_77[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_76 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_230[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_76 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_230[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block8_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_77[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_77 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_231[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_77 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_231[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_266 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_76[0][0]']      
                                                                                                  
 multiply_267 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_76[0][0]']      
                                                                                                  
 multiply_268 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_77[0][0]']      
                                                                                                  
 multiply_269 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_77[0][0]']      
                                                                                                  
 concatenate_687 (Concatena  (None, 14, 14, 640)          0         ['multiply_266[0][0]',        
 te)                                                                 'multiply_267[0][0]']        
                                                                                                  
 concatenate_688 (Concatena  (None, 14, 14, 640)          0         ['multiply_268[0][0]',        
 te)                                                                 'multiply_269[0][0]']        
                                                                                                  
 stack3_block8_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_687[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block8_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_688[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block8_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_77[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_476 (Add)               (None, 14, 14, 320)          0         ['stack3_block8_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block8_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block8_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 320)            0         ['add_476[0][0]']             
 3 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block8_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_43[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_55 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block8_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block8_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_55[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_38 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block8_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_270 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_38[0][0]']       
                                                                                                  
 multiply_271 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_38[0][1]']       
                                                                                                  
 multiply_272 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block8_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_38[0][2]']       
                                                                                                  
 add_477 (Add)               (None, 14, 14, 320)          0         ['multiply_270[0][0]',        
                                                                     'multiply_271[0][0]',        
                                                                     'multiply_272[0][0]']        
                                                                                                  
 stack3_block8_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_477[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block8_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block8_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block8_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block7_mlp_out[0][0]'
 d)                                                                 , 'stack3_block8_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_78 (Gr  (None, 14, 14, 320)          640       ['stack3_block8_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block8_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_78[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block8_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block8_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block8_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block8_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block8_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_79 (Gr  (None, 14, 14, 320)          640       ['stack3_block8_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block9_attn_theta_h  (None, 14, 14, 320)          102720    ['group_normalization_79[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack3_block9_attn_theta_w  (None, 14, 14, 320)          102720    ['group_normalization_79[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_78 (Ba  (None, 14, 14, 320)          1280      ['stack3_block9_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_79 (Ba  (None, 14, 14, 320)          1280      ['stack3_block9_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_232 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_78[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_233 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_79[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block9_attn_height_  (None, 14, 14, 320)          102400    ['group_normalization_79[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_78 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_232[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_78 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_232[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block9_attn_width_   (None, 14, 14, 320)          102400    ['group_normalization_79[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_79 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_233[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_79 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_233[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_273 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_78[0][0]']      
                                                                                                  
 multiply_274 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_78[0][0]']      
                                                                                                  
 multiply_275 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_79[0][0]']      
                                                                                                  
 multiply_276 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_79[0][0]']      
                                                                                                  
 concatenate_689 (Concatena  (None, 14, 14, 640)          0         ['multiply_273[0][0]',        
 te)                                                                 'multiply_274[0][0]']        
                                                                                                  
 concatenate_690 (Concatena  (None, 14, 14, 640)          0         ['multiply_275[0][0]',        
 te)                                                                 'multiply_276[0][0]']        
                                                                                                  
 stack3_block9_attn_height_  (None, 14, 14, 320)          4480      ['concatenate_689[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block9_attn_width_d  (None, 14, 14, 320)          4480      ['concatenate_690[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack3_block9_attn_channel  (None, 14, 14, 320)          102400    ['group_normalization_79[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_478 (Add)               (None, 14, 14, 320)          0         ['stack3_block9_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block9_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack3_block9_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 320)            0         ['add_478[0][0]']             
 4 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block9_attn_reweigh  (None, 1, 1, 960)            103440    ['global_average_pooling2d_44[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_56 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block9_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack3_block9_attn_attenti  (None, 1, 1, 320, 3)         0         ['reshape_56[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_39 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block9_attn_attention
                              (None, 1, 1, 320),                    _scores[0][0]']               
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_277 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_39[0][0]']       
                                                                                                  
 multiply_278 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_39[0][1]']       
                                                                                                  
 multiply_279 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block9_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_39[0][2]']       
                                                                                                  
 add_479 (Add)               (None, 14, 14, 320)          0         ['multiply_277[0][0]',        
                                                                     'multiply_278[0][0]',        
                                                                     'multiply_279[0][0]']        
                                                                                                  
 stack3_block9_attn_out_ (C  (None, 14, 14, 320)          102720    ['add_479[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack3_block9_attn_drop_ (  (None, 14, 14, 320)          0         ['stack3_block9_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack3_block9_attn_out (Ad  (None, 14, 14, 320)          0         ['stack3_block8_mlp_out[0][0]'
 d)                                                                 , 'stack3_block9_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_80 (Gr  (None, 14, 14, 320)          640       ['stack3_block9_attn_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block9_mlp_blocl_ (  (None, 14, 14, 320)          820800    ['group_normalization_80[0][0]
 MLPBlock)                                                          ']                            
                                                                                                  
 stack3_block9_mlp_drop_ (D  (None, 14, 14, 320)          0         ['stack3_block9_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack3_block9_mlp_out (Add  (None, 14, 14, 320)          0         ['stack3_block9_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack3_block9_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_81 (Gr  (None, 14, 14, 320)          640       ['stack3_block9_mlp_out[0][0]'
 oupNormalization)                                                  ]                             
                                                                                                  
 stack3_block10_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_81[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block10_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_81[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_80 (Ba  (None, 14, 14, 320)          1280      ['stack3_block10_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_81 (Ba  (None, 14, 14, 320)          1280      ['stack3_block10_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_234 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_80[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_235 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_81[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block10_attn_height  (None, 14, 14, 320)          102400    ['group_normalization_81[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_80 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_234[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_80 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_234[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block10_attn_width_  (None, 14, 14, 320)          102400    ['group_normalization_81[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_81 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_235[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_81 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_235[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_280 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_80[0][0]']      
                                                                                                  
 multiply_281 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_80[0][0]']      
                                                                                                  
 multiply_282 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_81[0][0]']      
                                                                                                  
 multiply_283 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_81[0][0]']      
                                                                                                  
 concatenate_691 (Concatena  (None, 14, 14, 640)          0         ['multiply_280[0][0]',        
 te)                                                                 'multiply_281[0][0]']        
                                                                                                  
 concatenate_692 (Concatena  (None, 14, 14, 640)          0         ['multiply_282[0][0]',        
 te)                                                                 'multiply_283[0][0]']        
                                                                                                  
 stack3_block10_attn_height  (None, 14, 14, 320)          4480      ['concatenate_691[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block10_attn_width_  (None, 14, 14, 320)          4480      ['concatenate_692[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block10_attn_channe  (None, 14, 14, 320)          102400    ['group_normalization_81[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_480 (Add)               (None, 14, 14, 320)          0         ['stack3_block10_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block10_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block10_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 320)            0         ['add_480[0][0]']             
 5 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block10_attn_reweig  (None, 1, 1, 960)            103440    ['global_average_pooling2d_45[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_57 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block10_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block10_attn_attent  (None, 1, 1, 320, 3)         0         ['reshape_57[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_40 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block10_attn_attentio
                              (None, 1, 1, 320),                    n_scores[0][0]']              
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_284 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_40[0][0]']       
                                                                                                  
 multiply_285 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_40[0][1]']       
                                                                                                  
 multiply_286 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block10_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_40[0][2]']       
                                                                                                  
 add_481 (Add)               (None, 14, 14, 320)          0         ['multiply_284[0][0]',        
                                                                     'multiply_285[0][0]',        
                                                                     'multiply_286[0][0]']        
                                                                                                  
 stack3_block10_attn_out_ (  (None, 14, 14, 320)          102720    ['add_481[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block10_attn_drop_   (None, 14, 14, 320)          0         ['stack3_block10_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block10_attn_out (A  (None, 14, 14, 320)          0         ['stack3_block9_mlp_out[0][0]'
 dd)                                                                , 'stack3_block10_attn_drop_[0
                                                                    ][0]']                        
                                                                                                  
 group_normalization_82 (Gr  (None, 14, 14, 320)          640       ['stack3_block10_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block10_mlp_blocl_   (None, 14, 14, 320)          820800    ['group_normalization_82[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block10_mlp_drop_ (  (None, 14, 14, 320)          0         ['stack3_block10_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block10_mlp_out (Ad  (None, 14, 14, 320)          0         ['stack3_block10_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block10_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_83 (Gr  (None, 14, 14, 320)          640       ['stack3_block10_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block11_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_83[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block11_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_83[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_82 (Ba  (None, 14, 14, 320)          1280      ['stack3_block11_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_83 (Ba  (None, 14, 14, 320)          1280      ['stack3_block11_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_236 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_82[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_237 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_83[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block11_attn_height  (None, 14, 14, 320)          102400    ['group_normalization_83[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_82 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_236[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_82 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_236[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block11_attn_width_  (None, 14, 14, 320)          102400    ['group_normalization_83[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_83 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_237[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_83 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_237[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_287 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block11_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_82[0][0]']      
                                                                                                  
 multiply_288 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block11_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_82[0][0]']      
                                                                                                  
 multiply_289 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block11_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_83[0][0]']      
                                                                                                  
 multiply_290 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block11_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_83[0][0]']      
                                                                                                  
 concatenate_693 (Concatena  (None, 14, 14, 640)          0         ['multiply_287[0][0]',        
 te)                                                                 'multiply_288[0][0]']        
                                                                                                  
 concatenate_694 (Concatena  (None, 14, 14, 640)          0         ['multiply_289[0][0]',        
 te)                                                                 'multiply_290[0][0]']        
                                                                                                  
 stack3_block11_attn_height  (None, 14, 14, 320)          4480      ['concatenate_693[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block11_attn_width_  (None, 14, 14, 320)          4480      ['concatenate_694[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block11_attn_channe  (None, 14, 14, 320)          102400    ['group_normalization_83[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_482 (Add)               (None, 14, 14, 320)          0         ['stack3_block11_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block11_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block11_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 320)            0         ['add_482[0][0]']             
 6 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block11_attn_reweig  (None, 1, 1, 960)            103440    ['global_average_pooling2d_46[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_58 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block11_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block11_attn_attent  (None, 1, 1, 320, 3)         0         ['reshape_58[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_41 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block11_attn_attentio
                              (None, 1, 1, 320),                    n_scores[0][0]']              
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_291 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block11_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_41[0][0]']       
                                                                                                  
 multiply_292 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block11_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_41[0][1]']       
                                                                                                  
 multiply_293 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block11_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_41[0][2]']       
                                                                                                  
 add_483 (Add)               (None, 14, 14, 320)          0         ['multiply_291[0][0]',        
                                                                     'multiply_292[0][0]',        
                                                                     'multiply_293[0][0]']        
                                                                                                  
 stack3_block11_attn_out_ (  (None, 14, 14, 320)          102720    ['add_483[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block11_attn_drop_   (None, 14, 14, 320)          0         ['stack3_block11_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block11_attn_out (A  (None, 14, 14, 320)          0         ['stack3_block10_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block11_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_84 (Gr  (None, 14, 14, 320)          640       ['stack3_block11_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block11_mlp_blocl_   (None, 14, 14, 320)          820800    ['group_normalization_84[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block11_mlp_drop_ (  (None, 14, 14, 320)          0         ['stack3_block11_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block11_mlp_out (Ad  (None, 14, 14, 320)          0         ['stack3_block11_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block11_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_85 (Gr  (None, 14, 14, 320)          640       ['stack3_block11_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block12_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_85[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block12_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_85[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_84 (Ba  (None, 14, 14, 320)          1280      ['stack3_block12_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_85 (Ba  (None, 14, 14, 320)          1280      ['stack3_block12_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_238 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_84[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_239 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_85[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block12_attn_height  (None, 14, 14, 320)          102400    ['group_normalization_85[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_84 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_238[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_84 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_238[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block12_attn_width_  (None, 14, 14, 320)          102400    ['group_normalization_85[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_85 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_239[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_85 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_239[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_294 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block12_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_84[0][0]']      
                                                                                                  
 multiply_295 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block12_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_84[0][0]']      
                                                                                                  
 multiply_296 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block12_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_85[0][0]']      
                                                                                                  
 multiply_297 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block12_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_85[0][0]']      
                                                                                                  
 concatenate_695 (Concatena  (None, 14, 14, 640)          0         ['multiply_294[0][0]',        
 te)                                                                 'multiply_295[0][0]']        
                                                                                                  
 concatenate_696 (Concatena  (None, 14, 14, 640)          0         ['multiply_296[0][0]',        
 te)                                                                 'multiply_297[0][0]']        
                                                                                                  
 stack3_block12_attn_height  (None, 14, 14, 320)          4480      ['concatenate_695[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block12_attn_width_  (None, 14, 14, 320)          4480      ['concatenate_696[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block12_attn_channe  (None, 14, 14, 320)          102400    ['group_normalization_85[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_484 (Add)               (None, 14, 14, 320)          0         ['stack3_block12_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block12_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block12_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 320)            0         ['add_484[0][0]']             
 7 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block12_attn_reweig  (None, 1, 1, 960)            103440    ['global_average_pooling2d_47[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_59 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block12_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block12_attn_attent  (None, 1, 1, 320, 3)         0         ['reshape_59[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_42 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block12_attn_attentio
                              (None, 1, 1, 320),                    n_scores[0][0]']              
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_298 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block12_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_42[0][0]']       
                                                                                                  
 multiply_299 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block12_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_42[0][1]']       
                                                                                                  
 multiply_300 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block12_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_42[0][2]']       
                                                                                                  
 add_485 (Add)               (None, 14, 14, 320)          0         ['multiply_298[0][0]',        
                                                                     'multiply_299[0][0]',        
                                                                     'multiply_300[0][0]']        
                                                                                                  
 stack3_block12_attn_out_ (  (None, 14, 14, 320)          102720    ['add_485[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block12_attn_drop_   (None, 14, 14, 320)          0         ['stack3_block12_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block12_attn_out (A  (None, 14, 14, 320)          0         ['stack3_block11_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block12_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_86 (Gr  (None, 14, 14, 320)          640       ['stack3_block12_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block12_mlp_blocl_   (None, 14, 14, 320)          820800    ['group_normalization_86[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block12_mlp_drop_ (  (None, 14, 14, 320)          0         ['stack3_block12_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block12_mlp_out (Ad  (None, 14, 14, 320)          0         ['stack3_block12_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block12_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_87 (Gr  (None, 14, 14, 320)          640       ['stack3_block12_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block13_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_87[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block13_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_87[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_86 (Ba  (None, 14, 14, 320)          1280      ['stack3_block13_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_87 (Ba  (None, 14, 14, 320)          1280      ['stack3_block13_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_240 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_86[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_241 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_87[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block13_attn_height  (None, 14, 14, 320)          102400    ['group_normalization_87[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_86 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_240[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_86 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_240[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block13_attn_width_  (None, 14, 14, 320)          102400    ['group_normalization_87[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_87 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_241[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_87 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_241[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_301 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block13_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_86[0][0]']      
                                                                                                  
 multiply_302 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block13_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_86[0][0]']      
                                                                                                  
 multiply_303 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block13_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_87[0][0]']      
                                                                                                  
 multiply_304 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block13_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_87[0][0]']      
                                                                                                  
 concatenate_697 (Concatena  (None, 14, 14, 640)          0         ['multiply_301[0][0]',        
 te)                                                                 'multiply_302[0][0]']        
                                                                                                  
 concatenate_698 (Concatena  (None, 14, 14, 640)          0         ['multiply_303[0][0]',        
 te)                                                                 'multiply_304[0][0]']        
                                                                                                  
 stack3_block13_attn_height  (None, 14, 14, 320)          4480      ['concatenate_697[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block13_attn_width_  (None, 14, 14, 320)          4480      ['concatenate_698[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block13_attn_channe  (None, 14, 14, 320)          102400    ['group_normalization_87[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_486 (Add)               (None, 14, 14, 320)          0         ['stack3_block13_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block13_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block13_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 320)            0         ['add_486[0][0]']             
 8 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block13_attn_reweig  (None, 1, 1, 960)            103440    ['global_average_pooling2d_48[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_60 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block13_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block13_attn_attent  (None, 1, 1, 320, 3)         0         ['reshape_60[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_43 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block13_attn_attentio
                              (None, 1, 1, 320),                    n_scores[0][0]']              
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_305 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block13_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_43[0][0]']       
                                                                                                  
 multiply_306 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block13_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_43[0][1]']       
                                                                                                  
 multiply_307 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block13_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_43[0][2]']       
                                                                                                  
 add_487 (Add)               (None, 14, 14, 320)          0         ['multiply_305[0][0]',        
                                                                     'multiply_306[0][0]',        
                                                                     'multiply_307[0][0]']        
                                                                                                  
 stack3_block13_attn_out_ (  (None, 14, 14, 320)          102720    ['add_487[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block13_attn_drop_   (None, 14, 14, 320)          0         ['stack3_block13_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block13_attn_out (A  (None, 14, 14, 320)          0         ['stack3_block12_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block13_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_88 (Gr  (None, 14, 14, 320)          640       ['stack3_block13_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block13_mlp_blocl_   (None, 14, 14, 320)          820800    ['group_normalization_88[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block13_mlp_drop_ (  (None, 14, 14, 320)          0         ['stack3_block13_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block13_mlp_out (Ad  (None, 14, 14, 320)          0         ['stack3_block13_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block13_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_89 (Gr  (None, 14, 14, 320)          640       ['stack3_block13_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block14_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_89[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block14_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_89[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_88 (Ba  (None, 14, 14, 320)          1280      ['stack3_block14_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_89 (Ba  (None, 14, 14, 320)          1280      ['stack3_block14_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_242 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_88[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_243 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_89[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block14_attn_height  (None, 14, 14, 320)          102400    ['group_normalization_89[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_88 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_242[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_88 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_242[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block14_attn_width_  (None, 14, 14, 320)          102400    ['group_normalization_89[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_89 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_243[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_89 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_243[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_308 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block14_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_88[0][0]']      
                                                                                                  
 multiply_309 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block14_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_88[0][0]']      
                                                                                                  
 multiply_310 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block14_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_89[0][0]']      
                                                                                                  
 multiply_311 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block14_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_89[0][0]']      
                                                                                                  
 concatenate_699 (Concatena  (None, 14, 14, 640)          0         ['multiply_308[0][0]',        
 te)                                                                 'multiply_309[0][0]']        
                                                                                                  
 concatenate_700 (Concatena  (None, 14, 14, 640)          0         ['multiply_310[0][0]',        
 te)                                                                 'multiply_311[0][0]']        
                                                                                                  
 stack3_block14_attn_height  (None, 14, 14, 320)          4480      ['concatenate_699[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block14_attn_width_  (None, 14, 14, 320)          4480      ['concatenate_700[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block14_attn_channe  (None, 14, 14, 320)          102400    ['group_normalization_89[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_488 (Add)               (None, 14, 14, 320)          0         ['stack3_block14_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block14_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block14_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_4  (None, 1, 1, 320)            0         ['add_488[0][0]']             
 9 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block14_attn_reweig  (None, 1, 1, 960)            103440    ['global_average_pooling2d_49[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_61 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block14_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block14_attn_attent  (None, 1, 1, 320, 3)         0         ['reshape_61[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_44 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block14_attn_attentio
                              (None, 1, 1, 320),                    n_scores[0][0]']              
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_312 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block14_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_44[0][0]']       
                                                                                                  
 multiply_313 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block14_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_44[0][1]']       
                                                                                                  
 multiply_314 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block14_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_44[0][2]']       
                                                                                                  
 add_489 (Add)               (None, 14, 14, 320)          0         ['multiply_312[0][0]',        
                                                                     'multiply_313[0][0]',        
                                                                     'multiply_314[0][0]']        
                                                                                                  
 stack3_block14_attn_out_ (  (None, 14, 14, 320)          102720    ['add_489[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block14_attn_drop_   (None, 14, 14, 320)          0         ['stack3_block14_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block14_attn_out (A  (None, 14, 14, 320)          0         ['stack3_block13_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block14_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_90 (Gr  (None, 14, 14, 320)          640       ['stack3_block14_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block14_mlp_blocl_   (None, 14, 14, 320)          820800    ['group_normalization_90[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block14_mlp_drop_ (  (None, 14, 14, 320)          0         ['stack3_block14_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block14_mlp_out (Ad  (None, 14, 14, 320)          0         ['stack3_block14_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block14_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_91 (Gr  (None, 14, 14, 320)          640       ['stack3_block14_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block15_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_91[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block15_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_91[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_90 (Ba  (None, 14, 14, 320)          1280      ['stack3_block15_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_91 (Ba  (None, 14, 14, 320)          1280      ['stack3_block15_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_244 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_90[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_245 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_91[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block15_attn_height  (None, 14, 14, 320)          102400    ['group_normalization_91[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_90 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_244[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_90 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_244[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block15_attn_width_  (None, 14, 14, 320)          102400    ['group_normalization_91[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_91 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_245[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_91 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_245[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_315 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block15_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_90[0][0]']      
                                                                                                  
 multiply_316 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block15_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_90[0][0]']      
                                                                                                  
 multiply_317 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block15_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_91[0][0]']      
                                                                                                  
 multiply_318 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block15_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_91[0][0]']      
                                                                                                  
 concatenate_701 (Concatena  (None, 14, 14, 640)          0         ['multiply_315[0][0]',        
 te)                                                                 'multiply_316[0][0]']        
                                                                                                  
 concatenate_702 (Concatena  (None, 14, 14, 640)          0         ['multiply_317[0][0]',        
 te)                                                                 'multiply_318[0][0]']        
                                                                                                  
 stack3_block15_attn_height  (None, 14, 14, 320)          4480      ['concatenate_701[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block15_attn_width_  (None, 14, 14, 320)          4480      ['concatenate_702[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block15_attn_channe  (None, 14, 14, 320)          102400    ['group_normalization_91[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_490 (Add)               (None, 14, 14, 320)          0         ['stack3_block15_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block15_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block15_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_5  (None, 1, 1, 320)            0         ['add_490[0][0]']             
 0 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block15_attn_reweig  (None, 1, 1, 960)            103440    ['global_average_pooling2d_50[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_62 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block15_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block15_attn_attent  (None, 1, 1, 320, 3)         0         ['reshape_62[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_45 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block15_attn_attentio
                              (None, 1, 1, 320),                    n_scores[0][0]']              
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_319 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block15_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_45[0][0]']       
                                                                                                  
 multiply_320 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block15_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_45[0][1]']       
                                                                                                  
 multiply_321 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block15_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_45[0][2]']       
                                                                                                  
 add_491 (Add)               (None, 14, 14, 320)          0         ['multiply_319[0][0]',        
                                                                     'multiply_320[0][0]',        
                                                                     'multiply_321[0][0]']        
                                                                                                  
 stack3_block15_attn_out_ (  (None, 14, 14, 320)          102720    ['add_491[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block15_attn_drop_   (None, 14, 14, 320)          0         ['stack3_block15_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block15_attn_out (A  (None, 14, 14, 320)          0         ['stack3_block14_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block15_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_92 (Gr  (None, 14, 14, 320)          640       ['stack3_block15_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block15_mlp_blocl_   (None, 14, 14, 320)          820800    ['group_normalization_92[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block15_mlp_drop_ (  (None, 14, 14, 320)          0         ['stack3_block15_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block15_mlp_out (Ad  (None, 14, 14, 320)          0         ['stack3_block15_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block15_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_93 (Gr  (None, 14, 14, 320)          640       ['stack3_block15_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block16_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_93[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block16_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_93[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_92 (Ba  (None, 14, 14, 320)          1280      ['stack3_block16_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_93 (Ba  (None, 14, 14, 320)          1280      ['stack3_block16_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_246 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_92[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_247 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_93[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block16_attn_height  (None, 14, 14, 320)          102400    ['group_normalization_93[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_92 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_246[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_92 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_246[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block16_attn_width_  (None, 14, 14, 320)          102400    ['group_normalization_93[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_93 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_247[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_93 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_247[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_322 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block16_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_92[0][0]']      
                                                                                                  
 multiply_323 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block16_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_92[0][0]']      
                                                                                                  
 multiply_324 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block16_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_93[0][0]']      
                                                                                                  
 multiply_325 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block16_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_93[0][0]']      
                                                                                                  
 concatenate_703 (Concatena  (None, 14, 14, 640)          0         ['multiply_322[0][0]',        
 te)                                                                 'multiply_323[0][0]']        
                                                                                                  
 concatenate_704 (Concatena  (None, 14, 14, 640)          0         ['multiply_324[0][0]',        
 te)                                                                 'multiply_325[0][0]']        
                                                                                                  
 stack3_block16_attn_height  (None, 14, 14, 320)          4480      ['concatenate_703[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block16_attn_width_  (None, 14, 14, 320)          4480      ['concatenate_704[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block16_attn_channe  (None, 14, 14, 320)          102400    ['group_normalization_93[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_492 (Add)               (None, 14, 14, 320)          0         ['stack3_block16_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block16_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block16_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_5  (None, 1, 1, 320)            0         ['add_492[0][0]']             
 1 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block16_attn_reweig  (None, 1, 1, 960)            103440    ['global_average_pooling2d_51[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_63 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block16_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block16_attn_attent  (None, 1, 1, 320, 3)         0         ['reshape_63[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_46 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block16_attn_attentio
                              (None, 1, 1, 320),                    n_scores[0][0]']              
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_326 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block16_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_46[0][0]']       
                                                                                                  
 multiply_327 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block16_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_46[0][1]']       
                                                                                                  
 multiply_328 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block16_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_46[0][2]']       
                                                                                                  
 add_493 (Add)               (None, 14, 14, 320)          0         ['multiply_326[0][0]',        
                                                                     'multiply_327[0][0]',        
                                                                     'multiply_328[0][0]']        
                                                                                                  
 stack3_block16_attn_out_ (  (None, 14, 14, 320)          102720    ['add_493[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block16_attn_drop_   (None, 14, 14, 320)          0         ['stack3_block16_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block16_attn_out (A  (None, 14, 14, 320)          0         ['stack3_block15_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block16_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_94 (Gr  (None, 14, 14, 320)          640       ['stack3_block16_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block16_mlp_blocl_   (None, 14, 14, 320)          820800    ['group_normalization_94[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block16_mlp_drop_ (  (None, 14, 14, 320)          0         ['stack3_block16_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block16_mlp_out (Ad  (None, 14, 14, 320)          0         ['stack3_block16_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block16_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_95 (Gr  (None, 14, 14, 320)          640       ['stack3_block16_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block17_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_95[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block17_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_95[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_94 (Ba  (None, 14, 14, 320)          1280      ['stack3_block17_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_95 (Ba  (None, 14, 14, 320)          1280      ['stack3_block17_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_248 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_94[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_249 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_95[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block17_attn_height  (None, 14, 14, 320)          102400    ['group_normalization_95[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_94 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_248[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_94 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_248[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block17_attn_width_  (None, 14, 14, 320)          102400    ['group_normalization_95[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_95 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_249[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_95 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_249[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_329 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block17_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_94[0][0]']      
                                                                                                  
 multiply_330 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block17_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_94[0][0]']      
                                                                                                  
 multiply_331 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block17_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_95[0][0]']      
                                                                                                  
 multiply_332 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block17_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_95[0][0]']      
                                                                                                  
 concatenate_705 (Concatena  (None, 14, 14, 640)          0         ['multiply_329[0][0]',        
 te)                                                                 'multiply_330[0][0]']        
                                                                                                  
 concatenate_706 (Concatena  (None, 14, 14, 640)          0         ['multiply_331[0][0]',        
 te)                                                                 'multiply_332[0][0]']        
                                                                                                  
 stack3_block17_attn_height  (None, 14, 14, 320)          4480      ['concatenate_705[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block17_attn_width_  (None, 14, 14, 320)          4480      ['concatenate_706[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block17_attn_channe  (None, 14, 14, 320)          102400    ['group_normalization_95[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_494 (Add)               (None, 14, 14, 320)          0         ['stack3_block17_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block17_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block17_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_5  (None, 1, 1, 320)            0         ['add_494[0][0]']             
 2 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block17_attn_reweig  (None, 1, 1, 960)            103440    ['global_average_pooling2d_52[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_64 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block17_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block17_attn_attent  (None, 1, 1, 320, 3)         0         ['reshape_64[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_47 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block17_attn_attentio
                              (None, 1, 1, 320),                    n_scores[0][0]']              
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_333 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block17_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_47[0][0]']       
                                                                                                  
 multiply_334 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block17_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_47[0][1]']       
                                                                                                  
 multiply_335 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block17_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_47[0][2]']       
                                                                                                  
 add_495 (Add)               (None, 14, 14, 320)          0         ['multiply_333[0][0]',        
                                                                     'multiply_334[0][0]',        
                                                                     'multiply_335[0][0]']        
                                                                                                  
 stack3_block17_attn_out_ (  (None, 14, 14, 320)          102720    ['add_495[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block17_attn_drop_   (None, 14, 14, 320)          0         ['stack3_block17_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block17_attn_out (A  (None, 14, 14, 320)          0         ['stack3_block16_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block17_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_96 (Gr  (None, 14, 14, 320)          640       ['stack3_block17_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block17_mlp_blocl_   (None, 14, 14, 320)          820800    ['group_normalization_96[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block17_mlp_drop_ (  (None, 14, 14, 320)          0         ['stack3_block17_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block17_mlp_out (Ad  (None, 14, 14, 320)          0         ['stack3_block17_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block17_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_97 (Gr  (None, 14, 14, 320)          640       ['stack3_block17_mlp_out[0][0]
 oupNormalization)                                                  ']                            
                                                                                                  
 stack3_block18_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_97[0][0]
 h_ (Conv2D)                                                        ']                            
                                                                                                  
 stack3_block18_attn_theta_  (None, 14, 14, 320)          102720    ['group_normalization_97[0][0]
 w_ (Conv2D)                                                        ']                            
                                                                                                  
 batch_normalization_96 (Ba  (None, 14, 14, 320)          1280      ['stack3_block18_attn_theta_h_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 batch_normalization_97 (Ba  (None, 14, 14, 320)          1280      ['stack3_block18_attn_theta_w_
 tchNormalization)                                                  [0][0]']                      
                                                                                                  
 activation_250 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_96[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_251 (Activation  (None, 14, 14, 320)          0         ['batch_normalization_97[0][0]
 )                                                                  ']                            
                                                                                                  
 stack3_block18_attn_height  (None, 14, 14, 320)          102400    ['group_normalization_97[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 tf.math.cos_96 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_250[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_96 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_250[0][0]']      
 )                                                                                                
                                                                                                  
 stack3_block18_attn_width_  (None, 14, 14, 320)          102400    ['group_normalization_97[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_97 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_251[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_97 (TFOpLambda  (None, 14, 14, 320)          0         ['activation_251[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_336 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block18_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.cos_96[0][0]']      
                                                                                                  
 multiply_337 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block18_attn_height_[
                                                                    0][0]',                       
                                                                     'tf.math.sin_96[0][0]']      
                                                                                                  
 multiply_338 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block18_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_97[0][0]']      
                                                                                                  
 multiply_339 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block18_attn_width_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_97[0][0]']      
                                                                                                  
 concatenate_707 (Concatena  (None, 14, 14, 640)          0         ['multiply_336[0][0]',        
 te)                                                                 'multiply_337[0][0]']        
                                                                                                  
 concatenate_708 (Concatena  (None, 14, 14, 640)          0         ['multiply_338[0][0]',        
 te)                                                                 'multiply_339[0][0]']        
                                                                                                  
 stack3_block18_attn_height  (None, 14, 14, 320)          4480      ['concatenate_707[0][0]']     
 _down_ (Conv2D)                                                                                  
                                                                                                  
 stack3_block18_attn_width_  (None, 14, 14, 320)          4480      ['concatenate_708[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack3_block18_attn_channe  (None, 14, 14, 320)          102400    ['group_normalization_97[0][0]
 l_ (Conv2D)                                                        ']                            
                                                                                                  
 add_496 (Add)               (None, 14, 14, 320)          0         ['stack3_block18_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'stack3_block18_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'stack3_block18_attn_channel_
                                                                    [0][0]']                      
                                                                                                  
 global_average_pooling2d_5  (None, 1, 1, 320)            0         ['add_496[0][0]']             
 3 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack3_block18_attn_reweig  (None, 1, 1, 960)            103440    ['global_average_pooling2d_53[
 ht_ (MLPBlock)                                                     0][0]']                       
                                                                                                  
 reshape_65 (Reshape)        (None, 1, 1, 320, 3)         0         ['stack3_block18_attn_reweight
                                                                    _[0][0]']                     
                                                                                                  
 stack3_block18_attn_attent  (None, 1, 1, 320, 3)         0         ['reshape_65[0][0]']          
 ion_scores (Softmax)                                                                             
                                                                                                  
 tf.unstack_48 (TFOpLambda)  [(None, 1, 1, 320),          0         ['stack3_block18_attn_attentio
                              (None, 1, 1, 320),                    n_scores[0][0]']              
                              (None, 1, 1, 320)]                                                  
                                                                                                  
 multiply_340 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block18_attn_height_d
                                                                    own_[0][0]',                  
                                                                     'tf.unstack_48[0][0]']       
                                                                                                  
 multiply_341 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block18_attn_width_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_48[0][1]']       
                                                                                                  
 multiply_342 (Multiply)     (None, 14, 14, 320)          0         ['stack3_block18_attn_channel_
                                                                    [0][0]',                      
                                                                     'tf.unstack_48[0][2]']       
                                                                                                  
 add_497 (Add)               (None, 14, 14, 320)          0         ['multiply_340[0][0]',        
                                                                     'multiply_341[0][0]',        
                                                                     'multiply_342[0][0]']        
                                                                                                  
 stack3_block18_attn_out_ (  (None, 14, 14, 320)          102720    ['add_497[0][0]']             
 Conv2D)                                                                                          
                                                                                                  
 stack3_block18_attn_drop_   (None, 14, 14, 320)          0         ['stack3_block18_attn_out_[0][
 (DropPath)                                                         0]']                          
                                                                                                  
 stack3_block18_attn_out (A  (None, 14, 14, 320)          0         ['stack3_block17_mlp_out[0][0]
 dd)                                                                ',                            
                                                                     'stack3_block18_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_98 (Gr  (None, 14, 14, 320)          640       ['stack3_block18_attn_out[0][0
 oupNormalization)                                                  ]']                           
                                                                                                  
 stack3_block18_mlp_blocl_   (None, 14, 14, 320)          820800    ['group_normalization_98[0][0]
 (MLPBlock)                                                         ']                            
                                                                                                  
 stack3_block18_mlp_drop_ (  (None, 14, 14, 320)          0         ['stack3_block18_mlp_blocl_[0]
 DropPath)                                                          [0]']                         
                                                                                                  
 stack3_block18_mlp_out (Ad  (None, 14, 14, 320)          0         ['stack3_block18_attn_out[0][0
 d)                                                                 ]',                           
                                                                     'stack3_block18_mlp_drop_[0][
                                                                    0]']                          
                                                                                                  
 stack4_down_sample_ (Conv2  (None, 7, 7, 512)            1475072   ['stack3_block18_mlp_out[0][0]
 D)                                                                 ']                            
                                                                                                  
 group_normalization_99 (Gr  (None, 7, 7, 512)            1024      ['stack4_down_sample_[0][0]'] 
 oupNormalization)                                                                                
                                                                                                  
 stack4_block1_attn_theta_h  (None, 7, 7, 512)            262656    ['group_normalization_99[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 stack4_block1_attn_theta_w  (None, 7, 7, 512)            262656    ['group_normalization_99[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 batch_normalization_98 (Ba  (None, 7, 7, 512)            2048      ['stack4_block1_attn_theta_h_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 batch_normalization_99 (Ba  (None, 7, 7, 512)            2048      ['stack4_block1_attn_theta_w_[
 tchNormalization)                                                  0][0]']                       
                                                                                                  
 activation_252 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_98[0][0]
 )                                                                  ']                            
                                                                                                  
 activation_253 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_99[0][0]
 )                                                                  ']                            
                                                                                                  
 stack4_block1_attn_height_  (None, 7, 7, 512)            262144    ['group_normalization_99[0][0]
  (Conv2D)                                                          ']                            
                                                                                                  
 tf.math.cos_98 (TFOpLambda  (None, 7, 7, 512)            0         ['activation_252[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_98 (TFOpLambda  (None, 7, 7, 512)            0         ['activation_252[0][0]']      
 )                                                                                                
                                                                                                  
 stack4_block1_attn_width_   (None, 7, 7, 512)            262144    ['group_normalization_99[0][0]
 (Conv2D)                                                           ']                            
                                                                                                  
 tf.math.cos_99 (TFOpLambda  (None, 7, 7, 512)            0         ['activation_253[0][0]']      
 )                                                                                                
                                                                                                  
 tf.math.sin_99 (TFOpLambda  (None, 7, 7, 512)            0         ['activation_253[0][0]']      
 )                                                                                                
                                                                                                  
 multiply_343 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_98[0][0]']      
                                                                                                  
 multiply_344 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_98[0][0]']      
                                                                                                  
 multiply_345 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_99[0][0]']      
                                                                                                  
 multiply_346 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_99[0][0]']      
                                                                                                  
 concatenate_709 (Concatena  (None, 7, 7, 1024)           0         ['multiply_343[0][0]',        
 te)                                                                 'multiply_344[0][0]']        
                                                                                                  
 concatenate_710 (Concatena  (None, 7, 7, 1024)           0         ['multiply_345[0][0]',        
 te)                                                                 'multiply_346[0][0]']        
                                                                                                  
 stack4_block1_attn_height_  (None, 7, 7, 512)            7168      ['concatenate_709[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack4_block1_attn_width_d  (None, 7, 7, 512)            7168      ['concatenate_710[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack4_block1_attn_channel  (None, 7, 7, 512)            262144    ['group_normalization_99[0][0]
 _ (Conv2D)                                                         ']                            
                                                                                                  
 add_498 (Add)               (None, 7, 7, 512)            0         ['stack4_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack4_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack4_block1_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_5  (None, 1, 1, 512)            0         ['add_498[0][0]']             
 4 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack4_block1_attn_reweigh  (None, 1, 1, 1536)           263808    ['global_average_pooling2d_54[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_66 (Reshape)        (None, 1, 1, 512, 3)         0         ['stack4_block1_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack4_block1_attn_attenti  (None, 1, 1, 512, 3)         0         ['reshape_66[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_49 (TFOpLambda)  [(None, 1, 1, 512),          0         ['stack4_block1_attn_attention
                              (None, 1, 1, 512),                    _scores[0][0]']               
                              (None, 1, 1, 512)]                                                  
                                                                                                  
 multiply_347 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_49[0][0]']       
                                                                                                  
 multiply_348 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_49[0][1]']       
                                                                                                  
 multiply_349 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block1_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_49[0][2]']       
                                                                                                  
 add_499 (Add)               (None, 7, 7, 512)            0         ['multiply_347[0][0]',        
                                                                     'multiply_348[0][0]',        
                                                                     'multiply_349[0][0]']        
                                                                                                  
 stack4_block1_attn_out_ (C  (None, 7, 7, 512)            262656    ['add_499[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack4_block1_attn_drop_ (  (None, 7, 7, 512)            0         ['stack4_block1_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack4_block1_attn_out (Ad  (None, 7, 7, 512)            0         ['stack4_down_sample_[0][0]', 
 d)                                                                  'stack4_block1_attn_drop_[0][
                                                                    0]']                          
                                                                                                  
 group_normalization_100 (G  (None, 7, 7, 512)            1024      ['stack4_block1_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack4_block1_mlp_blocl_ (  (None, 7, 7, 512)            2099712   ['group_normalization_100[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack4_block1_mlp_drop_ (D  (None, 7, 7, 512)            0         ['stack4_block1_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack4_block1_mlp_out (Add  (None, 7, 7, 512)            0         ['stack4_block1_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack4_block1_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_101 (G  (None, 7, 7, 512)            1024      ['stack4_block1_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack4_block2_attn_theta_h  (None, 7, 7, 512)            262656    ['group_normalization_101[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack4_block2_attn_theta_w  (None, 7, 7, 512)            262656    ['group_normalization_101[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_100 (B  (None, 7, 7, 512)            2048      ['stack4_block2_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_101 (B  (None, 7, 7, 512)            2048      ['stack4_block2_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_254 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_100[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_255 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_101[0][0
 )                                                                  ]']                           
                                                                                                  
 stack4_block2_attn_height_  (None, 7, 7, 512)            262144    ['group_normalization_101[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_100 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_254[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_100 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_254[0][0]']      
 a)                                                                                               
                                                                                                  
 stack4_block2_attn_width_   (None, 7, 7, 512)            262144    ['group_normalization_101[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_101 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_255[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_101 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_255[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_350 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_100[0][0]']     
                                                                                                  
 multiply_351 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_100[0][0]']     
                                                                                                  
 multiply_352 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_101[0][0]']     
                                                                                                  
 multiply_353 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_101[0][0]']     
                                                                                                  
 concatenate_711 (Concatena  (None, 7, 7, 1024)           0         ['multiply_350[0][0]',        
 te)                                                                 'multiply_351[0][0]']        
                                                                                                  
 concatenate_712 (Concatena  (None, 7, 7, 1024)           0         ['multiply_352[0][0]',        
 te)                                                                 'multiply_353[0][0]']        
                                                                                                  
 stack4_block2_attn_height_  (None, 7, 7, 512)            7168      ['concatenate_711[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack4_block2_attn_width_d  (None, 7, 7, 512)            7168      ['concatenate_712[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack4_block2_attn_channel  (None, 7, 7, 512)            262144    ['group_normalization_101[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_500 (Add)               (None, 7, 7, 512)            0         ['stack4_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack4_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack4_block2_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_5  (None, 1, 1, 512)            0         ['add_500[0][0]']             
 5 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack4_block2_attn_reweigh  (None, 1, 1, 1536)           263808    ['global_average_pooling2d_55[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_67 (Reshape)        (None, 1, 1, 512, 3)         0         ['stack4_block2_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack4_block2_attn_attenti  (None, 1, 1, 512, 3)         0         ['reshape_67[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_50 (TFOpLambda)  [(None, 1, 1, 512),          0         ['stack4_block2_attn_attention
                              (None, 1, 1, 512),                    _scores[0][0]']               
                              (None, 1, 1, 512)]                                                  
                                                                                                  
 multiply_354 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_50[0][0]']       
                                                                                                  
 multiply_355 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_50[0][1]']       
                                                                                                  
 multiply_356 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block2_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_50[0][2]']       
                                                                                                  
 add_501 (Add)               (None, 7, 7, 512)            0         ['multiply_354[0][0]',        
                                                                     'multiply_355[0][0]',        
                                                                     'multiply_356[0][0]']        
                                                                                                  
 stack4_block2_attn_out_ (C  (None, 7, 7, 512)            262656    ['add_501[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack4_block2_attn_drop_ (  (None, 7, 7, 512)            0         ['stack4_block2_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack4_block2_attn_out (Ad  (None, 7, 7, 512)            0         ['stack4_block1_mlp_out[0][0]'
 d)                                                                 , 'stack4_block2_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_102 (G  (None, 7, 7, 512)            1024      ['stack4_block2_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack4_block2_mlp_blocl_ (  (None, 7, 7, 512)            2099712   ['group_normalization_102[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack4_block2_mlp_drop_ (D  (None, 7, 7, 512)            0         ['stack4_block2_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack4_block2_mlp_out (Add  (None, 7, 7, 512)            0         ['stack4_block2_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack4_block2_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_103 (G  (None, 7, 7, 512)            1024      ['stack4_block2_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 stack4_block3_attn_theta_h  (None, 7, 7, 512)            262656    ['group_normalization_103[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 stack4_block3_attn_theta_w  (None, 7, 7, 512)            262656    ['group_normalization_103[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 batch_normalization_102 (B  (None, 7, 7, 512)            2048      ['stack4_block3_attn_theta_h_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 batch_normalization_103 (B  (None, 7, 7, 512)            2048      ['stack4_block3_attn_theta_w_[
 atchNormalization)                                                 0][0]']                       
                                                                                                  
 activation_256 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_102[0][0
 )                                                                  ]']                           
                                                                                                  
 activation_257 (Activation  (None, 7, 7, 512)            0         ['batch_normalization_103[0][0
 )                                                                  ]']                           
                                                                                                  
 stack4_block3_attn_height_  (None, 7, 7, 512)            262144    ['group_normalization_103[0][0
  (Conv2D)                                                          ]']                           
                                                                                                  
 tf.math.cos_102 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_256[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_102 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_256[0][0]']      
 a)                                                                                               
                                                                                                  
 stack4_block3_attn_width_   (None, 7, 7, 512)            262144    ['group_normalization_103[0][0
 (Conv2D)                                                           ]']                           
                                                                                                  
 tf.math.cos_103 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_257[0][0]']      
 a)                                                                                               
                                                                                                  
 tf.math.sin_103 (TFOpLambd  (None, 7, 7, 512)            0         ['activation_257[0][0]']      
 a)                                                                                               
                                                                                                  
 multiply_357 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.cos_102[0][0]']     
                                                                                                  
 multiply_358 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_height_[0
                                                                    ][0]',                        
                                                                     'tf.math.sin_102[0][0]']     
                                                                                                  
 multiply_359 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.cos_103[0][0]']     
                                                                                                  
 multiply_360 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_width_[0]
                                                                    [0]',                         
                                                                     'tf.math.sin_103[0][0]']     
                                                                                                  
 concatenate_713 (Concatena  (None, 7, 7, 1024)           0         ['multiply_357[0][0]',        
 te)                                                                 'multiply_358[0][0]']        
                                                                                                  
 concatenate_714 (Concatena  (None, 7, 7, 1024)           0         ['multiply_359[0][0]',        
 te)                                                                 'multiply_360[0][0]']        
                                                                                                  
 stack4_block3_attn_height_  (None, 7, 7, 512)            7168      ['concatenate_713[0][0]']     
 down_ (Conv2D)                                                                                   
                                                                                                  
 stack4_block3_attn_width_d  (None, 7, 7, 512)            7168      ['concatenate_714[0][0]']     
 own_ (Conv2D)                                                                                    
                                                                                                  
 stack4_block3_attn_channel  (None, 7, 7, 512)            262144    ['group_normalization_103[0][0
 _ (Conv2D)                                                         ]']                           
                                                                                                  
 add_502 (Add)               (None, 7, 7, 512)            0         ['stack4_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'stack4_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'stack4_block3_attn_channel_[
                                                                    0][0]']                       
                                                                                                  
 global_average_pooling2d_5  (None, 1, 1, 512)            0         ['add_502[0][0]']             
 6 (GlobalAveragePooling2D)                                                                       
                                                                                                  
 stack4_block3_attn_reweigh  (None, 1, 1, 1536)           263808    ['global_average_pooling2d_56[
 t_ (MLPBlock)                                                      0][0]']                       
                                                                                                  
 reshape_68 (Reshape)        (None, 1, 1, 512, 3)         0         ['stack4_block3_attn_reweight_
                                                                    [0][0]']                      
                                                                                                  
 stack4_block3_attn_attenti  (None, 1, 1, 512, 3)         0         ['reshape_68[0][0]']          
 on_scores (Softmax)                                                                              
                                                                                                  
 tf.unstack_51 (TFOpLambda)  [(None, 1, 1, 512),          0         ['stack4_block3_attn_attention
                              (None, 1, 1, 512),                    _scores[0][0]']               
                              (None, 1, 1, 512)]                                                  
                                                                                                  
 multiply_361 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_height_do
                                                                    wn_[0][0]',                   
                                                                     'tf.unstack_51[0][0]']       
                                                                                                  
 multiply_362 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_width_dow
                                                                    n_[0][0]',                    
                                                                     'tf.unstack_51[0][1]']       
                                                                                                  
 multiply_363 (Multiply)     (None, 7, 7, 512)            0         ['stack4_block3_attn_channel_[
                                                                    0][0]',                       
                                                                     'tf.unstack_51[0][2]']       
                                                                                                  
 add_503 (Add)               (None, 7, 7, 512)            0         ['multiply_361[0][0]',        
                                                                     'multiply_362[0][0]',        
                                                                     'multiply_363[0][0]']        
                                                                                                  
 stack4_block3_attn_out_ (C  (None, 7, 7, 512)            262656    ['add_503[0][0]']             
 onv2D)                                                                                           
                                                                                                  
 stack4_block3_attn_drop_ (  (None, 7, 7, 512)            0         ['stack4_block3_attn_out_[0][0
 DropPath)                                                          ]']                           
                                                                                                  
 stack4_block3_attn_out (Ad  (None, 7, 7, 512)            0         ['stack4_block2_mlp_out[0][0]'
 d)                                                                 , 'stack4_block3_attn_drop_[0]
                                                                    [0]']                         
                                                                                                  
 group_normalization_104 (G  (None, 7, 7, 512)            1024      ['stack4_block3_attn_out[0][0]
 roupNormalization)                                                 ']                            
                                                                                                  
 stack4_block3_mlp_blocl_ (  (None, 7, 7, 512)            2099712   ['group_normalization_104[0][0
 MLPBlock)                                                          ]']                           
                                                                                                  
 stack4_block3_mlp_drop_ (D  (None, 7, 7, 512)            0         ['stack4_block3_mlp_blocl_[0][
 ropPath)                                                           0]']                          
                                                                                                  
 stack4_block3_mlp_out (Add  (None, 7, 7, 512)            0         ['stack4_block3_attn_out[0][0]
 )                                                                  ',                            
                                                                     'stack4_block3_mlp_drop_[0][0
                                                                    ]']                           
                                                                                                  
 group_normalization_105 (G  (None, 7, 7, 512)            1024      ['stack4_block3_mlp_out[0][0]'
 roupNormalization)                                                 ]                             
                                                                                                  
 global_average_pooling2d_5  (None, 512)                  0         ['group_normalization_105[0][0
 7 (GlobalAveragePooling2D)                                         ]']                           
                                                                                                  
 dropout_15 (Dropout)        (None, 512)                  0         ['global_average_pooling2d_57[
                                                                    0][0]']                       
                                                                                                  
 predictions (Dense)         (None, 1000)                 513000    ['dropout_15[0][0]']          
                                                                                                  
 activation_258 (Activation  (None, 1000)                 0         ['predictions[0][0]']         
 )                                                                                                
                                                                                                  
==================================================================================================
Total params: 44088632 (168.18 MB)
Trainable params: 44056632 (168.06 MB)
Non-trainable params: 32000 (125.00 KB)
__________________________________________________________________________________________________
